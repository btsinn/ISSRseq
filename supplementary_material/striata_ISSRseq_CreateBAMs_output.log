INFO	2020-09-15 16:04:41	CreateSequenceDictionary	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CreateSequenceDictionary -R striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa.dict
**********


16:04:41.297 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:04:41 EDT 2020] CreateSequenceDictionary OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa.dict REFERENCE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa    TRUNCATE_NAMES_AT_WHITESPACE=true NUM_SEQUENCES=2147483647 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:04:41 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
[Tue Sep 15 16:04:42 EDT 2020] picard.sam.CreateSequenceDictionary done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=2058354688
java -ea -Xmx226370m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.548 seconds.
Analyzed Index:   	2.934 seconds.
Started output stream:	0.030 seconds.
Cleared Memory:    	0.586 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	21265834	(1701910523 bases)

Mapping:          	491.975 seconds.
Reads/sec:       	43225.44
kBases/sec:      	3459.34


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 40.8947% 	  4348301 	 41.1246% 	   699903148
bad pairs:       	  0.0127% 	     1351 	  0.0115% 	      195012
insert size avg: 	  271.61


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 63.5766% 	  6760052 	 62.7807% 	   532381674
unambiguous:     	 43.2961% 	  4603637 	 44.0720% 	   373731320
ambiguous:       	 20.2806% 	  2156415 	 18.7087% 	   158650354
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 22.7935% 	  2423616 	 18.4703% 	   156628396
semiperfect site:	 33.7626% 	  3589952 	 30.5826% 	   259341341
rescued:         	  3.7475% 	   398466

Match Rate:      	      NA 	       NA 	 94.3872% 	   505228797
Error Rate:      	 49.9452% 	  3894398 	  3.0080% 	    16100954
Sub Rate:        	 49.1108% 	  3829333 	  2.3143% 	    12387861
Del Rate:        	  4.6388% 	   361706 	  0.5401% 	     2891163
Ins Rate:        	  3.4296% 	   267418 	  0.1536% 	      821930
N Rate:          	 13.0134% 	  1014697 	  2.6049% 	    13943086


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.8262% 	  5935954 	 55.6829% 	   475480748
unambiguous:     	 39.9106% 	  4243658 	 40.6612% 	   347209797
ambiguous:       	 15.9156% 	  1692296 	 15.0216% 	   128270951
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.6999% 	  1882014 	 14.7160% 	   125661506
semiperfect site:	 27.9274% 	  2969494 	 25.7792% 	   220131094
rescued:         	  4.7944% 	   509782

Match Rate:      	      NA 	       NA 	 93.7606% 	   448529043
Error Rate:      	 46.3929% 	  3616551 	  3.3146% 	    15856444
Sub Rate:        	 45.5738% 	  3552701 	  2.5374% 	    12138166
Del Rate:        	  4.6271% 	   360703 	  0.6054% 	     2896105
Ins Rate:        	  3.4171% 	   266381 	  0.1719% 	      822173
N Rate:          	 13.0753% 	  1019285 	  2.9248% 	    13991366

Total time:     	496.452 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 16:14:48	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG.bam -RGID 1 -RGLB 253a_CA -RGPL illumina -RGPU combined_runs -RGSM 253a_CA
**********


16:14:48.845 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:14:48 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG.bam RGID=1 RGLB=253a_CA RGPL=illumina RGPU=combined_runs RGSM=253a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:14:48 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:14:49	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=253a_CA SM=253a_CA

INFO	2020-09-15 16:14:57	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|2018:37
INFO	2020-09-15 16:15:06	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|1817:91
INFO	2020-09-15 16:15:13	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:    7s.  Last read position: lcl|11692:1
INFO	2020-09-15 16:15:21	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    7s.  Last read position: lcl|13673:5
INFO	2020-09-15 16:15:29	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:39s.  Time for last 1,000,000:    7s.  Last read position: lcl|3530:48
INFO	2020-09-15 16:15:36	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:47s.  Time for last 1,000,000:    7s.  Last read position: lcl|3037:137
INFO	2020-09-15 16:15:44	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:55s.  Time for last 1,000,000:    8s.  Last read position: lcl|21907:370
INFO	2020-09-15 16:15:52	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:03s.  Time for last 1,000,000:    7s.  Last read position: lcl|23629:7
INFO	2020-09-15 16:16:00	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:11s.  Time for last 1,000,000:    8s.  Last read position: lcl|1262:53
INFO	2020-09-15 16:16:09	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:19s.  Time for last 1,000,000:    8s.  Last read position: lcl|29454:77
INFO	2020-09-15 16:16:17	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:27s.  Time for last 1,000,000:    8s.  Last read position: lcl|36985:276
INFO	2020-09-15 16:16:25	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:35s.  Time for last 1,000,000:    8s.  Last read position: lcl|39226:1
INFO	2020-09-15 16:16:33	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:43s.  Time for last 1,000,000:    7s.  Last read position: lcl|21215:46
INFO	2020-09-15 16:16:41	AddOrReplaceReadGroups	Processed    14,000,000 records.  Elapsed time: 00:01:51s.  Time for last 1,000,000:    8s.  Last read position: lcl|27823:13
INFO	2020-09-15 16:16:49	AddOrReplaceReadGroups	Processed    15,000,000 records.  Elapsed time: 00:02:00s.  Time for last 1,000,000:    8s.  Last read position: lcl|42964:55
INFO	2020-09-15 16:16:57	AddOrReplaceReadGroups	Processed    16,000,000 records.  Elapsed time: 00:02:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|41638:138
INFO	2020-09-15 16:17:07	AddOrReplaceReadGroups	Processed    17,000,000 records.  Elapsed time: 00:02:18s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 16:17:13	AddOrReplaceReadGroups	Processed    18,000,000 records.  Elapsed time: 00:02:24s.  Time for last 1,000,000:    6s.  Last read position: */*
INFO	2020-09-15 16:17:20	AddOrReplaceReadGroups	Processed    19,000,000 records.  Elapsed time: 00:02:31s.  Time for last 1,000,000:    6s.  Last read position: */*
INFO	2020-09-15 16:17:30	AddOrReplaceReadGroups	Processed    20,000,000 records.  Elapsed time: 00:02:40s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 16:17:39	AddOrReplaceReadGroups	Processed    21,000,000 records.  Elapsed time: 00:02:50s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 16:17:42 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 2.89 minutes.
Runtime.totalMemory()=1681915904
INFO	2020-09-15 16:18:02	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


16:18:03.245 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:18:03 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:18:03 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:18:03	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 16:18:03	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 16:18:03	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 16:18:05	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1214:21116:54297 1:N:0:TCTGAGAG+ATCTGACC. Cause: String 'TCTGAGAG+ATCTGACC' did not start with a parsable number.
INFO	2020-09-15 16:18:11	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|2018:37
INFO	2020-09-15 16:18:11	MarkDuplicates	Tracking 1195 as yet unmatched pairs. 1154 records in RAM.
INFO	2020-09-15 16:18:15	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    4s.  Last read position: lcl|1817:91
INFO	2020-09-15 16:18:15	MarkDuplicates	Tracking 9545 as yet unmatched pairs. 9479 records in RAM.
INFO	2020-09-15 16:18:22	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    6s.  Last read position: lcl|11692:1
INFO	2020-09-15 16:18:22	MarkDuplicates	Tracking 91 as yet unmatched pairs. 19 records in RAM.
INFO	2020-09-15 16:18:26	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:    3s.  Last read position: lcl|13673:5
INFO	2020-09-15 16:18:26	MarkDuplicates	Tracking 15303 as yet unmatched pairs. 15254 records in RAM.
INFO	2020-09-15 16:18:33	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    7s.  Last read position: lcl|3530:48
INFO	2020-09-15 16:18:33	MarkDuplicates	Tracking 948 as yet unmatched pairs. 848 records in RAM.
INFO	2020-09-15 16:18:38	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    4s.  Last read position: lcl|3037:137
INFO	2020-09-15 16:18:38	MarkDuplicates	Tracking 410 as yet unmatched pairs. 314 records in RAM.
INFO	2020-09-15 16:18:43	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:    5s.  Last read position: lcl|21907:370
INFO	2020-09-15 16:18:43	MarkDuplicates	Tracking 647 as yet unmatched pairs. 548 records in RAM.
INFO	2020-09-15 16:18:48	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:42s.  Time for last 1,000,000:    4s.  Last read position: lcl|23629:7
INFO	2020-09-15 16:18:48	MarkDuplicates	Tracking 197 as yet unmatched pairs. 89 records in RAM.
INFO	2020-09-15 16:19:18	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:01:12s.  Time for last 1,000,000:   30s.  Last read position: lcl|1262:53
INFO	2020-09-15 16:19:18	MarkDuplicates	Tracking 138 as yet unmatched pairs. 29 records in RAM.
INFO	2020-09-15 16:19:22	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:01:16s.  Time for last 1,000,000:    4s.  Last read position: lcl|29454:77
INFO	2020-09-15 16:19:22	MarkDuplicates	Tracking 932 as yet unmatched pairs. 778 records in RAM.
INFO	2020-09-15 16:19:27	MarkDuplicates	Read    11,000,000 records.  Elapsed time: 00:01:21s.  Time for last 1,000,000:    4s.  Last read position: lcl|36985:276
INFO	2020-09-15 16:19:27	MarkDuplicates	Tracking 1934 as yet unmatched pairs. 1819 records in RAM.
INFO	2020-09-15 16:19:38	MarkDuplicates	Read    12,000,000 records.  Elapsed time: 00:01:32s.  Time for last 1,000,000:   11s.  Last read position: lcl|39226:1
INFO	2020-09-15 16:19:38	MarkDuplicates	Tracking 189 as yet unmatched pairs. 96 records in RAM.
INFO	2020-09-15 16:19:42	MarkDuplicates	Read    13,000,000 records.  Elapsed time: 00:01:36s.  Time for last 1,000,000:    3s.  Last read position: lcl|21215:46
INFO	2020-09-15 16:19:42	MarkDuplicates	Tracking 508 as yet unmatched pairs. 444 records in RAM.
INFO	2020-09-15 16:19:45	MarkDuplicates	Read    14,000,000 records.  Elapsed time: 00:01:39s.  Time for last 1,000,000:    3s.  Last read position: lcl|27823:13
INFO	2020-09-15 16:19:45	MarkDuplicates	Tracking 3041 as yet unmatched pairs. 2995 records in RAM.
INFO	2020-09-15 16:19:49	MarkDuplicates	Read    15,000,000 records.  Elapsed time: 00:01:43s.  Time for last 1,000,000:    3s.  Last read position: lcl|42964:55
INFO	2020-09-15 16:19:49	MarkDuplicates	Tracking 2598 as yet unmatched pairs. 2577 records in RAM.
INFO	2020-09-15 16:20:00	MarkDuplicates	Read    16,000,000 records.  Elapsed time: 00:01:54s.  Time for last 1,000,000:   10s.  Last read position: lcl|41638:138
INFO	2020-09-15 16:20:00	MarkDuplicates	Tracking 596 as yet unmatched pairs. 579 records in RAM.
INFO	2020-09-15 16:20:03	MarkDuplicates	Read 16692708 records. 0 pairs never matched.
INFO	2020-09-15 16:20:19	MarkDuplicates	After buildSortedReadEndLists freeMemory: 10606110368; totalMemory: 12871794688; maxMemory: 28631367680
INFO	2020-09-15 16:20:19	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 16:20:23	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 16:20:47	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 16:20:48	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 16:20:50	MarkDuplicates	After generateDuplicateIndexes freeMemory: 16518725928; totalMemory: 23808442368; maxMemory: 28631367680
INFO	2020-09-15 16:20:50	MarkDuplicates	Marking 5798482 records as duplicates.
INFO	2020-09-15 16:20:50	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 16:20:50	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 16:22:19	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:29s.  Time for last 10,000,000:   89s.  Last read position: lcl|29454:77
INFO	2020-09-15 16:23:56	MarkDuplicates	Written    20,000,000 records.  Elapsed time: 00:03:05s.  Time for last 10,000,000:   96s.  Last read position: */*
INFO	2020-09-15 16:24:09	MarkDuplicates	Before output close freeMemory: 23583166936; totalMemory: 23776460800; maxMemory: 28631367680
INFO	2020-09-15 16:24:09	MarkDuplicates	After output close freeMemory: 23174222296; totalMemory: 23367516160; maxMemory: 28631367680
[Tue Sep 15 16:24:09 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 6.11 minutes.
Runtime.totalMemory()=23367516160
INFO	2020-09-15 16:24:11	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG_DM.bam
**********


16:24:11.612 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:24:11 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:24:11 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:24:54	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253a_CA_sorted_RG_DM.bai
[Tue Sep 15 16:24:54 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.72 minutes.
Runtime.totalMemory()=4735369216
java -ea -Xmx226006m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.542 seconds.
Analyzed Index:   	3.176 seconds.
Started output stream:	0.034 seconds.
Cleared Memory:    	1.187 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	13412608	(1078880903 bases)

Mapping:          	380.790 seconds.
Reads/sec:       	35223.08
kBases/sec:      	2833.27


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 37.4232% 	  2509713 	 37.8545% 	   408405390
bad pairs:       	  0.0143% 	      958 	  0.0131% 	      141420
insert size avg: 	  301.44


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 63.2467% 	  4241515 	 62.4705% 	   336367205
unambiguous:     	 42.5247% 	  2851839 	 43.4809% 	   234119331
ambiguous:       	 20.7219% 	  1389676 	 18.9896% 	   102247874
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 21.3586% 	  1432374 	 17.0185% 	    91634715
semiperfect site:	 31.8213% 	  2134031 	 28.5318% 	   153626894
rescued:         	  4.0871% 	   274091

Match Rate:      	      NA 	       NA 	 94.2680% 	   319015715
Error Rate:      	 50.7549% 	  2558227 	  3.2397% 	    10963505
Sub Rate:        	 49.9908% 	  2519716 	  2.4628% 	     8334601
Del Rate:        	  4.9288% 	   248427 	  0.6047% 	     2046470
Ins Rate:        	  3.6310% 	   183014 	  0.1721% 	      582434
N Rate:          	 12.5366% 	   631889 	  2.4924% 	     8434455


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.6939% 	  3667937 	 54.8869% 	   296630162
unambiguous:     	 38.7859% 	  2601101 	 39.8879% 	   215570100
ambiguous:       	 15.9080% 	  1066836 	 14.9989% 	    81060062
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.8937% 	  1065881 	 13.1006% 	    70800923
semiperfect site:	 25.5870% 	  1715945 	 23.5577% 	   127315210
rescued:         	  5.1438% 	   344960

Match Rate:      	      NA 	       NA 	 93.5526% 	   279418151
Error Rate:      	 46.7226% 	  2351834 	  3.6020% 	    10758366
Sub Rate:        	 45.9758% 	  2314247 	  2.7219% 	     8129670
Del Rate:        	  4.9184% 	   247574 	  0.6846% 	     2044601
Ins Rate:        	  3.6399% 	   183221 	  0.1956% 	      584095
N Rate:          	 12.6836% 	   638443 	  2.8453% 	     8498246

Total time:     	386.122 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 16:32:35	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG.bam -RGID 1 -RGLB 253b_CA -RGPL illumina -RGPU combined_runs -RGSM 253b_CA
**********


16:32:35.409 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:32:35 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG.bam RGID=1 RGLB=253b_CA RGPL=illumina RGPU=combined_runs RGSM=253b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:32:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:32:35	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=253b_CA SM=253b_CA

INFO	2020-09-15 16:32:44	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|4458:86
INFO	2020-09-15 16:32:52	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|9361:13
INFO	2020-09-15 16:33:01	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|10803:77
INFO	2020-09-15 16:33:09	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:33s.  Time for last 1,000,000:    8s.  Last read position: lcl|8152:27
INFO	2020-09-15 16:33:18	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:42s.  Time for last 1,000,000:    8s.  Last read position: lcl|15658:76
INFO	2020-09-15 16:33:27	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:51s.  Time for last 1,000,000:    8s.  Last read position: lcl|21244:71
INFO	2020-09-15 16:33:35	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:00s.  Time for last 1,000,000:    8s.  Last read position: lcl|32430:5
INFO	2020-09-15 16:33:44	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|35629:183
INFO	2020-09-15 16:33:53	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|24440:1
INFO	2020-09-15 16:34:01	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|40073:11
INFO	2020-09-15 16:34:11	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:35s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 16:34:17	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:41s.  Time for last 1,000,000:    6s.  Last read position: */*
INFO	2020-09-15 16:34:27	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:51s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 16:34:31 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.94 minutes.
Runtime.totalMemory()=2854748160
INFO	2020-09-15 16:34:45	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


16:34:45.363 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:34:45 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:34:45 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:34:45	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 16:34:45	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 16:34:45	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 16:34:47	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2112:8485:2322 1:N:0:TCTGAGAG+TTCGTACG. Cause: String 'TCTGAGAG+TTCGTACG' did not start with a parsable number.
INFO	2020-09-15 16:34:54	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|4458:86
INFO	2020-09-15 16:34:54	MarkDuplicates	Tracking 398 as yet unmatched pairs. 367 records in RAM.
INFO	2020-09-15 16:34:58	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|9361:13
INFO	2020-09-15 16:34:58	MarkDuplicates	Tracking 159 as yet unmatched pairs. 111 records in RAM.
INFO	2020-09-15 16:35:04	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    6s.  Last read position: lcl|10803:77
INFO	2020-09-15 16:35:04	MarkDuplicates	Tracking 1122 as yet unmatched pairs. 1070 records in RAM.
INFO	2020-09-15 16:35:08	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:    3s.  Last read position: lcl|8152:27
INFO	2020-09-15 16:35:08	MarkDuplicates	Tracking 73 as yet unmatched pairs. 17 records in RAM.
INFO	2020-09-15 16:35:17	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:    9s.  Last read position: lcl|15658:76
INFO	2020-09-15 16:35:17	MarkDuplicates	Tracking 125 as yet unmatched pairs. 25 records in RAM.
INFO	2020-09-15 16:35:22	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    4s.  Last read position: lcl|21244:71
INFO	2020-09-15 16:35:22	MarkDuplicates	Tracking 3449 as yet unmatched pairs. 3299 records in RAM.
INFO	2020-09-15 16:35:27	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:39s.  Time for last 1,000,000:    5s.  Last read position: lcl|32430:5
INFO	2020-09-15 16:35:27	MarkDuplicates	Tracking 2097 as yet unmatched pairs. 2035 records in RAM.
INFO	2020-09-15 16:35:31	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:    3s.  Last read position: lcl|35629:183
INFO	2020-09-15 16:35:31	MarkDuplicates	Tracking 1586 as yet unmatched pairs. 1522 records in RAM.
INFO	2020-09-15 16:35:47	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:00:59s.  Time for last 1,000,000:   16s.  Last read position: lcl|24440:1
INFO	2020-09-15 16:35:47	MarkDuplicates	Tracking 252 as yet unmatched pairs. 178 records in RAM.
INFO	2020-09-15 16:35:52	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:01:04s.  Time for last 1,000,000:    4s.  Last read position: lcl|40073:11
INFO	2020-09-15 16:35:52	MarkDuplicates	Tracking 2878 as yet unmatched pairs. 2821 records in RAM.
INFO	2020-09-15 16:35:56	MarkDuplicates	Read 10797562 records. 0 pairs never matched.
INFO	2020-09-15 16:36:05	MarkDuplicates	After buildSortedReadEndLists freeMemory: 11010915088; totalMemory: 12799442944; maxMemory: 28631367680
INFO	2020-09-15 16:36:05	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 16:36:08	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 16:36:27	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 16:36:27	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 16:36:29	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15703807760; totalMemory: 23051894784; maxMemory: 28631367680
INFO	2020-09-15 16:36:29	MarkDuplicates	Marking 3273660 records as duplicates.
INFO	2020-09-15 16:36:29	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 16:36:29	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 16:38:00	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:30s.  Time for last 10,000,000:   90s.  Last read position: lcl|40073:11
INFO	2020-09-15 16:38:31	MarkDuplicates	Before output close freeMemory: 22514289872; totalMemory: 22722117632; maxMemory: 28631367680
INFO	2020-09-15 16:38:31	MarkDuplicates	After output close freeMemory: 22834629840; totalMemory: 23042457600; maxMemory: 28631367680
[Tue Sep 15 16:38:31 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 3.78 minutes.
Runtime.totalMemory()=23042457600
INFO	2020-09-15 16:38:33	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG_DM.bam
**********


16:38:33.824 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:38:33 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:38:33 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:39:04	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253b_CA_sorted_RG_DM.bai
[Tue Sep 15 16:39:04 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.51 minutes.
Runtime.totalMemory()=5186781184
java -ea -Xmx226073m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253c_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253c_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253c_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253c_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.531 seconds.
Analyzed Index:   	3.218 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	1.145 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	14033794	(1097040226 bases)

Mapping:          	345.869 seconds.
Reads/sec:       	40575.40
kBases/sec:      	3171.83


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 41.9353% 	  2942556 	 41.9906% 	   460654116
bad pairs:       	  0.0101% 	      712 	  0.0095% 	      104430
insert size avg: 	  270.44


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 64.9392% 	  4556715 	 64.0187% 	   349710847
unambiguous:     	 42.9226% 	  3011834 	 43.8222% 	   239385025
ambiguous:       	 22.0166% 	  1544881 	 20.1964% 	   110325822
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 23.1154% 	  1621987 	 18.5682% 	   101431099
semiperfect site:	 33.2787% 	  2335129 	 29.7733% 	   162640905
rescued:         	  4.1174% 	   288913

Match Rate:      	      NA 	       NA 	 94.6117% 	   332489567
Error Rate:      	 50.6166% 	  2678720 	  3.0923% 	    10866974
Sub Rate:        	 49.8718% 	  2639306 	  2.4609% 	     8648247
Del Rate:        	  4.2927% 	   227176 	  0.4879% 	     1714654
Ins Rate:        	  3.1650% 	   167500 	  0.1434% 	      504073
N Rate:          	 11.8335% 	   626251 	  2.2961% 	     8068960


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.8785% 	  3991107 	 56.5551% 	   311492385
unambiguous:     	 39.5144% 	  2772684 	 40.3288% 	   222121796
ambiguous:       	 17.3641% 	  1218423 	 16.2263% 	    89370589
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.8254% 	  1250787 	 14.6322% 	    80590968
semiperfect site:	 27.3759% 	  1920938 	 24.8947% 	   137114346
rescued:         	  5.2026% 	   365061

Match Rate:      	      NA 	       NA 	 93.9936% 	   294393752
Error Rate:      	 46.9913% 	  2483602 	  3.4044% 	    10662697
Sub Rate:        	 46.2667% 	  2445307 	  2.6970% 	     8447243
Del Rate:        	  4.2625% 	   225283 	  0.5472% 	     1713715
Ins Rate:        	  3.1621% 	   167126 	  0.1602% 	      501739
N Rate:          	 11.9822% 	   633287 	  2.6020% 	     8149651

Total time:     	351.173 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 16:46:15	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG.bam -RGID 1 -RGLB 253c_CA -RGPL illumina -RGPU combined_runs -RGSM 253c_CA
**********


16:46:15.960 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:46:15 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG.bam RGID=1 RGLB=253c_CA RGPL=illumina RGPU=combined_runs RGSM=253c_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:46:15 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:46:16	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=253c_CA SM=253c_CA

INFO	2020-09-15 16:46:25	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|4447:22
INFO	2020-09-15 16:46:33	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|43:62
INFO	2020-09-15 16:46:42	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|13332:46
INFO	2020-09-15 16:46:50	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    8s.  Last read position: lcl|453:261
INFO	2020-09-15 16:46:58	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:42s.  Time for last 1,000,000:    8s.  Last read position: lcl|23140:302
INFO	2020-09-15 16:47:07	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:51s.  Time for last 1,000,000:    8s.  Last read position: lcl|1260:17
INFO	2020-09-15 16:47:16	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:59s.  Time for last 1,000,000:    8s.  Last read position: lcl|30522:84
INFO	2020-09-15 16:47:24	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|37519:135
INFO	2020-09-15 16:47:33	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|25605:37
INFO	2020-09-15 16:47:42	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|39903:3
INFO	2020-09-15 16:47:51	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:34s.  Time for last 1,000,000:    8s.  Last read position: lcl|44235:53
INFO	2020-09-15 16:48:00	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:43s.  Time for last 1,000,000:    8s.  Last read position: */*
INFO	2020-09-15 16:48:07	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:51s.  Time for last 1,000,000:    7s.  Last read position: */*
INFO	2020-09-15 16:48:17	AddOrReplaceReadGroups	Processed    14,000,000 records.  Elapsed time: 00:02:01s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 16:48:18 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 2.04 minutes.
Runtime.totalMemory()=2854748160
INFO	2020-09-15 16:48:32	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


16:48:32.480 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:48:32 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:48:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:48:32	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 16:48:32	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 16:48:32	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 16:48:34	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1114:13244:22854 1:N:0:ACCGCATC+TTCGTACG. Cause: String 'ACCGCATC+TTCGTACG' did not start with a parsable number.
INFO	2020-09-15 16:48:41	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|4447:22
INFO	2020-09-15 16:48:41	MarkDuplicates	Tracking 60 as yet unmatched pairs. 8 records in RAM.
INFO	2020-09-15 16:48:46	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:12s.  Time for last 1,000,000:    5s.  Last read position: lcl|43:62
INFO	2020-09-15 16:48:46	MarkDuplicates	Tracking 1028 as yet unmatched pairs. 990 records in RAM.
INFO	2020-09-15 16:48:52	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    6s.  Last read position: lcl|13332:46
INFO	2020-09-15 16:48:52	MarkDuplicates	Tracking 494 as yet unmatched pairs. 319 records in RAM.
INFO	2020-09-15 16:48:56	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    4s.  Last read position: lcl|453:261
INFO	2020-09-15 16:48:56	MarkDuplicates	Tracking 333 as yet unmatched pairs. 269 records in RAM.
INFO	2020-09-15 16:49:04	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:    7s.  Last read position: lcl|23140:302
INFO	2020-09-15 16:49:04	MarkDuplicates	Tracking 77 as yet unmatched pairs. 18 records in RAM.
INFO	2020-09-15 16:49:09	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    4s.  Last read position: lcl|1260:17
INFO	2020-09-15 16:49:09	MarkDuplicates	Tracking 2081 as yet unmatched pairs. 2013 records in RAM.
INFO	2020-09-15 16:49:15	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:41s.  Time for last 1,000,000:    6s.  Last read position: lcl|30522:84
INFO	2020-09-15 16:49:15	MarkDuplicates	Tracking 220 as yet unmatched pairs. 114 records in RAM.
INFO	2020-09-15 16:49:20	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:45s.  Time for last 1,000,000:    4s.  Last read position: lcl|37519:135
INFO	2020-09-15 16:49:20	MarkDuplicates	Tracking 292 as yet unmatched pairs. 232 records in RAM.
INFO	2020-09-15 16:49:36	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:01:01s.  Time for last 1,000,000:   16s.  Last read position: lcl|25605:37
INFO	2020-09-15 16:49:36	MarkDuplicates	Tracking 183 as yet unmatched pairs. 126 records in RAM.
INFO	2020-09-15 16:49:41	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:01:06s.  Time for last 1,000,000:    4s.  Last read position: lcl|39903:3
INFO	2020-09-15 16:49:41	MarkDuplicates	Tracking 336 as yet unmatched pairs. 297 records in RAM.
INFO	2020-09-15 16:49:46	MarkDuplicates	Read    11,000,000 records.  Elapsed time: 00:01:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|44235:53
INFO	2020-09-15 16:49:46	MarkDuplicates	Tracking 60 as yet unmatched pairs. 55 records in RAM.
INFO	2020-09-15 16:49:47	MarkDuplicates	Read 11209108 records. 0 pairs never matched.
INFO	2020-09-15 16:50:00	MarkDuplicates	After buildSortedReadEndLists freeMemory: 10942409360; totalMemory: 12809404416; maxMemory: 28631367680
INFO	2020-09-15 16:50:00	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 16:50:03	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 16:50:25	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 16:50:25	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 16:50:26	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15785101664; totalMemory: 23133159424; maxMemory: 28631367680
INFO	2020-09-15 16:50:26	MarkDuplicates	Marking 3129761 records as duplicates.
INFO	2020-09-15 16:50:26	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 16:50:27	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 16:51:59	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:31s.  Time for last 10,000,000:   91s.  Last read position: lcl|39903:3
INFO	2020-09-15 16:52:36	MarkDuplicates	Before output close freeMemory: 22922875288; totalMemory: 23130013696; maxMemory: 28631367680
INFO	2020-09-15 16:52:36	MarkDuplicates	After output close freeMemory: 22956646296; totalMemory: 23164616704; maxMemory: 28631367680
[Tue Sep 15 16:52:36 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 4.07 minutes.
Runtime.totalMemory()=23164616704
INFO	2020-09-15 16:52:38	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG_DM.bam
**********


16:52:38.861 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 16:52:38 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 16:52:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 16:53:11	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253c_CA_sorted_RG_DM.bai
[Tue Sep 15 16:53:11 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.55 minutes.
Runtime.totalMemory()=5186781184
java -ea -Xmx226182m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253d_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253d_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253d_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253d_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.588 seconds.
Analyzed Index:   	3.008 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	0.566 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	15116184	(1200071463 bases)

Mapping:          	388.682 seconds.
Reads/sec:       	38890.90
kBases/sec:      	3087.54


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 41.3397% 	  3124493 	 41.7539% 	   501076324
bad pairs:       	  0.0117% 	      884 	  0.0107% 	      127874
insert size avg: 	  281.65


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 66.4126% 	  5019526 	 65.6009% 	   392527841
unambiguous:     	 45.4478% 	  3434990 	 46.4175% 	   277742616
ambiguous:       	 20.9648% 	  1584536 	 19.1834% 	   114785225
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 23.8337% 	  1801370 	 19.3245% 	   115629370
semiperfect site:	 34.2673% 	  2589956 	 30.8489% 	   184587003
rescued:         	  4.2220% 	   319100

Match Rate:      	      NA 	       NA 	 94.5867% 	   373095063
Error Rate:      	 49.9598% 	  2936096 	  3.1215% 	    12312535
Sub Rate:        	 49.2180% 	  2892499 	  2.4764% 	     9768043
Del Rate:        	  4.6231% 	   271693 	  0.4867% 	     1919960
Ins Rate:        	  3.3734% 	   198252 	  0.1583% 	      624532
N Rate:          	 11.6848% 	   686706 	  2.2919% 	     9040203


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 57.8296% 	  4370816 	 57.9176% 	   348498059
unambiguous:     	 41.6872% 	  3150760 	 42.7406% 	   257175809
ambiguous:       	 16.1424% 	  1220056 	 15.1770% 	    91322250
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 18.1628% 	  1372760 	 15.1866% 	    91379673
semiperfect site:	 27.9208% 	  2110277 	 25.7411% 	   154887563
rescued:         	  5.2750% 	   398686

Match Rate:      	      NA 	       NA 	 93.9331% 	   329151611
Error Rate:      	 46.2451% 	  2715177 	  3.4404% 	    12055378
Sub Rate:        	 45.5114% 	  2672096 	  2.7180% 	     9524098
Del Rate:        	  4.6031% 	   270258 	  0.5458% 	     1912431
Ins Rate:        	  3.3417% 	   196200 	  0.1766% 	      618849
N Rate:          	 11.8797% 	   697487 	  2.6265% 	     9203501

Total time:     	393.261 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 17:01:07	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG.bam -RGID 1 -RGLB 253d_CA -RGPL illumina -RGPU combined_runs -RGSM 253d_CA
**********


17:01:07.903 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:01:07 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG.bam RGID=1 RGLB=253d_CA RGPL=illumina RGPU=combined_runs RGSM=253d_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:01:07 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:01:08	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=253d_CA SM=253d_CA

INFO	2020-09-15 17:01:16	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|9125:19
INFO	2020-09-15 17:01:25	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|10642:48
INFO	2020-09-15 17:01:33	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|13744:296
INFO	2020-09-15 17:01:41	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:33s.  Time for last 1,000,000:    8s.  Last read position: lcl|6424:99
INFO	2020-09-15 17:01:49	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:41s.  Time for last 1,000,000:    8s.  Last read position: lcl|21740:35
INFO	2020-09-15 17:01:58	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:49s.  Time for last 1,000,000:    8s.  Last read position: lcl|26146:274
INFO	2020-09-15 17:02:06	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:57s.  Time for last 1,000,000:    8s.  Last read position: lcl|22521:117
INFO	2020-09-15 17:02:14	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:05s.  Time for last 1,000,000:    8s.  Last read position: lcl|31818:71
INFO	2020-09-15 17:02:22	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:14s.  Time for last 1,000,000:    8s.  Last read position: lcl|39032:25
INFO	2020-09-15 17:02:31	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:22s.  Time for last 1,000,000:    8s.  Last read position: lcl|28176:61
INFO	2020-09-15 17:02:39	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:31s.  Time for last 1,000,000:    8s.  Last read position: lcl|44659:107
INFO	2020-09-15 17:02:47	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:39s.  Time for last 1,000,000:    8s.  Last read position: lcl|41558:80
INFO	2020-09-15 17:02:57	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:48s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 17:03:04	AddOrReplaceReadGroups	Processed    14,000,000 records.  Elapsed time: 00:01:55s.  Time for last 1,000,000:    6s.  Last read position: */*
INFO	2020-09-15 17:03:14	AddOrReplaceReadGroups	Processed    15,000,000 records.  Elapsed time: 00:02:05s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 17:03:15 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 2.12 minutes.
Runtime.totalMemory()=1868562432
INFO	2020-09-15 17:03:30	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


17:03:31.005 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:03:31 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:03:31 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:03:31	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 17:03:31	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 17:03:31	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 17:03:33	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1112:12058:35637 1:N:0:GAAGTACC+TTCGTACG. Cause: String 'GAAGTACC+TTCGTACG' did not start with a parsable number.
INFO	2020-09-15 17:03:38	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|9125:19
INFO	2020-09-15 17:03:38	MarkDuplicates	Tracking 867 as yet unmatched pairs. 832 records in RAM.
INFO	2020-09-15 17:03:43	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|10642:48
INFO	2020-09-15 17:03:43	MarkDuplicates	Tracking 128 as yet unmatched pairs. 83 records in RAM.
INFO	2020-09-15 17:03:50	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    7s.  Last read position: lcl|13744:296
INFO	2020-09-15 17:03:50	MarkDuplicates	Tracking 102 as yet unmatched pairs. 38 records in RAM.
INFO	2020-09-15 17:03:55	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    4s.  Last read position: lcl|6424:99
INFO	2020-09-15 17:03:55	MarkDuplicates	Tracking 93 as yet unmatched pairs. 41 records in RAM.
INFO	2020-09-15 17:04:01	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    6s.  Last read position: lcl|21740:35
INFO	2020-09-15 17:04:01	MarkDuplicates	Tracking 240 as yet unmatched pairs. 186 records in RAM.
INFO	2020-09-15 17:04:06	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    4s.  Last read position: lcl|26146:274
INFO	2020-09-15 17:04:06	MarkDuplicates	Tracking 106 as yet unmatched pairs. 22 records in RAM.
INFO	2020-09-15 17:04:13	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:    7s.  Last read position: lcl|22521:117
INFO	2020-09-15 17:04:13	MarkDuplicates	Tracking 677 as yet unmatched pairs. 612 records in RAM.
INFO	2020-09-15 17:04:18	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:44s.  Time for last 1,000,000:    4s.  Last read position: lcl|31818:71
INFO	2020-09-15 17:04:18	MarkDuplicates	Tracking 91 as yet unmatched pairs. 27 records in RAM.
INFO	2020-09-15 17:04:34	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:01:01s.  Time for last 1,000,000:   16s.  Last read position: lcl|39032:25
INFO	2020-09-15 17:04:34	MarkDuplicates	Tracking 182 as yet unmatched pairs. 70 records in RAM.
INFO	2020-09-15 17:04:39	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:01:05s.  Time for last 1,000,000:    4s.  Last read position: lcl|28176:61
INFO	2020-09-15 17:04:39	MarkDuplicates	Tracking 692 as yet unmatched pairs. 611 records in RAM.
INFO	2020-09-15 17:04:44	MarkDuplicates	Read    11,000,000 records.  Elapsed time: 00:01:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|44659:107
INFO	2020-09-15 17:04:44	MarkDuplicates	Tracking 245 as yet unmatched pairs. 223 records in RAM.
INFO	2020-09-15 17:04:51	MarkDuplicates	Read    12,000,000 records.  Elapsed time: 00:01:18s.  Time for last 1,000,000:    7s.  Last read position: lcl|41558:80
INFO	2020-09-15 17:04:51	MarkDuplicates	Tracking 614 as yet unmatched pairs. 158 records in RAM.
INFO	2020-09-15 17:04:53	MarkDuplicates	Read 12529930 records. 0 pairs never matched.
INFO	2020-09-15 17:05:06	MarkDuplicates	After buildSortedReadEndLists freeMemory: 10881491776; totalMemory: 12823560192; maxMemory: 28631367680
INFO	2020-09-15 17:05:06	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 17:05:09	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 17:05:32	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 17:05:32	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 17:05:33	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15970531376; totalMemory: 23319805952; maxMemory: 28631367680
INFO	2020-09-15 17:05:33	MarkDuplicates	Marking 3723608 records as duplicates.
INFO	2020-09-15 17:05:33	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 17:05:34	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 17:07:05	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:31s.  Time for last 10,000,000:   91s.  Last read position: lcl|28176:61
INFO	2020-09-15 17:07:53	MarkDuplicates	Before output close freeMemory: 23093674168; totalMemory: 23302504448; maxMemory: 28631367680
INFO	2020-09-15 17:07:53	MarkDuplicates	After output close freeMemory: 22750789816; totalMemory: 22959620096; maxMemory: 28631367680
[Tue Sep 15 17:07:53 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 4.38 minutes.
Runtime.totalMemory()=22959620096
INFO	2020-09-15 17:07:55	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG_DM.bam
**********


17:07:55.817 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:07:55 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:07:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:08:30	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253d_CA_sorted_RG_DM.bai
[Tue Sep 15 17:08:30 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.58 minutes.
Runtime.totalMemory()=5187305472
java -ea -Xmx226183m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253e_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253e_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253e_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/253e_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.555 seconds.
Analyzed Index:   	3.459 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.561 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	45588760	(3594622900 bases)

Mapping:          	1098.957 seconds.
Reads/sec:       	41483.64
kBases/sec:      	3270.94


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 44.7816% 	 10207684 	 44.7377% 	  1608150884
bad pairs:       	  0.0133% 	     3037 	  0.0121% 	      435136
insert size avg: 	  290.28


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 71.4015% 	 16275533 	 70.0296% 	  1254161875
unambiguous:     	 48.3110% 	 11012185 	 49.1686% 	   880561437
ambiguous:       	 23.0906% 	  5263348 	 20.8610% 	   373600438
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 33.4057% 	  7614632 	 27.7379% 	   496759092
semiperfect site:	 46.7992% 	 10667581 	 42.7794% 	   766136283
rescued:         	  3.9088% 	   890982

Match Rate:      	      NA 	       NA 	 95.4323% 	  1202660559
Error Rate:      	 40.2469% 	  7546098 	  2.3746% 	    29925142
Sub Rate:        	 39.6447% 	  7433196 	  1.7617% 	    22201071
Del Rate:        	  3.4041% 	   638262 	  0.4811% 	     6062390
Ins Rate:        	  2.7454% 	   514757 	  0.1319% 	     1661681
N Rate:          	 11.7259% 	  2198544 	  2.1931% 	    27638564


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 59.8936% 	 13652377 	 59.8215% 	  1079012497
unambiguous:     	 43.1657% 	  9839358 	 44.1448% 	   796248952
ambiguous:       	 16.7279% 	  3813019 	 15.6767% 	   282763545
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 24.6298% 	  5614218 	 21.1317% 	   381157337
semiperfect site:	 37.1693% 	  8472510 	 34.8533% 	   628656109
rescued:         	  5.0438% 	  1149706

Match Rate:      	      NA 	       NA 	 94.6912% 	  1027530607
Error Rate:      	 36.9227% 	  6913473 	  2.7227% 	    29545378
Sub Rate:        	 36.3262% 	  6801797 	  2.0049% 	    21755657
Del Rate:        	  3.4289% 	   642041 	  0.5646% 	     6126435
Ins Rate:        	  2.7494% 	   514809 	  0.1533% 	     1663286
N Rate:          	 11.9265% 	  2233143 	  2.5861% 	    28062947

Total time:     	1103.954 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 17:30:55	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG.bam -RGID 1 -RGLB 253e_CA -RGPL illumina -RGPU combined_runs -RGSM 253e_CA
**********


17:30:55.695 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:30:55 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG.bam RGID=1 RGLB=253e_CA RGPL=illumina RGPU=combined_runs RGSM=253e_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:30:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:30:55	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=253e_CA SM=253e_CA

INFO	2020-09-15 17:31:04	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|7581:60
INFO	2020-09-15 17:31:12	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    7s.  Last read position: lcl|4877:34
INFO	2020-09-15 17:31:20	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:    8s.  Last read position: lcl|9052:424
INFO	2020-09-15 17:31:28	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    7s.  Last read position: lcl|9809:223
INFO	2020-09-15 17:31:36	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:    8s.  Last read position: lcl|1818:16
INFO	2020-09-15 17:31:44	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:48s.  Time for last 1,000,000:    7s.  Last read position: lcl|11321:1
INFO	2020-09-15 17:31:52	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:55s.  Time for last 1,000,000:    7s.  Last read position: lcl|92:155
INFO	2020-09-15 17:32:00	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:04s.  Time for last 1,000,000:    8s.  Last read position: lcl|363:98
INFO	2020-09-15 17:32:08	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:12s.  Time for last 1,000,000:    8s.  Last read position: lcl|13131:298
INFO	2020-09-15 17:32:16	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:20s.  Time for last 1,000,000:    8s.  Last read position: lcl|13834:69
INFO	2020-09-15 17:32:24	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:28s.  Time for last 1,000,000:    7s.  Last read position: lcl|3131:88
INFO	2020-09-15 17:32:32	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:36s.  Time for last 1,000,000:    7s.  Last read position: lcl|10947:11
INFO	2020-09-15 17:32:40	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:44s.  Time for last 1,000,000:    8s.  Last read position: lcl|8488:5
INFO	2020-09-15 17:32:49	AddOrReplaceReadGroups	Processed    14,000,000 records.  Elapsed time: 00:01:52s.  Time for last 1,000,000:    8s.  Last read position: lcl|458:122
INFO	2020-09-15 17:32:57	AddOrReplaceReadGroups	Processed    15,000,000 records.  Elapsed time: 00:02:01s.  Time for last 1,000,000:    8s.  Last read position: lcl|18334:13
INFO	2020-09-15 17:33:05	AddOrReplaceReadGroups	Processed    16,000,000 records.  Elapsed time: 00:02:09s.  Time for last 1,000,000:    8s.  Last read position: lcl|23216:13
INFO	2020-09-15 17:33:13	AddOrReplaceReadGroups	Processed    17,000,000 records.  Elapsed time: 00:02:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|17811:168
INFO	2020-09-15 17:33:21	AddOrReplaceReadGroups	Processed    18,000,000 records.  Elapsed time: 00:02:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|15045:17
INFO	2020-09-15 17:33:29	AddOrReplaceReadGroups	Processed    19,000,000 records.  Elapsed time: 00:02:33s.  Time for last 1,000,000:    7s.  Last read position: lcl|26008:50
INFO	2020-09-15 17:33:37	AddOrReplaceReadGroups	Processed    20,000,000 records.  Elapsed time: 00:02:41s.  Time for last 1,000,000:    8s.  Last read position: lcl|14513:36
INFO	2020-09-15 17:33:46	AddOrReplaceReadGroups	Processed    21,000,000 records.  Elapsed time: 00:02:49s.  Time for last 1,000,000:    8s.  Last read position: lcl|950:16
INFO	2020-09-15 17:33:54	AddOrReplaceReadGroups	Processed    22,000,000 records.  Elapsed time: 00:02:57s.  Time for last 1,000,000:    7s.  Last read position: lcl|21311:120
INFO	2020-09-15 17:34:02	AddOrReplaceReadGroups	Processed    23,000,000 records.  Elapsed time: 00:03:06s.  Time for last 1,000,000:    8s.  Last read position: lcl|18155:1
INFO	2020-09-15 17:34:10	AddOrReplaceReadGroups	Processed    24,000,000 records.  Elapsed time: 00:03:13s.  Time for last 1,000,000:    7s.  Last read position: lcl|29584:25
INFO	2020-09-15 17:34:18	AddOrReplaceReadGroups	Processed    25,000,000 records.  Elapsed time: 00:03:22s.  Time for last 1,000,000:    8s.  Last read position: lcl|33807:10
INFO	2020-09-15 17:34:26	AddOrReplaceReadGroups	Processed    26,000,000 records.  Elapsed time: 00:03:30s.  Time for last 1,000,000:    7s.  Last read position: lcl|32814:51
INFO	2020-09-15 17:34:34	AddOrReplaceReadGroups	Processed    27,000,000 records.  Elapsed time: 00:03:38s.  Time for last 1,000,000:    8s.  Last read position: lcl|31429:17
INFO	2020-09-15 17:34:43	AddOrReplaceReadGroups	Processed    28,000,000 records.  Elapsed time: 00:03:46s.  Time for last 1,000,000:    8s.  Last read position: lcl|37519:30
INFO	2020-09-15 17:34:51	AddOrReplaceReadGroups	Processed    29,000,000 records.  Elapsed time: 00:03:55s.  Time for last 1,000,000:    8s.  Last read position: lcl|41279:40
INFO	2020-09-15 17:34:59	AddOrReplaceReadGroups	Processed    30,000,000 records.  Elapsed time: 00:04:03s.  Time for last 1,000,000:    8s.  Last read position: lcl|12643:41
INFO	2020-09-15 17:35:07	AddOrReplaceReadGroups	Processed    31,000,000 records.  Elapsed time: 00:04:11s.  Time for last 1,000,000:    8s.  Last read position: lcl|28882:302
INFO	2020-09-15 17:35:15	AddOrReplaceReadGroups	Processed    32,000,000 records.  Elapsed time: 00:04:19s.  Time for last 1,000,000:    8s.  Last read position: lcl|16360:61
INFO	2020-09-15 17:35:24	AddOrReplaceReadGroups	Processed    33,000,000 records.  Elapsed time: 00:04:28s.  Time for last 1,000,000:    8s.  Last read position: lcl|26714:11
INFO	2020-09-15 17:35:32	AddOrReplaceReadGroups	Processed    34,000,000 records.  Elapsed time: 00:04:36s.  Time for last 1,000,000:    8s.  Last read position: lcl|26918:44
INFO	2020-09-15 17:35:40	AddOrReplaceReadGroups	Processed    35,000,000 records.  Elapsed time: 00:04:44s.  Time for last 1,000,000:    8s.  Last read position: lcl|38960:105
INFO	2020-09-15 17:35:48	AddOrReplaceReadGroups	Processed    36,000,000 records.  Elapsed time: 00:04:52s.  Time for last 1,000,000:    8s.  Last read position: lcl|37858:45
INFO	2020-09-15 17:35:57	AddOrReplaceReadGroups	Processed    37,000,000 records.  Elapsed time: 00:05:01s.  Time for last 1,000,000:    8s.  Last read position: lcl|38385:69
INFO	2020-09-15 17:36:05	AddOrReplaceReadGroups	Processed    38,000,000 records.  Elapsed time: 00:05:09s.  Time for last 1,000,000:    8s.  Last read position: lcl|41774:64
INFO	2020-09-15 17:36:14	AddOrReplaceReadGroups	Processed    39,000,000 records.  Elapsed time: 00:05:18s.  Time for last 1,000,000:    8s.  Last read position: lcl|46642:65
INFO	2020-09-15 17:36:26	AddOrReplaceReadGroups	Processed    40,000,000 records.  Elapsed time: 00:05:30s.  Time for last 1,000,000:   12s.  Last read position: */*
INFO	2020-09-15 17:36:34	AddOrReplaceReadGroups	Processed    41,000,000 records.  Elapsed time: 00:05:38s.  Time for last 1,000,000:    8s.  Last read position: */*
INFO	2020-09-15 17:36:40	AddOrReplaceReadGroups	Processed    42,000,000 records.  Elapsed time: 00:05:44s.  Time for last 1,000,000:    5s.  Last read position: */*
INFO	2020-09-15 17:36:49	AddOrReplaceReadGroups	Processed    43,000,000 records.  Elapsed time: 00:05:53s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 17:37:00	AddOrReplaceReadGroups	Processed    44,000,000 records.  Elapsed time: 00:06:03s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 17:37:10	AddOrReplaceReadGroups	Processed    45,000,000 records.  Elapsed time: 00:06:14s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 17:37:16 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 6.35 minutes.
Runtime.totalMemory()=1823997952
INFO	2020-09-15 17:38:01	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


17:38:01.991 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:38:02 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:38:02 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:38:02	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 17:38:02	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 17:38:02	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 17:38:04	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1303:13885:35310 1:N:0:CAGGTATC+TTCGTACG. Cause: String 'CAGGTATC+TTCGTACG' did not start with a parsable number.
INFO	2020-09-15 17:38:10	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|7581:60
INFO	2020-09-15 17:38:10	MarkDuplicates	Tracking 233 as yet unmatched pairs. 208 records in RAM.
INFO	2020-09-15 17:38:15	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|4877:34
INFO	2020-09-15 17:38:15	MarkDuplicates	Tracking 777 as yet unmatched pairs. 676 records in RAM.
INFO	2020-09-15 17:38:20	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    4s.  Last read position: lcl|9052:424
INFO	2020-09-15 17:38:20	MarkDuplicates	Tracking 3274 as yet unmatched pairs. 3212 records in RAM.
INFO	2020-09-15 17:38:25	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:    4s.  Last read position: lcl|9809:223
INFO	2020-09-15 17:38:25	MarkDuplicates	Tracking 1117 as yet unmatched pairs. 948 records in RAM.
INFO	2020-09-15 17:38:32	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    7s.  Last read position: lcl|1818:16
INFO	2020-09-15 17:38:32	MarkDuplicates	Tracking 216 as yet unmatched pairs. 5 records in RAM.
INFO	2020-09-15 17:38:36	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:31s.  Time for last 1,000,000:    3s.  Last read position: lcl|11321:1
INFO	2020-09-15 17:38:36	MarkDuplicates	Tracking 209 as yet unmatched pairs. 64 records in RAM.
INFO	2020-09-15 17:38:42	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:    6s.  Last read position: lcl|92:155
INFO	2020-09-15 17:38:42	MarkDuplicates	Tracking 278 as yet unmatched pairs. 190 records in RAM.
INFO	2020-09-15 17:38:46	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:41s.  Time for last 1,000,000:    3s.  Last read position: lcl|363:98
INFO	2020-09-15 17:38:46	MarkDuplicates	Tracking 2726 as yet unmatched pairs. 2642 records in RAM.
INFO	2020-09-15 17:38:51	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:00:46s.  Time for last 1,000,000:    4s.  Last read position: lcl|13131:298
INFO	2020-09-15 17:38:51	MarkDuplicates	Tracking 1481 as yet unmatched pairs. 1348 records in RAM.
INFO	2020-09-15 17:39:11	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:01:06s.  Time for last 1,000,000:   20s.  Last read position: lcl|13834:69
INFO	2020-09-15 17:39:11	MarkDuplicates	Tracking 876 as yet unmatched pairs. 731 records in RAM.
INFO	2020-09-15 17:39:15	MarkDuplicates	Read    11,000,000 records.  Elapsed time: 00:01:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|3131:88
INFO	2020-09-15 17:39:15	MarkDuplicates	Tracking 262 as yet unmatched pairs. 66 records in RAM.
INFO	2020-09-15 17:39:20	MarkDuplicates	Read    12,000,000 records.  Elapsed time: 00:01:15s.  Time for last 1,000,000:    4s.  Last read position: lcl|10947:11
INFO	2020-09-15 17:39:20	MarkDuplicates	Tracking 3733 as yet unmatched pairs. 3515 records in RAM.
INFO	2020-09-15 17:39:28	MarkDuplicates	Read    13,000,000 records.  Elapsed time: 00:01:23s.  Time for last 1,000,000:    7s.  Last read position: lcl|8488:5
INFO	2020-09-15 17:39:28	MarkDuplicates	Tracking 1540 as yet unmatched pairs. 1356 records in RAM.
INFO	2020-09-15 17:39:31	MarkDuplicates	Read    14,000,000 records.  Elapsed time: 00:01:27s.  Time for last 1,000,000:    3s.  Last read position: lcl|458:122
INFO	2020-09-15 17:39:31	MarkDuplicates	Tracking 775 as yet unmatched pairs. 608 records in RAM.
INFO	2020-09-15 17:39:35	MarkDuplicates	Read    15,000,000 records.  Elapsed time: 00:01:30s.  Time for last 1,000,000:    3s.  Last read position: lcl|18334:13
INFO	2020-09-15 17:39:35	MarkDuplicates	Tracking 820 as yet unmatched pairs. 523 records in RAM.
INFO	2020-09-15 17:39:39	MarkDuplicates	Read    16,000,000 records.  Elapsed time: 00:01:34s.  Time for last 1,000,000:    4s.  Last read position: lcl|23216:13
INFO	2020-09-15 17:39:39	MarkDuplicates	Tracking 306 as yet unmatched pairs. 144 records in RAM.
INFO	2020-09-15 17:39:51	MarkDuplicates	Read    17,000,000 records.  Elapsed time: 00:01:46s.  Time for last 1,000,000:   11s.  Last read position: lcl|17811:168
INFO	2020-09-15 17:39:51	MarkDuplicates	Tracking 440 as yet unmatched pairs. 204 records in RAM.
INFO	2020-09-15 17:39:55	MarkDuplicates	Read    18,000,000 records.  Elapsed time: 00:01:51s.  Time for last 1,000,000:    4s.  Last read position: lcl|15045:17
INFO	2020-09-15 17:39:55	MarkDuplicates	Tracking 403 as yet unmatched pairs. 202 records in RAM.
INFO	2020-09-15 17:40:00	MarkDuplicates	Read    19,000,000 records.  Elapsed time: 00:01:55s.  Time for last 1,000,000:    4s.  Last read position: lcl|26008:50
INFO	2020-09-15 17:40:00	MarkDuplicates	Tracking 678 as yet unmatched pairs. 455 records in RAM.
INFO	2020-09-15 17:40:10	MarkDuplicates	Read    20,000,000 records.  Elapsed time: 00:02:06s.  Time for last 1,000,000:   10s.  Last read position: lcl|14513:36
INFO	2020-09-15 17:40:10	MarkDuplicates	Tracking 536 as yet unmatched pairs. 295 records in RAM.
INFO	2020-09-15 17:40:15	MarkDuplicates	Read    21,000,000 records.  Elapsed time: 00:02:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|950:16
INFO	2020-09-15 17:40:15	MarkDuplicates	Tracking 222 as yet unmatched pairs. 46 records in RAM.
INFO	2020-09-15 17:40:20	MarkDuplicates	Read    22,000,000 records.  Elapsed time: 00:02:15s.  Time for last 1,000,000:    4s.  Last read position: lcl|21311:120
INFO	2020-09-15 17:40:20	MarkDuplicates	Tracking 1658 as yet unmatched pairs. 511 records in RAM.
INFO	2020-09-15 17:40:24	MarkDuplicates	Read    23,000,000 records.  Elapsed time: 00:02:20s.  Time for last 1,000,000:    4s.  Last read position: lcl|18155:1
INFO	2020-09-15 17:40:24	MarkDuplicates	Tracking 237 as yet unmatched pairs. 60 records in RAM.
INFO	2020-09-15 17:40:53	MarkDuplicates	Read    24,000,000 records.  Elapsed time: 00:02:48s.  Time for last 1,000,000:   28s.  Last read position: lcl|29584:25
INFO	2020-09-15 17:40:53	MarkDuplicates	Tracking 597 as yet unmatched pairs. 263 records in RAM.
INFO	2020-09-15 17:40:57	MarkDuplicates	Read    25,000,000 records.  Elapsed time: 00:02:53s.  Time for last 1,000,000:    4s.  Last read position: lcl|33807:10
INFO	2020-09-15 17:40:57	MarkDuplicates	Tracking 578 as yet unmatched pairs. 415 records in RAM.
INFO	2020-09-15 17:41:02	MarkDuplicates	Read    26,000,000 records.  Elapsed time: 00:02:57s.  Time for last 1,000,000:    4s.  Last read position: lcl|32814:51
INFO	2020-09-15 17:41:02	MarkDuplicates	Tracking 210 as yet unmatched pairs. 8 records in RAM.
INFO	2020-09-15 17:41:06	MarkDuplicates	Read    27,000,000 records.  Elapsed time: 00:03:02s.  Time for last 1,000,000:    4s.  Last read position: lcl|31429:17
INFO	2020-09-15 17:41:06	MarkDuplicates	Tracking 1010 as yet unmatched pairs. 648 records in RAM.
INFO	2020-09-15 17:41:15	MarkDuplicates	Read    28,000,000 records.  Elapsed time: 00:03:11s.  Time for last 1,000,000:    8s.  Last read position: lcl|37519:30
INFO	2020-09-15 17:41:15	MarkDuplicates	Tracking 720 as yet unmatched pairs. 566 records in RAM.
INFO	2020-09-15 17:41:20	MarkDuplicates	Read    29,000,000 records.  Elapsed time: 00:03:15s.  Time for last 1,000,000:    4s.  Last read position: lcl|41279:40
INFO	2020-09-15 17:41:20	MarkDuplicates	Tracking 950 as yet unmatched pairs. 804 records in RAM.
INFO	2020-09-15 17:41:24	MarkDuplicates	Read    30,000,000 records.  Elapsed time: 00:03:20s.  Time for last 1,000,000:    4s.  Last read position: lcl|12643:41
INFO	2020-09-15 17:41:24	MarkDuplicates	Tracking 362 as yet unmatched pairs. 233 records in RAM.
INFO	2020-09-15 17:41:29	MarkDuplicates	Read    31,000,000 records.  Elapsed time: 00:03:25s.  Time for last 1,000,000:    4s.  Last read position: lcl|28882:302
INFO	2020-09-15 17:41:29	MarkDuplicates	Tracking 400 as yet unmatched pairs. 179 records in RAM.
INFO	2020-09-15 17:41:39	MarkDuplicates	Read    32,000,000 records.  Elapsed time: 00:03:35s.  Time for last 1,000,000:    9s.  Last read position: lcl|16360:61
INFO	2020-09-15 17:41:39	MarkDuplicates	Tracking 1942 as yet unmatched pairs. 1844 records in RAM.
INFO	2020-09-15 17:41:43	MarkDuplicates	Read    33,000,000 records.  Elapsed time: 00:03:38s.  Time for last 1,000,000:    3s.  Last read position: lcl|26714:11
INFO	2020-09-15 17:41:43	MarkDuplicates	Tracking 333 as yet unmatched pairs. 189 records in RAM.
INFO	2020-09-15 17:41:46	MarkDuplicates	Read    34,000,000 records.  Elapsed time: 00:03:42s.  Time for last 1,000,000:    3s.  Last read position: lcl|26918:44
INFO	2020-09-15 17:41:46	MarkDuplicates	Tracking 1230 as yet unmatched pairs. 1048 records in RAM.
INFO	2020-09-15 17:41:55	MarkDuplicates	Read    35,000,000 records.  Elapsed time: 00:03:51s.  Time for last 1,000,000:    8s.  Last read position: lcl|38960:105
INFO	2020-09-15 17:41:55	MarkDuplicates	Tracking 184 as yet unmatched pairs. 132 records in RAM.
INFO	2020-09-15 17:41:59	MarkDuplicates	Read    36,000,000 records.  Elapsed time: 00:03:55s.  Time for last 1,000,000:    4s.  Last read position: lcl|37858:45
INFO	2020-09-15 17:41:59	MarkDuplicates	Tracking 350 as yet unmatched pairs. 210 records in RAM.
INFO	2020-09-15 17:42:04	MarkDuplicates	Read    37,000,000 records.  Elapsed time: 00:03:59s.  Time for last 1,000,000:    4s.  Last read position: lcl|38385:69
INFO	2020-09-15 17:42:04	MarkDuplicates	Tracking 1420 as yet unmatched pairs. 1292 records in RAM.
INFO	2020-09-15 17:42:08	MarkDuplicates	Read    38,000,000 records.  Elapsed time: 00:04:04s.  Time for last 1,000,000:    4s.  Last read position: lcl|41774:64
INFO	2020-09-15 17:42:08	MarkDuplicates	Tracking 8230 as yet unmatched pairs. 8174 records in RAM.
INFO	2020-09-15 17:42:48	MarkDuplicates	Read    39,000,000 records.  Elapsed time: 00:04:43s.  Time for last 1,000,000:   39s.  Last read position: lcl|46642:65
INFO	2020-09-15 17:42:48	MarkDuplicates	Tracking 1508 as yet unmatched pairs. 979 records in RAM.
INFO	2020-09-15 17:42:50	MarkDuplicates	Read 39434378 records. 0 pairs never matched.
INFO	2020-09-15 17:43:20	MarkDuplicates	After buildSortedReadEndLists freeMemory: 11574167416; totalMemory: 15500574720; maxMemory: 28631367680
INFO	2020-09-15 17:43:20	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 17:43:24	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 17:43:59	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 17:44:02	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 17:44:04	MarkDuplicates	After generateDuplicateIndexes freeMemory: 18485987208; totalMemory: 25830621184; maxMemory: 28631367680
INFO	2020-09-15 17:44:04	MarkDuplicates	Marking 14305969 records as duplicates.
INFO	2020-09-15 17:44:04	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 17:44:04	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 17:45:27	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:22s.  Time for last 10,000,000:   82s.  Last read position: lcl|13834:69
INFO	2020-09-15 17:46:53	MarkDuplicates	Written    20,000,000 records.  Elapsed time: 00:02:48s.  Time for last 10,000,000:   85s.  Last read position: lcl|14513:36
INFO	2020-09-15 17:48:22	MarkDuplicates	Written    30,000,000 records.  Elapsed time: 00:04:17s.  Time for last 10,000,000:   89s.  Last read position: lcl|12643:41
INFO	2020-09-15 17:49:54	MarkDuplicates	Written    40,000,000 records.  Elapsed time: 00:05:50s.  Time for last 10,000,000:   92s.  Last read position: */*
INFO	2020-09-15 17:50:46	MarkDuplicates	Before output close freeMemory: 25671951016; totalMemory: 25885147136; maxMemory: 28631367680
INFO	2020-09-15 17:50:46	MarkDuplicates	After output close freeMemory: 25247277736; totalMemory: 25460473856; maxMemory: 28631367680
[Tue Sep 15 17:50:46 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 12.75 minutes.
Runtime.totalMemory()=25460473856
INFO	2020-09-15 17:50:48	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG_DM.bam
**********


17:50:48.633 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:50:48 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:50:48 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:52:24	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/253e_CA_sorted_RG_DM.bai
[Tue Sep 15 17:52:24 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 1.59 minutes.
Runtime.totalMemory()=7604797440
java -ea -Xmx225784m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.519 seconds.
Analyzed Index:   	3.047 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.652 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2939224	(247987632 bases)

Mapping:          	84.449 seconds.
Reads/sec:       	34804.90
kBases/sec:      	2936.55


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 17.1121% 	   251482 	 17.0771% 	    42349076
bad pairs:       	  0.0080% 	      118 	  0.0074% 	       18362
insert size avg: 	  613.70


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.2139% 	   796734 	 52.8646% 	    65523047
unambiguous:     	 36.7999% 	   540816 	 37.6392% 	    46651829
ambiguous:       	 17.4140% 	   255918 	 15.2255% 	    18871218
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.6915% 	   259996 	 13.8535% 	    17170751
semiperfect site:	 25.1060% 	   368961 	 21.7804% 	    26995736
rescued:         	  0.7720% 	    11345

Match Rate:      	      NA 	       NA 	 93.7854% 	    61790304
Error Rate:      	 46.0984% 	   488421 	  3.3033% 	     2176376
Sub Rate:        	 45.2194% 	   479108 	  2.5817% 	     1700925
Del Rate:        	  4.8989% 	    51905 	  0.5491% 	      361758
Ins Rate:        	  3.6448% 	    38617 	  0.1726% 	      113693
N Rate:          	 12.5794% 	   133281 	  2.9113% 	     1918125


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.3333% 	   651527 	 43.9835% 	    54558327
unambiguous:     	 32.0261% 	   470659 	 32.9246% 	    40840557
ambiguous:       	 12.3072% 	   180868 	 11.0589% 	    13717770
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.2282% 	   179707 	  9.9438% 	    12334497
semiperfect site:	 18.5413% 	   272485 	 16.5249% 	    20497910
rescued:         	  0.9462% 	    13906

Match Rate:      	      NA 	       NA 	 92.9172% 	    51017950
Error Rate:      	 40.4348% 	   424995 	  3.7342% 	     2050340
Sub Rate:        	 39.6322% 	   416559 	  2.9033% 	     1594138
Del Rate:        	  4.6610% 	    48990 	  0.6348% 	      348571
Ins Rate:        	  3.4768% 	    36543 	  0.1960% 	      107631
N Rate:          	 12.3821% 	   130144 	  3.3486% 	     1838608

Total time:     	89.080 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 17:54:12	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG.bam -RGID 1 -RGLB 9a_CA -RGPL illumina -RGPU combined_runs -RGSM 9a_CA
**********


17:54:12.313 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:54:12 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG.bam RGID=1 RGLB=9a_CA RGPL=illumina RGPU=combined_runs RGSM=9a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:54:12 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:54:12	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=9a_CA SM=9a_CA

INFO	2020-09-15 17:54:21	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|20804:18
INFO	2020-09-15 17:54:30	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|24383:9
[Tue Sep 15 17:54:39 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.45 minutes.
Runtime.totalMemory()=1897922560
INFO	2020-09-15 17:54:42	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


17:54:43.205 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:54:43 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:54:43 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:54:43	MarkDuplicates	Start of doWork freeMemory: 2037938160; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 17:54:43	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 17:54:43	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 17:54:45	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2203:16907:48820 1:N:0:CCTATGGT+GTTCCATG. Cause: String 'CCTATGGT+GTTCCATG' did not start with a parsable number.
INFO	2020-09-15 17:54:52	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|20804:18
INFO	2020-09-15 17:54:52	MarkDuplicates	Tracking 9 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 17:54:57	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|24383:9
INFO	2020-09-15 17:54:57	MarkDuplicates	Tracking 34 as yet unmatched pairs. 29 records in RAM.
INFO	2020-09-15 17:54:59	MarkDuplicates	Read 2393322 records. 0 pairs never matched.
INFO	2020-09-15 17:55:02	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4801192832; totalMemory: 5848432640; maxMemory: 28631367680
INFO	2020-09-15 17:55:02	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 17:55:06	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 17:55:06	OpticalDuplicateFinder	Large duplicate set. size = 1347
INFO	2020-09-15 17:55:06	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 17:55:06	OpticalDuplicateFinder	Large duplicate set. size = 1232
INFO	2020-09-15 17:55:06	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 17:55:06	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 17:55:07	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 17:55:07	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5754772848; totalMemory: 13008633856; maxMemory: 28631367680
INFO	2020-09-15 17:55:07	MarkDuplicates	Marking 763020 records as duplicates.
INFO	2020-09-15 17:55:07	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 17:55:08	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 17:55:37	MarkDuplicates	Before output close freeMemory: 12908499240; totalMemory: 13010731008; maxMemory: 28631367680
INFO	2020-09-15 17:55:37	MarkDuplicates	After output close freeMemory: 17110089112; totalMemory: 17296785408; maxMemory: 28631367680
[Tue Sep 15 17:55:37 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.91 minutes.
Runtime.totalMemory()=17296785408
INFO	2020-09-15 17:55:38	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG_DM.bam
**********


17:55:39.072 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:55:39 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:55:39 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:55:50	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9a_CA_sorted_RG_DM.bai
[Tue Sep 15 17:55:50 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226045m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/9b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.524 seconds.
Analyzed Index:   	3.574 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.560 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	25708	(2057121 bases)

Mapping:          	6.675 seconds.
Reads/sec:       	3851.16
kBases/sec:      	308.16


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 40.6877% 	     5230 	 40.5923% 	      835032
bad pairs:       	  0.0000% 	        0 	  0.0000% 	           0
insert size avg: 	  251.45


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 64.5636% 	     8299 	 63.3948% 	      649399
unambiguous:     	 42.4459% 	     5456 	 43.1850% 	      442375
ambiguous:       	 22.1176% 	     2843 	 20.2098% 	      207024
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 19.4570% 	     2501 	 15.3085% 	      156816
semiperfect site:	 28.8626% 	     3710 	 25.4739% 	      260948
rescued:         	  4.2788% 	      550

Match Rate:      	      NA 	       NA 	 94.6526% 	      616727
Error Rate:      	 54.8048% 	     5418 	  3.2528% 	       21194
Sub Rate:        	 54.1169% 	     5350 	  2.7656% 	       18020
Del Rate:        	  4.8655% 	      481 	  0.3330% 	        2170
Ins Rate:        	  3.1256% 	      309 	  0.1541% 	        1004
N Rate:          	 11.1268% 	     1100 	  2.0946% 	       13648


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.9628% 	     7322 	 56.4678% 	      583171
unambiguous:     	 39.6219% 	     5093 	 40.1304% 	      414446
ambiguous:       	 17.3409% 	     2229 	 16.3375% 	      168725
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.9136% 	     1917 	 12.0112% 	      124046
semiperfect site:	 23.5802% 	     3031 	 21.1912% 	      218852
rescued:         	  5.8192% 	      748

Match Rate:      	      NA 	       NA 	 93.9959% 	      550502
Error Rate:      	 51.1872% 	     5023 	  3.6114% 	       21151
Sub Rate:        	 50.4942% 	     4955 	  3.0027% 	       17586
Del Rate:        	  4.0864% 	      401 	  0.4260% 	        2495
Ins Rate:        	  3.1998% 	      314 	  0.1827% 	        1070
N Rate:          	 11.4338% 	     1122 	  2.3927% 	       14013

Total time:     	11.748 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 17:56:03	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG.bam -RGID 1 -RGLB 9b_CA -RGPL illumina -RGPU combined_runs -RGSM 9b_CA
**********


17:56:03.488 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:56:03 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG.bam RGID=1 RGLB=9b_CA RGPL=illumina RGPU=combined_runs RGSM=9b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:56:03 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:56:03	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=9b_CA SM=9b_CA

[Tue Sep 15 17:56:04 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.02 minutes.
Runtime.totalMemory()=2058354688
INFO	2020-09-15 17:56:05	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


17:56:05.370 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:56:05 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:56:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:56:05	MarkDuplicates	Start of doWork freeMemory: 2037938160; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 17:56:05	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 17:56:05	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 17:56:07	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2111:14494:91480 1:N:0:ACCGCATA+AAGACGAG. Cause: String 'ACCGCATA+AAGACGAG' did not start with a parsable number.
INFO	2020-09-15 17:56:07	MarkDuplicates	Read 20782 records. 0 pairs never matched.
INFO	2020-09-15 17:56:09	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1207531184; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 17:56:09	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 17:56:13	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 17:56:13	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 17:56:13	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 17:56:14	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2565933352; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 17:56:14	MarkDuplicates	Marking 425 records as duplicates.
INFO	2020-09-15 17:56:14	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 17:56:14	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 17:56:14	MarkDuplicates	Before output close freeMemory: 9716624856; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 17:56:14	MarkDuplicates	After output close freeMemory: 9716700952; totalMemory: 9753853952; maxMemory: 28631367680
[Tue Sep 15 17:56:14 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.16 minutes.
Runtime.totalMemory()=9753853952
INFO	2020-09-15 17:56:15	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG_DM.bam
**********


17:56:16.177 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 17:56:16 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 17:56:16 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 17:56:19	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/9b_CA_sorted_RG_DM.bai
[Tue Sep 15 17:56:19 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.06 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226263m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.531 seconds.
Analyzed Index:   	2.715 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.542 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	15196728	(1208124430 bases)

Mapping:          	400.974 seconds.
Reads/sec:       	37899.53
kBases/sec:      	3012.97


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 39.4861% 	  3000294 	 39.7156% 	   479813966
bad pairs:       	  0.0086% 	      657 	  0.0080% 	       96642
insert size avg: 	  318.52


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 65.8132% 	  5000730 	 64.9238% 	   391304502
unambiguous:     	 42.4989% 	  3229222 	 43.5441% 	   262446515
ambiguous:       	 23.3143% 	  1771508 	 21.3796% 	   128857987
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 21.0992% 	  1603195 	 16.5042% 	    99473255
semiperfect site:	 31.7644% 	  2413571 	 28.2104% 	   170028092
rescued:         	  4.1970% 	   318900

Match Rate:      	      NA 	       NA 	 94.4947% 	   371922467
Error Rate:      	 52.4418% 	  3133280 	  3.2939% 	    12964473
Sub Rate:        	 51.6177% 	  3084041 	  2.5417% 	    10003726
Del Rate:        	  5.0630% 	   302501 	  0.5809% 	     2286205
Ins Rate:        	  3.4919% 	   208633 	  0.1714% 	      674542
N Rate:          	 11.9217% 	   712296 	  2.2114% 	     8703767


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.7603% 	  4312854 	 56.8610% 	   344242364
unambiguous:     	 38.9740% 	  2961390 	 40.1114% 	   242838471
ambiguous:       	 17.7862% 	  1351464 	 16.7496% 	   101403893
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.4975% 	  1177560 	 12.5657% 	    76074319
semiperfect site:	 25.3974% 	  1929787 	 23.1963% 	   140432582
rescued:         	  5.3304% 	   405022

Match Rate:      	      NA 	       NA 	 93.7780% 	   324951596
Error Rate:      	 48.0743% 	  2868606 	  3.6415% 	    12618175
Sub Rate:        	 47.2731% 	  2820800 	  2.7939% 	     9681131
Del Rate:        	  5.0115% 	   299038 	  0.6549% 	     2269235
Ins Rate:        	  3.4684% 	   206960 	  0.1927% 	      667809
N Rate:          	 12.1916% 	   727474 	  2.5805% 	     8941828

Total time:     	405.171 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:04:27	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG.bam -RGID 1 -RGLB 242a_CA -RGPL illumina -RGPU combined_runs -RGSM 242a_CA
**********


18:04:27.855 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:04:27 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG.bam RGID=1 RGLB=242a_CA RGPL=illumina RGPU=combined_runs RGSM=242a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:04:27 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:04:28	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=242a_CA SM=242a_CA

INFO	2020-09-15 18:04:36	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|9005:152
INFO	2020-09-15 18:04:44	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    7s.  Last read position: lcl|11345:87
INFO	2020-09-15 18:04:52	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:    7s.  Last read position: lcl|11885:60
INFO	2020-09-15 18:05:00	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    8s.  Last read position: lcl|11555:22
INFO	2020-09-15 18:05:08	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:    8s.  Last read position: lcl|20661:8
INFO	2020-09-15 18:05:17	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:48s.  Time for last 1,000,000:    8s.  Last read position: lcl|15644:154
INFO	2020-09-15 18:05:25	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:    8s.  Last read position: lcl|10259:107
INFO	2020-09-15 18:05:33	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:04s.  Time for last 1,000,000:    8s.  Last read position: lcl|30465:96
INFO	2020-09-15 18:05:41	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:12s.  Time for last 1,000,000:    8s.  Last read position: lcl|34193:21
INFO	2020-09-15 18:05:49	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:21s.  Time for last 1,000,000:    8s.  Last read position: lcl|20980:72
INFO	2020-09-15 18:05:57	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:29s.  Time for last 1,000,000:    8s.  Last read position: lcl|26981:8
INFO	2020-09-15 18:06:06	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:38s.  Time for last 1,000,000:    8s.  Last read position: lcl|46034:21
INFO	2020-09-15 18:06:15	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:47s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 18:06:26	AddOrReplaceReadGroups	Processed    14,000,000 records.  Elapsed time: 00:01:57s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 18:06:33	AddOrReplaceReadGroups	Processed    15,000,000 records.  Elapsed time: 00:02:04s.  Time for last 1,000,000:    6s.  Last read position: */*
[Tue Sep 15 18:06:34 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 2.11 minutes.
Runtime.totalMemory()=1868562432
INFO	2020-09-15 18:06:49	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:06:49.491 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:06:49 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:06:49 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:06:49	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:06:49	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:06:49	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:06:51	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2209:10570:15349 1:N:0:GAAGTACC+AAGACGAG. Cause: String 'GAAGTACC+AAGACGAG' did not start with a parsable number.
INFO	2020-09-15 18:06:58	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|9005:152
INFO	2020-09-15 18:06:58	MarkDuplicates	Tracking 136 as yet unmatched pairs. 123 records in RAM.
INFO	2020-09-15 18:07:02	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|11345:87
INFO	2020-09-15 18:07:02	MarkDuplicates	Tracking 178 as yet unmatched pairs. 76 records in RAM.
INFO	2020-09-15 18:07:09	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    6s.  Last read position: lcl|11885:60
INFO	2020-09-15 18:07:09	MarkDuplicates	Tracking 296 as yet unmatched pairs. 234 records in RAM.
INFO	2020-09-15 18:07:14	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    4s.  Last read position: lcl|11555:22
INFO	2020-09-15 18:07:14	MarkDuplicates	Tracking 102 as yet unmatched pairs. 65 records in RAM.
INFO	2020-09-15 18:07:20	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    5s.  Last read position: lcl|20661:8
INFO	2020-09-15 18:07:20	MarkDuplicates	Tracking 131 as yet unmatched pairs. 66 records in RAM.
INFO	2020-09-15 18:07:23	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    3s.  Last read position: lcl|15644:154
INFO	2020-09-15 18:07:23	MarkDuplicates	Tracking 324 as yet unmatched pairs. 220 records in RAM.
INFO	2020-09-15 18:07:29	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:37s.  Time for last 1,000,000:    5s.  Last read position: lcl|10259:107
INFO	2020-09-15 18:07:29	MarkDuplicates	Tracking 122 as yet unmatched pairs. 48 records in RAM.
INFO	2020-09-15 18:07:33	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:41s.  Time for last 1,000,000:    3s.  Last read position: lcl|30465:96
INFO	2020-09-15 18:07:33	MarkDuplicates	Tracking 344 as yet unmatched pairs. 276 records in RAM.
INFO	2020-09-15 18:07:49	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:00:58s.  Time for last 1,000,000:   16s.  Last read position: lcl|34193:21
INFO	2020-09-15 18:07:49	MarkDuplicates	Tracking 70 as yet unmatched pairs. 10 records in RAM.
INFO	2020-09-15 18:07:54	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:01:02s.  Time for last 1,000,000:    4s.  Last read position: lcl|20980:72
INFO	2020-09-15 18:07:54	MarkDuplicates	Tracking 319 as yet unmatched pairs. 262 records in RAM.
INFO	2020-09-15 18:07:58	MarkDuplicates	Read    11,000,000 records.  Elapsed time: 00:01:07s.  Time for last 1,000,000:    4s.  Last read position: lcl|26981:8
INFO	2020-09-15 18:07:58	MarkDuplicates	Tracking 166 as yet unmatched pairs. 141 records in RAM.
INFO	2020-09-15 18:08:05	MarkDuplicates	Read    12,000,000 records.  Elapsed time: 00:01:13s.  Time for last 1,000,000:    6s.  Last read position: lcl|46034:21
INFO	2020-09-15 18:08:05	MarkDuplicates	Tracking 380 as yet unmatched pairs. 59 records in RAM.
INFO	2020-09-15 18:08:07	MarkDuplicates	Read 12625266 records. 0 pairs never matched.
INFO	2020-09-15 18:08:19	MarkDuplicates	After buildSortedReadEndLists freeMemory: 10886049120; totalMemory: 12813598720; maxMemory: 28631367680
INFO	2020-09-15 18:08:19	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:08:23	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:08:43	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:08:44	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:08:46	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15944025984; totalMemory: 23294115840; maxMemory: 28631367680
INFO	2020-09-15 18:08:46	MarkDuplicates	Marking 4251379 records as duplicates.
INFO	2020-09-15 18:08:46	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:08:46	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:10:17	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:31s.  Time for last 10,000,000:   91s.  Last read position: lcl|20980:72
INFO	2020-09-15 18:11:06	MarkDuplicates	Before output close freeMemory: 23106938392; totalMemory: 23317184512; maxMemory: 28631367680
INFO	2020-09-15 18:11:06	MarkDuplicates	After output close freeMemory: 22805997080; totalMemory: 23016243200; maxMemory: 28631367680
[Tue Sep 15 18:11:06 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 4.29 minutes.
Runtime.totalMemory()=23016243200
INFO	2020-09-15 18:11:07	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG_DM.bam
**********


18:11:08.239 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:11:08 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:11:08 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:11:45	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242a_CA_sorted_RG_DM.bai
[Tue Sep 15 18:11:45 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.62 minutes.
Runtime.totalMemory()=5186781184
java -ea -Xmx226231m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.592 seconds.
Analyzed Index:   	2.968 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.532 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3972574	(349260091 bases)

Mapping:          	136.532 seconds.
Reads/sec:       	29096.28
kBases/sec:      	2558.08


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 19.0975% 	   379332 	 18.8277% 	    65757474
bad pairs:       	  0.0113% 	      224 	  0.0095% 	       33080
insert size avg: 	  556.23


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.5571% 	  1103523 	 53.3631% 	    92890848
unambiguous:     	 37.4403% 	   743672 	 38.0117% 	    66168143
ambiguous:       	 18.1168% 	   359851 	 15.3514% 	    26722705
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.4277% 	   346164 	 13.2102% 	    22995375
semiperfect site:	 25.2752% 	   502039 	 21.3512% 	    37166744
rescued:         	  2.4260% 	    48188

Match Rate:      	      NA 	       NA 	 93.4262% 	    87375087
Error Rate:      	 48.0733% 	   696587 	  3.5643% 	     3333472
Sub Rate:        	 47.3249% 	   685743 	  2.6798% 	     2506208
Del Rate:        	  5.1484% 	    74601 	  0.6761% 	      632278
Ins Rate:        	  4.1198% 	    59697 	  0.2085% 	      194986
N Rate:          	 13.0171% 	   188619 	  3.0095% 	     2814567


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.3808% 	   881530 	 43.2114% 	    75700798
unambiguous:     	 32.6517% 	   648557 	 33.0295% 	    57863390
ambiguous:       	 11.7291% 	   232973 	 10.1819% 	    17837408
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.5764% 	   229940 	  9.2054% 	    16126639
semiperfect site:	 18.3969% 	   365416 	 15.9997% 	    28029409
rescued:         	  3.0027% 	    59642

Match Rate:      	      NA 	       NA 	 92.0757% 	    70324939
Error Rate:      	 40.8307% 	   584863 	  4.1648% 	     3180934
Sub Rate:        	 40.1542% 	   575173 	  3.0360% 	     2318806
Del Rate:        	  5.0943% 	    72971 	  0.8857% 	      676494
Ins Rate:        	  4.0370% 	    57827 	  0.2430% 	      185634
N Rate:          	 13.9900% 	   200395 	  3.7595% 	     2871419

Total time:     	141.039 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:14:30	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG.bam -RGID 1 -RGLB 242b_CA -RGPL illumina -RGPU combined_runs -RGSM 242b_CA
**********


18:14:31.232 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:14:31 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG.bam RGID=1 RGLB=242b_CA RGPL=illumina RGPU=combined_runs RGSM=242b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:14:31 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:14:31	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=242b_CA SM=242b_CA

INFO	2020-09-15 18:14:40	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|6321:12
INFO	2020-09-15 18:14:49	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|31065:197
INFO	2020-09-15 18:14:58	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|39743:68
[Tue Sep 15 18:15:09 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.63 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 18:15:14	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:15:14.657 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:15:14 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:15:14 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:15:14	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:15:14	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:15:14	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:15:17	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1110:11825:92957 1:N:0:ACGTTACC+ACCGACAA. Cause: String 'ACGTTACC+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:15:24	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|6321:12
INFO	2020-09-15 18:15:24	MarkDuplicates	Tracking 24 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 18:15:27	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    3s.  Last read position: lcl|31065:197
INFO	2020-09-15 18:15:27	MarkDuplicates	Tracking 344 as yet unmatched pairs. 328 records in RAM.
INFO	2020-09-15 18:15:33	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|39743:68
INFO	2020-09-15 18:15:33	MarkDuplicates	Tracking 2 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 18:15:35	MarkDuplicates	Read 3210994 records. 0 pairs never matched.
INFO	2020-09-15 18:15:40	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4756720008; totalMemory: 5851578368; maxMemory: 28631367680
INFO	2020-09-15 18:15:40	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:15:43	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:15:44	OpticalDuplicateFinder	Large duplicate set. size = 1490
INFO	2020-09-15 18:15:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:15:44	OpticalDuplicateFinder	Large duplicate set. size = 1404
INFO	2020-09-15 18:15:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:15:44	OpticalDuplicateFinder	Large duplicate set. size = 1051
INFO	2020-09-15 18:15:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:15:44	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:15:44	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:15:45	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5794653496; totalMemory: 13049004032; maxMemory: 28631367680
INFO	2020-09-15 18:15:45	MarkDuplicates	Marking 1155283 records as duplicates.
INFO	2020-09-15 18:15:45	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:15:45	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:16:25	MarkDuplicates	Before output close freeMemory: 17171197872; totalMemory: 17357602816; maxMemory: 28631367680
INFO	2020-09-15 18:16:25	MarkDuplicates	After output close freeMemory: 17030688688; totalMemory: 17217093632; maxMemory: 28631367680
[Tue Sep 15 18:16:25 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.18 minutes.
Runtime.totalMemory()=17217093632
INFO	2020-09-15 18:16:26	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG_DM.bam
**********


18:16:26.845 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:16:26 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:16:26 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:16:37	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242b_CA_sorted_RG_DM.bai
[Tue Sep 15 18:16:37 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.17 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226297m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242c_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242c_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242c_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242c_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.489 seconds.
Analyzed Index:   	2.908 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.536 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	6074606	(491369543 bases)

Mapping:          	169.327 seconds.
Reads/sec:       	35875.05
kBases/sec:      	2901.90


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 29.0764% 	   883139 	 28.9231% 	   142119444
bad pairs:       	  0.0076% 	      230 	  0.0066% 	       32258
insert size avg: 	  464.11


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 58.4111% 	  1774122 	 57.3252% 	   140609311
unambiguous:     	 35.8114% 	  1087702 	 36.9614% 	    90660207
ambiguous:       	 22.5997% 	   686420 	 20.3638% 	    49949104
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 19.9751% 	   606705 	 15.5289% 	    38089917
semiperfect site:	 29.3908% 	   892687 	 25.7390% 	    63133453
rescued:         	  3.2083% 	    97445

Match Rate:      	      NA 	       NA 	 94.5965% 	   133612303
Error Rate:      	 48.2188% 	  1067960 	  2.8218% 	     3985574
Sub Rate:        	 47.1132% 	  1043472 	  2.2026% 	     3111013
Del Rate:        	  3.9561% 	    87620 	  0.4497% 	      635139
Ins Rate:        	  3.4535% 	    76488 	  0.1695% 	      239422
N Rate:          	 12.2416% 	   271130 	  2.5817% 	     3646573


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.5460% 	  1474490 	 48.4291% 	   119177209
unambiguous:     	 31.8189% 	   966436 	 33.0047% 	    81219858
ambiguous:       	 16.7271% 	   508054 	 15.4244% 	    37957351
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.2789% 	   433693 	 11.5104% 	    28325459
semiperfect site:	 22.6203% 	   687046 	 20.3143% 	    49990610
rescued:         	  4.0649% 	   123463

Match Rate:      	      NA 	       NA 	 93.8589% 	   112445240
Error Rate:      	 43.0020% 	   947158 	  3.1960% 	     3828941
Sub Rate:        	 41.9570% 	   924143 	  2.4782% 	     2968884
Del Rate:        	  3.8792% 	    85444 	  0.5219% 	      625193
Ins Rate:        	  3.4013% 	    74917 	  0.1960% 	      234864
N Rate:          	 11.8828% 	   261729 	  2.9450% 	     3528221

Total time:     	173.666 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:20:06	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG.bam -RGID 1 -RGLB 242c_CA -RGPL illumina -RGPU combined_runs -RGSM 242c_CA
**********


18:20:06.842 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:20:06 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG.bam RGID=1 RGLB=242c_CA RGPL=illumina RGPU=combined_runs RGSM=242c_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:20:06 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:20:07	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=242c_CA SM=242c_CA

INFO	2020-09-15 18:20:16	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|378:5
INFO	2020-09-15 18:20:25	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|20778:62
INFO	2020-09-15 18:20:34	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    9s.  Last read position: lcl|28534:16
INFO	2020-09-15 18:20:43	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|27823:11
INFO	2020-09-15 18:20:53	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:46s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 18:21:02	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:55s.  Time for last 1,000,000:    8s.  Last read position: */*
[Tue Sep 15 18:21:02 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.93 minutes.
Runtime.totalMemory()=2311061504
INFO	2020-09-15 18:21:09	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:21:10.041 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:21:10 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:21:10 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:21:10	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:21:10	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:21:10	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:21:12	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1210:4470:85564 1:N:0:CTGTGTTG+ACCGACAA. Cause: String 'CTGTGTTG+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:21:19	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|378:5
INFO	2020-09-15 18:21:19	MarkDuplicates	Tracking 16 as yet unmatched pairs. 7 records in RAM.
INFO	2020-09-15 18:21:24	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|20778:62
INFO	2020-09-15 18:21:24	MarkDuplicates	Tracking 434 as yet unmatched pairs. 364 records in RAM.
INFO	2020-09-15 18:21:29	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    5s.  Last read position: lcl|28534:16
INFO	2020-09-15 18:21:29	MarkDuplicates	Tracking 40 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 18:21:35	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:23s.  Time for last 1,000,000:    5s.  Last read position: lcl|27823:11
INFO	2020-09-15 18:21:35	MarkDuplicates	Tracking 468 as yet unmatched pairs. 427 records in RAM.
INFO	2020-09-15 18:21:42	MarkDuplicates	Read 4730486 records. 0 pairs never matched.
INFO	2020-09-15 18:21:47	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8888535256; totalMemory: 10196877312; maxMemory: 28631367680
INFO	2020-09-15 18:21:47	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:21:51	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	Large duplicate set. size = 3448
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	Large duplicate set. size = 3351
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:22:09	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:22:09	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:22:10	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:22:10	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15830814032; totalMemory: 23193976832; maxMemory: 28631367680
INFO	2020-09-15 18:22:10	MarkDuplicates	Marking 1456947 records as duplicates.
INFO	2020-09-15 18:22:10	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:22:11	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:23:14	MarkDuplicates	Before output close freeMemory: 22770923368; totalMemory: 22982688768; maxMemory: 28631367680
INFO	2020-09-15 18:23:14	MarkDuplicates	After output close freeMemory: 22969704616; totalMemory: 23181393920; maxMemory: 28631367680
[Tue Sep 15 18:23:14 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.07 minutes.
Runtime.totalMemory()=23181393920
INFO	2020-09-15 18:23:15	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG_DM.bam
**********


18:23:15.806 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:23:15 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:23:15 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:23:32	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242c_CA_sorted_RG_DM.bai
[Tue Sep 15 18:23:32 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.27 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226199m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242d_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242d_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242d_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242d_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.525 seconds.
Analyzed Index:   	2.950 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	0.745 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4196076	(340613974 bases)

Mapping:          	129.056 seconds.
Reads/sec:       	32513.66
kBases/sec:      	2639.28


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 31.7058% 	   665199 	 31.2473% 	   106432684
bad pairs:       	  0.0092% 	      192 	  0.0076% 	       26046
insert size avg: 	  413.59


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 62.2197% 	  1305392 	 60.9018% 	   103549564
unambiguous:     	 40.1671% 	   842721 	 41.2629% 	    70158127
ambiguous:       	 22.0526% 	   462671 	 19.6389% 	    33391437
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 20.0690% 	   421055 	 15.6789% 	    26658476
semiperfect site:	 28.5436% 	   598856 	 24.7980% 	    42163304
rescued:         	  3.4478% 	    72336

Match Rate:      	      NA 	       NA 	 94.6307% 	    98485482
Error Rate:      	 50.4962% 	   825135 	  3.2606% 	     3393399
Sub Rate:        	 49.7674% 	   813226 	  2.6031% 	     2709093
Del Rate:        	  4.4363% 	    72492 	  0.5034% 	      523923
Ins Rate:        	  3.1701% 	    51801 	  0.1541% 	      160383
N Rate:          	 10.5963% 	   173149 	  2.1087% 	     2194606


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.5888% 	  1103333 	 52.2340% 	    89104252
unambiguous:     	 35.9922% 	   755130 	 37.1299% 	    63338678
ambiguous:       	 16.5966% 	   348203 	 15.1041% 	    25765574
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.5944% 	   306197 	 11.7667% 	    20072470
semiperfect site:	 22.1465% 	   464643 	 19.6877% 	    33584688
rescued:         	  4.3681% 	    91645

Match Rate:      	      NA 	       NA 	 93.9117% 	    84175773
Error Rate:      	 45.4814% 	   740489 	  3.6587% 	     3279370
Sub Rate:        	 44.7733% 	   728960 	  2.8924% 	     2592537
Del Rate:        	  4.3609% 	    71001 	  0.5898% 	      528666
Ins Rate:        	  3.1014% 	    50495 	  0.1765% 	      158167
N Rate:          	 10.4579% 	   170266 	  2.4297% 	     2177775

Total time:     	133.701 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:26:12	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG.bam -RGID 1 -RGLB 242d_CA -RGPL illumina -RGPU combined_runs -RGSM 242d_CA
**********


18:26:12.613 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:26:12 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG.bam RGID=1 RGLB=242d_CA RGPL=illumina RGPU=combined_runs RGSM=242d_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:26:12 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:26:12	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=242d_CA SM=242d_CA

INFO	2020-09-15 18:26:23	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|14316:1
INFO	2020-09-15 18:26:33	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: lcl|30717:75
INFO	2020-09-15 18:26:43	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:30s.  Time for last 1,000,000:   10s.  Last read position: lcl|26289:56
INFO	2020-09-15 18:26:53	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 18:26:55 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.71 minutes.
Runtime.totalMemory()=2373976064
INFO	2020-09-15 18:27:00	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:27:00.549 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:27:00 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:27:00 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:27:00	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:27:00	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:27:00	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:27:03	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1310:20544:75538 1:N:0:TGAGGTGT+ACCGACAA. Cause: String 'TGAGGTGT+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:27:09	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|14316:1
INFO	2020-09-15 18:27:09	MarkDuplicates	Tracking 10 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 18:27:15	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|30717:75
INFO	2020-09-15 18:27:15	MarkDuplicates	Tracking 75 as yet unmatched pairs. 65 records in RAM.
INFO	2020-09-15 18:27:22	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    7s.  Last read position: lcl|26289:56
INFO	2020-09-15 18:27:22	MarkDuplicates	Tracking 66 as yet unmatched pairs. 43 records in RAM.
INFO	2020-09-15 18:27:24	MarkDuplicates	Read 3486668 records. 0 pairs never matched.
INFO	2020-09-15 18:27:30	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4716166328; totalMemory: 5863112704; maxMemory: 28631367680
INFO	2020-09-15 18:27:30	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:27:34	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:27:34	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:27:35	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:27:35	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5805413472; totalMemory: 13060538368; maxMemory: 28631367680
INFO	2020-09-15 18:27:36	MarkDuplicates	Marking 899735 records as duplicates.
INFO	2020-09-15 18:27:36	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:27:36	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:28:21	MarkDuplicates	Before output close freeMemory: 17164563032; totalMemory: 17351835648; maxMemory: 28631367680
INFO	2020-09-15 18:28:21	MarkDuplicates	After output close freeMemory: 17001509464; totalMemory: 17188782080; maxMemory: 28631367680
[Tue Sep 15 18:28:21 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.35 minutes.
Runtime.totalMemory()=17188782080
INFO	2020-09-15 18:28:22	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG_DM.bam
**********


18:28:22.884 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:28:22 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:28:22 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:28:34	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242d_CA_sorted_RG_DM.bai
[Tue Sep 15 18:28:34 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.20 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226287m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242e_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242e_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242e_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/242e_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.566 seconds.
Analyzed Index:   	2.762 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	1.264 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	6693326	(552296582 bases)

Mapping:          	189.491 seconds.
Reads/sec:       	35322.71
kBases/sec:      	2914.64


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 32.8690% 	  1100013 	 32.5358% 	   179694362
bad pairs:       	  0.0080% 	      268 	  0.0071% 	       39458
insert size avg: 	  331.67


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 61.0502% 	  2043145 	 59.6118% 	   163890315
unambiguous:     	 39.6000% 	  1325277 	 40.4508% 	   111211265
ambiguous:       	 21.4503% 	   717868 	 19.1609% 	    52679050
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 19.1761% 	   641761 	 14.8155% 	    40732135
semiperfect site:	 28.3871% 	   950019 	 24.6168% 	    67678735
rescued:         	  3.5779% 	   119740

Match Rate:      	      NA 	       NA 	 94.0768% 	   155093186
Error Rate:      	 51.2565% 	  1294273 	  3.4041% 	     5611915
Sub Rate:        	 50.4327% 	  1273471 	  2.6454% 	     4361206
Del Rate:        	  5.0134% 	   126593 	  0.5870% 	      967776
Ins Rate:        	  3.4074% 	    86039 	  0.1716% 	      282933
N Rate:          	 12.4028% 	   313181 	  2.5191% 	     4152990


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.2748% 	  1749462 	 51.5547% 	   142995927
unambiguous:     	 35.8548% 	  1199939 	 36.6111% 	   101547276
ambiguous:       	 16.4200% 	   549523 	 14.9436% 	    41448651
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.0938% 	   471672 	 11.2498% 	    31203263
semiperfect site:	 22.5502% 	   754679 	 19.9917% 	    55450445
rescued:         	  4.4961% 	   150468

Match Rate:      	      NA 	       NA 	 93.3719% 	   134400436
Error Rate:      	 46.6029% 	  1171969 	  3.7572% 	     5408177
Sub Rate:        	 45.8177% 	  1152224 	  2.9030% 	     4178599
Del Rate:        	  4.8772% 	   122652 	  0.6565% 	      944985
Ins Rate:        	  3.3805% 	    85012 	  0.1977% 	      284593
N Rate:          	 12.3464% 	   310487 	  2.8708% 	     4132299

Total time:     	194.485 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:32:27	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG.bam -RGID 1 -RGLB 242e_CA -RGPL illumina -RGPU combined_runs -RGSM 242e_CA
**********


18:32:27.738 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:32:27 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG.bam RGID=1 RGLB=242e_CA RGPL=illumina RGPU=combined_runs RGSM=242e_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:32:27 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:32:27	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=242e_CA SM=242e_CA

INFO	2020-09-15 18:32:37	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|9418:488
INFO	2020-09-15 18:32:46	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|542:914
INFO	2020-09-15 18:32:55	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|822:95
INFO	2020-09-15 18:33:04	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|39781:28
INFO	2020-09-15 18:33:13	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:45s.  Time for last 1,000,000:    9s.  Last read position: lcl|37258:1
INFO	2020-09-15 18:33:25	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:   11s.  Last read position: */*
[Tue Sep 15 18:33:30 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.04 minutes.
Runtime.totalMemory()=3262644224
INFO	2020-09-15 18:33:37	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:33:37.824 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:33:37 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:33:37 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:33:37	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:33:37	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:33:37	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:33:40	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1205:6410:62760 1:N:0:GATCCATG+ACCGACAA. Cause: String 'GATCCATG+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:33:47	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|9418:488
INFO	2020-09-15 18:33:47	MarkDuplicates	Tracking 273 as yet unmatched pairs. 254 records in RAM.
INFO	2020-09-15 18:33:51	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|542:914
INFO	2020-09-15 18:33:51	MarkDuplicates	Tracking 233 as yet unmatched pairs. 207 records in RAM.
INFO	2020-09-15 18:33:58	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    7s.  Last read position: lcl|822:95
INFO	2020-09-15 18:33:58	MarkDuplicates	Tracking 42 as yet unmatched pairs. 10 records in RAM.
INFO	2020-09-15 18:34:02	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    4s.  Last read position: lcl|39781:28
INFO	2020-09-15 18:34:02	MarkDuplicates	Tracking 307 as yet unmatched pairs. 15 records in RAM.
INFO	2020-09-15 18:34:09	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:    6s.  Last read position: lcl|37258:1
INFO	2020-09-15 18:34:09	MarkDuplicates	Tracking 119 as yet unmatched pairs. 4 records in RAM.
INFO	2020-09-15 18:34:11	MarkDuplicates	Read 5384652 records. 0 pairs never matched.
INFO	2020-09-15 18:34:17	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8811633104; totalMemory: 10172235776; maxMemory: 28631367680
INFO	2020-09-15 18:34:17	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:34:20	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	Large duplicate set. size = 3398
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	Large duplicate set. size = 3017
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:34:39	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:34:39	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:34:39	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:34:40	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15930039816; totalMemory: 23223861248; maxMemory: 28631367680
INFO	2020-09-15 18:34:40	MarkDuplicates	Marking 1620641 records as duplicates.
INFO	2020-09-15 18:34:40	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:34:40	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:35:45	MarkDuplicates	Before output close freeMemory: 23049073304; totalMemory: 23217045504; maxMemory: 28631367680
INFO	2020-09-15 18:35:45	MarkDuplicates	After output close freeMemory: 22823105176; totalMemory: 22991077376; maxMemory: 28631367680
[Tue Sep 15 18:35:45 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.13 minutes.
Runtime.totalMemory()=22991077376
INFO	2020-09-15 18:35:47	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG_DM.bam
**********


18:35:47.302 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:35:47 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:35:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:36:05	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/242e_CA_sorted_RG_DM.bai
[Tue Sep 15 18:36:05 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.30 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226446m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13b_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13b_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13b_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13b_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.531 seconds.
Analyzed Index:   	2.965 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.523 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2748480	(238856569 bases)

Mapping:          	101.312 seconds.
Reads/sec:       	27128.92
kBases/sec:      	2357.64


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 15.2716% 	   209868 	 14.9596% 	    35731968
bad pairs:       	  0.0050% 	       69 	  0.0045% 	       10696
insert size avg: 	  704.27


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.4503% 	   707050 	 50.0890% 	    59813940
unambiguous:     	 34.7160% 	   477081 	 35.7784% 	    42724854
ambiguous:       	 16.7343% 	   229969 	 14.3106% 	    17089086
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.3773% 	   211321 	 11.8460% 	    14145966
semiperfect site:	 22.6320% 	   311018 	 19.4426% 	    23217378
rescued:         	  1.9435% 	    26708

Match Rate:      	      NA 	       NA 	 93.5053% 	    56356508
Error Rate:      	 46.3645% 	   447376 	  3.6616% 	     2206861
Sub Rate:        	 45.4254% 	   438314 	  2.6618% 	     1604314
Del Rate:        	  6.0846% 	    58711 	  0.7583% 	      457012
Ins Rate:        	  4.5245% 	    43657 	  0.2415% 	      145535
N Rate:          	 13.9812% 	   134906 	  2.8332% 	     1707583


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 42.3182% 	   581553 	 41.8609% 	    49999145
unambiguous:     	 29.9986% 	   412253 	 31.1726% 	    37232905
ambiguous:       	 12.3195% 	   169300 	 10.6883% 	    12766240
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.8561% 	   149189 	  8.6763% 	    10363059
semiperfect site:	 17.1082% 	   235108 	 15.1061% 	    18042975
rescued:         	  2.3495% 	    32288

Match Rate:      	      NA 	       NA 	 92.6714% 	    46739550
Error Rate:      	 40.4225% 	   385093 	  4.1246% 	     2080262
Sub Rate:        	 39.5487% 	   376768 	  2.9782% 	     1502079
Del Rate:        	  5.8315% 	    55555 	  0.8658% 	      436669
Ins Rate:        	  4.3352% 	    41300 	  0.2806% 	      141514
N Rate:          	 13.8591% 	   132031 	  3.2041% 	     1616002

Total time:     	105.753 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:38:07	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG.bam -RGID 1 -RGLB 13b_OR -RGPL illumina -RGPU combined_runs -RGSM 13b_OR
**********


18:38:08.148 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:38:08 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG.bam RGID=1 RGLB=13b_OR RGPL=illumina RGPU=combined_runs RGSM=13b_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:38:08 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:38:08	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=13b_OR SM=13b_OR

INFO	2020-09-15 18:38:18	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|15548:1
INFO	2020-09-15 18:38:27	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|44802:39
[Tue Sep 15 18:38:34 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.44 minutes.
Runtime.totalMemory()=3670540288
INFO	2020-09-15 18:38:38	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:38:38.436 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:38:38 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:38:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:38:38	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:38:38	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:38:38	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:38:40	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1112:15813:4816 1:N:0:GCCTATCA+ACCGACAA. Cause: String 'GCCTATCA+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:38:49	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|15548:1
INFO	2020-09-15 18:38:49	MarkDuplicates	Tracking 109 as yet unmatched pairs. 103 records in RAM.
INFO	2020-09-15 18:38:54	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:13s.  Time for last 1,000,000:    5s.  Last read position: lcl|44802:39
INFO	2020-09-15 18:38:54	MarkDuplicates	Tracking 38 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 18:38:55	MarkDuplicates	Read 2157332 records. 0 pairs never matched.
INFO	2020-09-15 18:38:57	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2669534536; totalMemory: 3659005952; maxMemory: 28631367680
INFO	2020-09-15 18:38:57	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:39:01	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:39:01	OpticalDuplicateFinder	Large duplicate set. size = 1065
INFO	2020-09-15 18:39:01	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:01	OpticalDuplicateFinder	Large duplicate set. size = 1374
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	Large duplicate set. size = 3203
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	Large duplicate set. size = 2998
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	Large duplicate set. size = 1454
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	Large duplicate set. size = 1147
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	Large duplicate set. size = 1705
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	Large duplicate set. size = 1230
INFO	2020-09-15 18:39:02	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:39:02	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:39:02	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:39:03	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3641186272; totalMemory: 10851713024; maxMemory: 28631367680
INFO	2020-09-15 18:39:03	MarkDuplicates	Marking 819201 records as duplicates.
INFO	2020-09-15 18:39:03	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:39:03	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:39:30	MarkDuplicates	Before output close freeMemory: 12787548120; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-15 18:39:30	MarkDuplicates	After output close freeMemory: 12886638552; totalMemory: 12988710912; maxMemory: 28631367680
[Tue Sep 15 18:39:30 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.87 minutes.
Runtime.totalMemory()=12988710912
INFO	2020-09-15 18:39:31	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG_DM.bam
**********


18:39:32.018 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:39:32 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:39:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:39:40	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13b_OR_sorted_RG_DM.bai
[Tue Sep 15 18:39:40 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.15 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226368m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13c_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13c_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13c_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/13c_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.503 seconds.
Analyzed Index:   	2.929 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	0.618 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	1916396	(158142177 bases)

Mapping:          	62.421 seconds.
Reads/sec:       	30701.21
kBases/sec:      	2533.48


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 28.7730% 	   275702 	 28.1444% 	    44508214
bad pairs:       	  0.0065% 	       62 	  0.0058% 	        9214
insert size avg: 	  391.81


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.5493% 	   532272 	 54.1580% 	    42645855
unambiguous:     	 36.2152% 	   347013 	 36.8768% 	    29038034
ambiguous:       	 19.3341% 	   185259 	 17.2812% 	    13607821
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.0194% 	   163080 	 13.1848% 	    10382178
semiperfect site:	 25.2634% 	   242073 	 22.0571% 	    17368518
rescued:         	  3.1473% 	    30157

Match Rate:      	      NA 	       NA 	 93.9905% 	    40349100
Error Rate:      	 51.6861% 	   341958 	  3.6212% 	     1554523
Sub Rate:        	 50.7316% 	   335643 	  2.6918% 	     1155578
Del Rate:        	  5.4898% 	    36321 	  0.6593% 	      283037
Ins Rate:        	  4.2677% 	    28235 	  0.2700% 	      115908
N Rate:          	 11.9354% 	    78965 	  2.3883% 	     1025269


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.4440% 	   454607 	 46.6339% 	    37026761
unambiguous:     	 32.6652% 	   312997 	 33.2346% 	    26387914
ambiguous:       	 14.7788% 	   141610 	 13.3993% 	    10638847
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.5304% 	   120066 	  9.9769% 	     7921520
semiperfect site:	 19.8662% 	   190358 	 17.6457% 	    14010497
rescued:         	  4.1859% 	    40109

Match Rate:      	      NA 	       NA 	 93.2250% 	    34769939
Error Rate:      	 46.7708% 	   308094 	  4.0177% 	     1498459
Sub Rate:        	 45.8332% 	   301918 	  2.9826% 	     1112413
Del Rate:        	  5.3935% 	    35529 	  0.7240% 	      270017
Ins Rate:        	  4.2445% 	    27960 	  0.3111% 	      116029
N Rate:          	 11.8713% 	    78200 	  2.7573% 	     1028380

Total time:     	66.888 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:40:59	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG.bam -RGID 1 -RGLB 13c_OR -RGPL illumina -RGPU combined_runs -RGSM 13c_OR
**********


18:40:59.620 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:40:59 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG.bam RGID=1 RGLB=13c_OR RGPL=illumina RGPU=combined_runs RGSM=13c_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:40:59 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:40:59	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=13c_OR SM=13c_OR

INFO	2020-09-15 18:41:09	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|35499:25
[Tue Sep 15 18:41:18 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.31 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 18:41:20	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:41:21.142 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:41:21 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:41:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:41:21	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:41:21	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:41:21	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:41:23	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1105:2784:13577 1:N:0:AACAACCG+ACCGACAA. Cause: String 'AACAACCG+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:41:29	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|35499:25
INFO	2020-09-15 18:41:29	MarkDuplicates	Tracking 197 as yet unmatched pairs. 185 records in RAM.
INFO	2020-09-15 18:41:33	MarkDuplicates	Read 1422230 records. 0 pairs never matched.
INFO	2020-09-15 18:41:35	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2695435456; totalMemory: 3668967424; maxMemory: 28631367680
INFO	2020-09-15 18:41:35	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:41:39	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:41:39	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:41:40	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:41:40	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3640132568; totalMemory: 10851713024; maxMemory: 28631367680
INFO	2020-09-15 18:41:40	MarkDuplicates	Marking 319442 records as duplicates.
INFO	2020-09-15 18:41:41	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:41:41	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:42:00	MarkDuplicates	Before output close freeMemory: 12890575544; totalMemory: 12992380928; maxMemory: 28631367680
INFO	2020-09-15 18:42:00	MarkDuplicates	After output close freeMemory: 12787815096; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 18:42:00 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.66 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 18:42:01	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG_DM.bam
**********


18:42:02.072 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:42:02 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:42:02 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:42:10	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/13c_OR_sorted_RG_DM.bai
[Tue Sep 15 18:42:10 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226259m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246f_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246f_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246f_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246f_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.037 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.500 seconds.
Analyzed Index:   	2.779 seconds.
Started output stream:	0.030 seconds.
Cleared Memory:    	1.010 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3314542	(270751175 bases)

Mapping:          	105.418 seconds.
Reads/sec:       	31441.94
kBases/sec:      	2568.36


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 27.8257% 	   461148 	 27.3185% 	    73965038
bad pairs:       	  0.0051% 	       85 	  0.0043% 	       11770
insert size avg: 	  429.27


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.7163% 	   923370 	 54.5625% 	    73700242
unambiguous:     	 34.0569% 	   564415 	 35.2173% 	    47569699
ambiguous:       	 21.6594% 	   358955 	 19.3452% 	    26130543
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.7540% 	   294232 	 13.5051% 	    18241978
semiperfect site:	 26.1929% 	   434087 	 22.6298% 	    30567120
rescued:         	  3.2771% 	    54311

Match Rate:      	      NA 	       NA 	 94.3891% 	    69993929
Error Rate:      	 50.6007% 	   585950 	  3.4156% 	     2532846
Sub Rate:        	 49.8686% 	   577472 	  2.5854% 	     1917194
Del Rate:        	  4.9286% 	    57073 	  0.6128% 	      454455
Ins Rate:        	  3.6217% 	    41939 	  0.2174% 	      161197
N Rate:          	 11.5513% 	   133763 	  2.1953% 	     1627922


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 46.6205% 	   772628 	 46.2856% 	    62798593
unambiguous:     	 30.3986% 	   503788 	 31.4780% 	    42708140
ambiguous:       	 16.2218% 	   268840 	 14.8076% 	    20090453
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.6614% 	   209834 	  9.9772% 	    13536756
semiperfect site:	 20.1751% 	   334356 	 17.8820% 	    24261674
rescued:         	  4.2998% 	    71259

Match Rate:      	      NA 	       NA 	 93.5918% 	    59188678
Error Rate:      	 45.2545% 	   520995 	  3.8442% 	     2431142
Sub Rate:        	 44.5655% 	   513062 	  2.8915% 	     1828610
Del Rate:        	  4.8291% 	    55595 	  0.7000% 	      442694
Ins Rate:        	  3.5641% 	    41032 	  0.2527% 	      159838
N Rate:          	 11.5375% 	   132826 	  2.5639% 	     1621467

Total time:     	110.121 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:44:19	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG.bam -RGID 1 -RGLB 246f_CA -RGPL illumina -RGPU combined_runs -RGSM 246f_CA
**********


18:44:19.818 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:44:19 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG.bam RGID=1 RGLB=246f_CA RGPL=illumina RGPU=combined_runs RGSM=246f_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:44:19 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:44:20	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=246f_CA SM=246f_CA

INFO	2020-09-15 18:44:29	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|22177:17
INFO	2020-09-15 18:44:38	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|28939:76
INFO	2020-09-15 18:44:49	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 18:44:50 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.52 minutes.
Runtime.totalMemory()=2449473536
INFO	2020-09-15 18:44:55	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:44:55.329 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:44:55 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:44:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:44:55	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:44:55	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:44:55	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:44:57	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2311:20926:10404 1:N:0:ACTCGTTG+ACCGACAA. Cause: String 'ACTCGTTG+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:45:03	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|22177:17
INFO	2020-09-15 18:45:03	MarkDuplicates	Tracking 16 as yet unmatched pairs. 7 records in RAM.
INFO	2020-09-15 18:45:08	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|28939:76
INFO	2020-09-15 18:45:08	MarkDuplicates	Tracking 56 as yet unmatched pairs. 12 records in RAM.
INFO	2020-09-15 18:45:13	MarkDuplicates	Read 2469530 records. 0 pairs never matched.
INFO	2020-09-15 18:45:16	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4770803672; totalMemory: 5851578368; maxMemory: 28631367680
INFO	2020-09-15 18:45:16	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:45:20	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:45:20	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:45:21	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:45:22	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5766834656; totalMemory: 13021216768; maxMemory: 28631367680
INFO	2020-09-15 18:45:22	MarkDuplicates	Marking 693501 records as duplicates.
INFO	2020-09-15 18:45:22	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:45:22	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:45:54	MarkDuplicates	Before output close freeMemory: 12929489128; totalMemory: 13032226816; maxMemory: 28631367680
INFO	2020-09-15 18:45:54	MarkDuplicates	After output close freeMemory: 17110651816; totalMemory: 17297309696; maxMemory: 28631367680
[Tue Sep 15 18:45:54 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.99 minutes.
Runtime.totalMemory()=17297309696
INFO	2020-09-15 18:45:55	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG_DM.bam
**********


18:45:56.185 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:45:56 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:45:56 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:46:05	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246f_CA_sorted_RG_DM.bai
[Tue Sep 15 18:46:05 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.15 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226209m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.515 seconds.
Analyzed Index:   	2.911 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.687 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	9310778	(738719342 bases)

Mapping:          	228.112 seconds.
Reads/sec:       	40816.71
kBases/sec:      	3238.41


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 32.5323% 	  1514507 	 32.4044% 	   239377336
bad pairs:       	  0.0114% 	      532 	  0.0103% 	       75966
insert size avg: 	  296.46


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 59.7284% 	  2780590 	 58.5254% 	   215637745
unambiguous:     	 39.8043% 	  1853045 	 40.7364% 	   150093806
ambiguous:       	 19.9241% 	   927545 	 17.7890% 	    65543939
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 20.2125% 	   940969 	 15.9693% 	    58839170
semiperfect site:	 30.0641% 	  1399603 	 26.6832% 	    98314724
rescued:         	  3.3461% 	   155772

Match Rate:      	      NA 	       NA 	 93.7906% 	   203548099
Error Rate:      	 49.1711% 	  1651756 	  3.1478% 	     6831565
Sub Rate:        	 47.2861% 	  1588433 	  2.3086% 	     5010293
Del Rate:        	  4.6107% 	   154884 	  0.6388% 	     1386292
Ins Rate:        	  5.0074% 	   168210 	  0.2004% 	      434980
N Rate:          	 14.1273% 	   474564 	  3.0616% 	     6644373


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.9389% 	  2371404 	 50.4986% 	   186980001
unambiguous:     	 35.8653% 	  1669667 	 36.7565% 	   136097356
ambiguous:       	 15.0736% 	   701737 	 13.7421% 	    50882645
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.7334% 	   685898 	 11.9768% 	    44346284
semiperfect site:	 23.7925% 	  1107634 	 21.5797% 	    79902869
rescued:         	  4.2714% 	   198852

Match Rate:      	      NA 	       NA 	 92.9805% 	   175148828
Error Rate:      	 44.8838% 	  1500695 	  3.5410% 	     6670288
Sub Rate:        	 43.1045% 	  1441204 	  2.5718% 	     4844517
Del Rate:        	  4.5652% 	   152639 	  0.7388% 	     1391615
Ins Rate:        	  4.9144% 	   164313 	  0.2305% 	      434156
N Rate:          	 14.0824% 	   470845 	  3.4785% 	     6552500

Total time:     	232.635 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 18:50:47	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG.bam -RGID 1 -RGLB 246b_CA -RGPL illumina -RGPU combined_runs -RGSM 246b_CA
**********


18:50:47.498 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:50:47 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG.bam RGID=1 RGLB=246b_CA RGPL=illumina RGPU=combined_runs RGSM=246b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:50:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:50:47	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=246b_CA SM=246b_CA

INFO	2020-09-15 18:50:56	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|3858:187
INFO	2020-09-15 18:51:04	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|14258:84
INFO	2020-09-15 18:51:13	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    9s.  Last read position: lcl|20572:44
INFO	2020-09-15 18:51:22	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    8s.  Last read position: lcl|14942:1
INFO	2020-09-15 18:51:30	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:42s.  Time for last 1,000,000:    8s.  Last read position: lcl|31365:8
INFO	2020-09-15 18:51:39	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:51s.  Time for last 1,000,000:    8s.  Last read position: lcl|23769:85
INFO	2020-09-15 18:51:48	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:00s.  Time for last 1,000,000:    8s.  Last read position: lcl|41667:145
INFO	2020-09-15 18:51:58	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:10s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 18:52:06	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:19s.  Time for last 1,000,000:    8s.  Last read position: */*
[Tue Sep 15 18:52:08 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.36 minutes.
Runtime.totalMemory()=3125280768
INFO	2020-09-15 18:52:18	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


18:52:18.631 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:52:18 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:52:18 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:52:18	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 18:52:18	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 18:52:18	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 18:52:21	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2316:15168:30982 1:N:0:CCTATGGT+ACCGACAA. Cause: String 'CCTATGGT+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 18:52:26	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|3858:187
INFO	2020-09-15 18:52:26	MarkDuplicates	Tracking 443 as yet unmatched pairs. 364 records in RAM.
INFO	2020-09-15 18:52:32	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    6s.  Last read position: lcl|14258:84
INFO	2020-09-15 18:52:32	MarkDuplicates	Tracking 264 as yet unmatched pairs. 218 records in RAM.
INFO	2020-09-15 18:52:37	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    4s.  Last read position: lcl|20572:44
INFO	2020-09-15 18:52:37	MarkDuplicates	Tracking 82 as yet unmatched pairs. 38 records in RAM.
INFO	2020-09-15 18:52:42	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    4s.  Last read position: lcl|14942:1
INFO	2020-09-15 18:52:42	MarkDuplicates	Tracking 32 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-15 18:52:49	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    7s.  Last read position: lcl|31365:8
INFO	2020-09-15 18:52:49	MarkDuplicates	Tracking 223 as yet unmatched pairs. 177 records in RAM.
INFO	2020-09-15 18:52:54	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:33s.  Time for last 1,000,000:    4s.  Last read position: lcl|23769:85
INFO	2020-09-15 18:52:54	MarkDuplicates	Tracking 1922 as yet unmatched pairs. 1854 records in RAM.
INFO	2020-09-15 18:52:59	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:    5s.  Last read position: lcl|41667:145
INFO	2020-09-15 18:52:59	MarkDuplicates	Tracking 18 as yet unmatched pairs. 10 records in RAM.
INFO	2020-09-15 18:53:00	MarkDuplicates	Read 7273910 records. 0 pairs never matched.
INFO	2020-09-15 18:53:08	MarkDuplicates	After buildSortedReadEndLists freeMemory: 6981327920; totalMemory: 8438415360; maxMemory: 28631367680
INFO	2020-09-15 18:53:08	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 18:53:12	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 18:53:13	OpticalDuplicateFinder	Large duplicate set. size = 1073
INFO	2020-09-15 18:53:13	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:53:13	OpticalDuplicateFinder	Large duplicate set. size = 1039
INFO	2020-09-15 18:53:13	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 18:53:13	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 18:53:13	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 18:53:14	MarkDuplicates	After generateDuplicateIndexes freeMemory: 8290405992; totalMemory: 15596519424; maxMemory: 28631367680
INFO	2020-09-15 18:53:14	MarkDuplicates	Marking 2396039 records as duplicates.
INFO	2020-09-15 18:53:14	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 18:53:14	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 18:54:38	MarkDuplicates	Before output close freeMemory: 17005478880; totalMemory: 17187733504; maxMemory: 28631367680
INFO	2020-09-15 18:54:38	MarkDuplicates	After output close freeMemory: 18822265408; totalMemory: 19041091584; maxMemory: 28631367680
[Tue Sep 15 18:54:38 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.32 minutes.
Runtime.totalMemory()=19041091584
INFO	2020-09-15 18:54:39	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG_DM.bam
**********


18:54:39.570 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 18:54:39 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 18:54:39 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 18:55:02	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246b_CA_sorted_RG_DM.bai
[Tue Sep 15 18:55:02 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.39 minutes.
Runtime.totalMemory()=10046930944
java -ea -Xmx226234m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246g_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246g_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246g_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/246g_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.579 seconds.
Analyzed Index:   	2.933 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.533 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	8649718	(745415619 bases)

Mapping:          	266.403 seconds.
Reads/sec:       	32468.51
kBases/sec:      	2798.07


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 23.0032% 	   994858 	 22.7340% 	   169462844
bad pairs:       	  0.0123% 	      532 	  0.0100% 	       74842
insert size avg: 	  485.32


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 58.2145% 	  2517695 	 56.1754% 	   208803259
unambiguous:     	 39.5901% 	  1712217 	 40.1526% 	   149246926
ambiguous:       	 18.6244% 	   805478 	 16.0227% 	    59556333
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 18.9097% 	   817819 	 14.5580% 	    54111922
semiperfect site:	 27.5158% 	  1190019 	 23.5591% 	    87569095
rescued:         	  2.8165% 	   121808

Match Rate:      	      NA 	       NA 	 93.6286% 	   196782340
Error Rate:      	 47.5662% 	  1551397 	  3.4970% 	     7349819
Sub Rate:        	 46.7452% 	  1524621 	  2.6465% 	     5562262
Del Rate:        	  5.0570% 	   164937 	  0.6518% 	     1370007
Ins Rate:        	  3.9814% 	   129856 	  0.1987% 	      417550
N Rate:          	 12.9848% 	   423508 	  2.8743% 	     6041107


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.3117% 	  2046164 	 46.2866% 	   172980792
unambiguous:     	 34.6665% 	  1499277 	 35.1483% 	   131354848
ambiguous:       	 12.6452% 	   546887 	 11.1384% 	    41625944
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.7212% 	   550172 	 10.1997% 	    38117816
semiperfect site:	 20.3198% 	   878801 	 17.8554% 	    66728402
rescued:         	  3.4581% 	   149557

Match Rate:      	      NA 	       NA 	 92.3604% 	   161067861
Error Rate:      	 41.3962% 	  1339475 	  4.0342% 	     7035349
Sub Rate:        	 40.6174% 	  1314276 	  2.9915% 	     5216967
Del Rate:        	  4.9929% 	   161558 	  0.8084% 	     1409725
Ins Rate:        	  3.9090% 	   126485 	  0.2343% 	      408657
N Rate:          	 13.8313% 	   447545 	  3.6053% 	     6287307

Total time:     	270.858 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:00:23	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG.bam -RGID 1 -RGLB 246g_CA -RGPL illumina -RGPU combined_runs -RGSM 246g_CA
**********


19:00:23.424 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:00:23 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG.bam RGID=1 RGLB=246g_CA RGPL=illumina RGPU=combined_runs RGSM=246g_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:00:23 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:00:23	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=246g_CA SM=246g_CA

INFO	2020-09-15 19:00:32	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|10133:52
INFO	2020-09-15 19:00:40	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|14150:6
INFO	2020-09-15 19:00:48	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|21907:365
INFO	2020-09-15 19:00:57	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:33s.  Time for last 1,000,000:    8s.  Last read position: lcl|10220:1
INFO	2020-09-15 19:01:05	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:42s.  Time for last 1,000,000:    8s.  Last read position: lcl|31483:15
INFO	2020-09-15 19:01:14	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:50s.  Time for last 1,000,000:    8s.  Last read position: lcl|24383:9
INFO	2020-09-15 19:01:23	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:59s.  Time for last 1,000,000:    8s.  Last read position: lcl|44072:127
INFO	2020-09-15 19:01:35	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:11s.  Time for last 1,000,000:   12s.  Last read position: */*
[Tue Sep 15 19:01:40 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.29 minutes.
Runtime.totalMemory()=2127036416
INFO	2020-09-15 19:01:49	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:01:49.965 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:01:49 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:01:49 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:01:50	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:01:50	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:01:50	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:01:52	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1116:17110:22260 1:N:0:TGTACACC+ACCGACAA. Cause: String 'TGTACACC+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 19:01:58	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|10133:52
INFO	2020-09-15 19:01:58	MarkDuplicates	Tracking 361 as yet unmatched pairs. 51 records in RAM.
INFO	2020-09-15 19:02:04	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|14150:6
INFO	2020-09-15 19:02:04	MarkDuplicates	Tracking 187 as yet unmatched pairs. 72 records in RAM.
INFO	2020-09-15 19:02:09	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|21907:365
INFO	2020-09-15 19:02:09	MarkDuplicates	Tracking 68 as yet unmatched pairs. 29 records in RAM.
INFO	2020-09-15 19:02:13	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:    4s.  Last read position: lcl|10220:1
INFO	2020-09-15 19:02:13	MarkDuplicates	Tracking 63 as yet unmatched pairs. 17 records in RAM.
INFO	2020-09-15 19:02:20	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    6s.  Last read position: lcl|31483:15
INFO	2020-09-15 19:02:20	MarkDuplicates	Tracking 5528 as yet unmatched pairs. 5487 records in RAM.
INFO	2020-09-15 19:02:24	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:31s.  Time for last 1,000,000:    3s.  Last read position: lcl|24383:9
INFO	2020-09-15 19:02:24	MarkDuplicates	Tracking 226 as yet unmatched pairs. 177 records in RAM.
INFO	2020-09-15 19:02:32	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:39s.  Time for last 1,000,000:    7s.  Last read position: lcl|44072:127
INFO	2020-09-15 19:02:32	MarkDuplicates	Tracking 10 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 19:02:32	MarkDuplicates	Read 7136938 records. 0 pairs never matched.
INFO	2020-09-15 19:02:39	MarkDuplicates	After buildSortedReadEndLists freeMemory: 7026044848; totalMemory: 8402763776; maxMemory: 28631367680
INFO	2020-09-15 19:02:39	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:02:43	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 1178
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 4296
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 3821
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 1165
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 1297
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 1087
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 2619
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	Large duplicate set. size = 2242
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:43	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	Large duplicate set. size = 1389
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	Large duplicate set. size = 1592
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	Large duplicate set. size = 1146
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	Large duplicate set. size = 1318
INFO	2020-09-15 19:02:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:02:44	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:02:44	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:02:45	MarkDuplicates	After generateDuplicateIndexes freeMemory: 8255228192; totalMemory: 15560867840; maxMemory: 28631367680
INFO	2020-09-15 19:02:45	MarkDuplicates	Marking 2847930 records as duplicates.
INFO	2020-09-15 19:02:45	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:02:45	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:04:07	MarkDuplicates	Before output close freeMemory: 16983760240; totalMemory: 17166237696; maxMemory: 28631367680
INFO	2020-09-15 19:04:07	MarkDuplicates	After output close freeMemory: 18860068480; totalMemory: 19080413184; maxMemory: 28631367680
[Tue Sep 15 19:04:07 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.30 minutes.
Runtime.totalMemory()=19080413184
INFO	2020-09-15 19:04:08	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG_DM.bam
**********


19:04:09.183 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:04:09 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:04:09 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:04:32	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/246g_CA_sorted_RG_DM.bai
[Tue Sep 15 19:04:32 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.38 minutes.
Runtime.totalMemory()=5359271936
java -ea -Xmx226368m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.046 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.546 seconds.
Analyzed Index:   	2.734 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	1.221 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	6476664	(553090016 bases)

Mapping:          	196.406 seconds.
Reads/sec:       	32975.97
kBases/sec:      	2816.06


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 20.4551% 	   662404 	 20.3321% 	   112454804
bad pairs:       	  0.0136% 	      442 	  0.0116% 	       64018
insert size avg: 	  435.87


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 53.0190% 	  1716930 	 51.3491% 	   141756653
unambiguous:     	 36.5215% 	  1182686 	 37.0385% 	   102250022
ambiguous:       	 16.4975% 	   534244 	 14.3107% 	    39506631
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.1872% 	   491812 	 11.4888% 	    31716449
semiperfect site:	 22.1725% 	   718020 	 18.7138% 	    51662126
rescued:         	  2.5257% 	    81792

Match Rate:      	      NA 	       NA 	 92.9587% 	   132738559
Error Rate:      	 51.1896% 	  1131439 	  3.7658% 	     5377250
Sub Rate:        	 50.3659% 	  1113232 	  2.8231% 	     4031257
Del Rate:        	  5.9340% 	   131158 	  0.7258% 	     1036407
Ins Rate:        	  4.3021% 	    95090 	  0.2168% 	      309586
N Rate:          	 13.4414% 	   297094 	  3.2755% 	     4677251


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.4458% 	  1439301 	 43.6047% 	   120796033
unambiguous:     	 32.3825% 	  1048652 	 32.9154% 	    91183978
ambiguous:       	 12.0633% 	   390649 	 10.6893% 	    29612055
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.6329% 	   344328 	  8.2832% 	    22946559
semiperfect site:	 16.8172% 	   544598 	 14.4791% 	    40110799
rescued:         	  3.0917% 	   100121

Match Rate:      	      NA 	       NA 	 91.9517% 	   112020429
Error Rate:      	 45.6336% 	  1000710 	  4.2558% 	     5184634
Sub Rate:        	 44.8705% 	   983976 	  3.1639% 	     3854404
Del Rate:        	  5.8260% 	   127759 	  0.8449% 	     1029266
Ins Rate:        	  4.2271% 	    92696 	  0.2470% 	      300964
N Rate:          	 13.5546% 	   297241 	  3.7925% 	     4620236

Total time:     	201.316 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:08:30	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG.bam -RGID 1 -RGLB 312a_CA -RGPL illumina -RGPU combined_runs -RGSM 312a_CA
**********


19:08:31.102 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:08:31 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG.bam RGID=1 RGLB=312a_CA RGPL=illumina RGPU=combined_runs RGSM=312a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:08:31 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:08:31	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=312a_CA SM=312a_CA

INFO	2020-09-15 19:08:40	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|9562:146
INFO	2020-09-15 19:08:49	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|21761:119
INFO	2020-09-15 19:08:58	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|28601:39
INFO	2020-09-15 19:09:07	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    8s.  Last read position: lcl|16533:25
INFO	2020-09-15 19:09:17	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:45s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 19:09:28	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:   11s.  Last read position: */*
[Tue Sep 15 19:09:31 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.00 minutes.
Runtime.totalMemory()=3336568832
INFO	2020-09-15 19:09:38	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:09:38.441 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:09:38 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:09:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:09:38	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:09:38	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:09:38	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:09:40	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2116:6380:71284 1:N:0:GTATGCTG+ACCGACAA. Cause: String 'GTATGCTG+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 19:09:46	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|9562:146
INFO	2020-09-15 19:09:46	MarkDuplicates	Tracking 76 as yet unmatched pairs. 70 records in RAM.
INFO	2020-09-15 19:09:51	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|21761:119
INFO	2020-09-15 19:09:51	MarkDuplicates	Tracking 31 as yet unmatched pairs. 12 records in RAM.
INFO	2020-09-15 19:09:56	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:15s.  Time for last 1,000,000:    4s.  Last read position: lcl|28601:39
INFO	2020-09-15 19:09:56	MarkDuplicates	Tracking 141 as yet unmatched pairs. 112 records in RAM.
INFO	2020-09-15 19:10:03	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    7s.  Last read position: lcl|16533:25
INFO	2020-09-15 19:10:03	MarkDuplicates	Tracking 149 as yet unmatched pairs. 125 records in RAM.
INFO	2020-09-15 19:10:10	MarkDuplicates	Read 4986770 records. 0 pairs never matched.
INFO	2020-09-15 19:10:14	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8894510136; totalMemory: 10180100096; maxMemory: 28631367680
INFO	2020-09-15 19:10:14	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:10:17	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:10:33	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:10:33	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:10:34	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15173465760; totalMemory: 22537043968; maxMemory: 28631367680
INFO	2020-09-15 19:10:34	MarkDuplicates	Marking 1657574 records as duplicates.
INFO	2020-09-15 19:10:34	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:10:34	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:11:36	MarkDuplicates	Before output close freeMemory: 22324500960; totalMemory: 22538616832; maxMemory: 28631367680
INFO	2020-09-15 19:11:36	MarkDuplicates	After output close freeMemory: 22138378720; totalMemory: 22352494592; maxMemory: 28631367680
[Tue Sep 15 19:11:36 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.97 minutes.
Runtime.totalMemory()=22352494592
INFO	2020-09-15 19:11:38	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG_DM.bam
**********


19:11:38.292 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:11:38 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:11:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:11:55	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312a_CA_sorted_RG_DM.bai
[Tue Sep 15 19:11:55 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.28 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226391m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.047 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.548 seconds.
Analyzed Index:   	2.852 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	0.676 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	1874082	(154644036 bases)

Mapping:          	64.782 seconds.
Reads/sec:       	28928.94
kBases/sec:      	2387.14


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.1131% 	   207209 	 22.3344% 	    34538858
bad pairs:       	  0.0142% 	      133 	  0.0129% 	       19986
insert size avg: 	  517.21


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.1271% 	   525934 	 55.1701% 	    42692928
unambiguous:     	 38.7565% 	   363164 	 39.7430% 	    30754839
ambiguous:       	 17.3706% 	   162770 	 15.4270% 	    11938089
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 16.5886% 	   155442 	 13.1351% 	    10164503
semiperfect site:	 24.0278% 	   225150 	 21.0674% 	    16302845
rescued:         	  2.8946% 	    27124

Match Rate:      	      NA 	       NA 	 93.7260% 	    40254754
Error Rate:      	 50.1420% 	   341693 	  3.5403% 	     1520535
Sub Rate:        	 49.2165% 	   335386 	  2.7668% 	     1188317
Del Rate:        	  5.5104% 	    37551 	  0.5972% 	      256492
Ins Rate:        	  3.9508% 	    26923 	  0.1763% 	       75726
N Rate:          	 12.6868% 	    86454 	  2.7338% 	     1174131


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.1563% 	   441874 	 47.0899% 	    36381570
unambiguous:     	 34.5674% 	   323911 	 35.6240% 	    27523048
ambiguous:       	 12.5889% 	   117963 	 11.4659% 	     8858522
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.7309% 	   109923 	  9.6348% 	     7443853
semiperfect site:	 18.3536% 	   171981 	 16.4993% 	    12747355
rescued:         	  3.4913% 	    32715

Match Rate:      	      NA 	       NA 	 92.7455% 	    33980754
Error Rate:      	 44.6377% 	   302210 	  3.9723% 	     1455385
Sub Rate:        	 43.7738% 	   296361 	  3.0681% 	     1124100
Del Rate:        	  5.4194% 	    36691 	  0.7018% 	      257131
Ins Rate:        	  3.8329% 	    25950 	  0.2024% 	       74154
N Rate:          	 13.1343% 	    88923 	  3.2822% 	     1202562

Total time:     	69.274 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:13:15	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG.bam -RGID 1 -RGLB 312b_CA -RGPL illumina -RGPU combined_runs -RGSM 312b_CA
**********


19:13:16.236 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:13:16 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG.bam RGID=1 RGLB=312b_CA RGPL=illumina RGPU=combined_runs RGSM=312b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:13:16 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:13:16	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=312b_CA SM=312b_CA

INFO	2020-09-15 19:13:25	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|32407:6
[Tue Sep 15 19:13:34 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.30 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 19:13:36	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:13:36.958 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:13:36 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:13:36 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:13:37	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:13:37	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:13:37	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:13:39	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1214:15728:86628 1:N:0:TGATGTCC+ACCGACAA. Cause: String 'TGATGTCC+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 19:13:44	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|32407:6
INFO	2020-09-15 19:13:44	MarkDuplicates	Tracking 318 as yet unmatched pairs. 313 records in RAM.
INFO	2020-09-15 19:13:48	MarkDuplicates	Read 1520932 records. 0 pairs never matched.
INFO	2020-09-15 19:13:50	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2697755360; totalMemory: 3664248832; maxMemory: 28631367680
INFO	2020-09-15 19:13:50	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:13:54	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:13:54	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:13:54	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:13:55	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3634026568; totalMemory: 10844897280; maxMemory: 28631367680
INFO	2020-09-15 19:13:55	MarkDuplicates	Marking 441381 records as duplicates.
INFO	2020-09-15 19:13:55	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:13:55	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:14:14	MarkDuplicates	Before output close freeMemory: 12885516232; totalMemory: 12986613760; maxMemory: 28631367680
INFO	2020-09-15 19:14:14	MarkDuplicates	After output close freeMemory: 12788522952; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 19:14:14 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.62 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 19:14:15	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG_DM.bam
**********


19:14:15.351 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:14:15 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:14:15 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:14:21	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312b_CA_sorted_RG_DM.bai
[Tue Sep 15 19:14:21 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.11 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226440m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312c_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312c_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312c_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/312c_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.551 seconds.
Analyzed Index:   	2.935 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	1.285 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	6868528	(564147578 bases)

Mapping:          	194.281 seconds.
Reads/sec:       	35353.59
kBases/sec:      	2903.77


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 30.9781% 	  1063869 	 30.8635% 	   174115796
bad pairs:       	  0.0133% 	      457 	  0.0115% 	       65122
insert size avg: 	  374.62


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 59.9639% 	  2059320 	 58.6456% 	   164912731
unambiguous:     	 39.7143% 	  1363895 	 40.6386% 	   114276729
ambiguous:       	 20.2496% 	   695425 	 18.0070% 	    50636002
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.9648% 	   616957 	 13.7281% 	    38603743
semiperfect site:	 26.3696% 	   905601 	 22.6713% 	    63752130
rescued:         	  3.4684% 	   119113

Match Rate:      	      NA 	       NA 	 93.7580% 	   155451434
Error Rate:      	 52.5907% 	  1337543 	  3.4651% 	     5745138
Sub Rate:        	 51.8796% 	  1319459 	  2.7618% 	     4579062
Del Rate:        	  4.8974% 	   124556 	  0.5356% 	      888050
Ins Rate:        	  3.7102% 	    94363 	  0.1677% 	      278026
N Rate:          	 12.3666% 	   314520 	  2.7770% 	     4604209


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.4693% 	  1767592 	 50.9097% 	   144046620
unambiguous:     	 36.0847% 	  1239245 	 36.9516% 	   104552903
ambiguous:       	 15.3846% 	   528347 	 13.9581% 	    39493717
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.2205% 	   454028 	 10.4181% 	    29477434
semiperfect site:	 20.8815% 	   717125 	 18.3533% 	    51929897
rescued:         	  4.3395% 	   149029

Match Rate:      	      NA 	       NA 	 92.9867% 	   134760016
Error Rate:      	 47.6939% 	  1209456 	  3.8393% 	     5564077
Sub Rate:        	 47.0232% 	  1192448 	  3.0425% 	     4409241
Del Rate:        	  4.8154% 	   122113 	  0.6054% 	      877300
Ins Rate:        	  3.7055% 	    93968 	  0.1915% 	      277536
N Rate:          	 12.4407% 	   315480 	  3.1740% 	     4599827

Total time:     	199.467 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:18:20	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG.bam -RGID 1 -RGLB 312c_CA -RGPL illumina -RGPU combined_runs -RGSM 312c_CA
**********


19:18:20.829 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:18:20 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG.bam RGID=1 RGLB=312c_CA RGPL=illumina RGPU=combined_runs RGSM=312c_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:18:20 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:18:21	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=312c_CA SM=312c_CA

INFO	2020-09-15 19:18:30	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|5709:115
INFO	2020-09-15 19:18:39	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|3037:74
INFO	2020-09-15 19:18:47	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|14891:35
INFO	2020-09-15 19:18:56	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:35s.  Time for last 1,000,000:    9s.  Last read position: lcl|39055:161
INFO	2020-09-15 19:19:05	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:44s.  Time for last 1,000,000:    8s.  Last read position: lcl|42964:9
INFO	2020-09-15 19:19:15	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:54s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 19:19:22 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.02 minutes.
Runtime.totalMemory()=2259156992
INFO	2020-09-15 19:19:29	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:19:29.896 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:19:29 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:19:29 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:19:29	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:19:29	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:19:29	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:19:32	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1112:24012:13949 1:N:0:GTCCTTCT+ACCGACAA. Cause: String 'GTCCTTCT+ACCGACAA' did not start with a parsable number.
INFO	2020-09-15 19:19:38	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|5709:115
INFO	2020-09-15 19:19:38	MarkDuplicates	Tracking 114 as yet unmatched pairs. 87 records in RAM.
INFO	2020-09-15 19:19:43	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|3037:74
INFO	2020-09-15 19:19:43	MarkDuplicates	Tracking 1686 as yet unmatched pairs. 1641 records in RAM.
INFO	2020-09-15 19:19:50	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    6s.  Last read position: lcl|14891:35
INFO	2020-09-15 19:19:50	MarkDuplicates	Tracking 218 as yet unmatched pairs. 183 records in RAM.
INFO	2020-09-15 19:19:54	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    3s.  Last read position: lcl|39055:161
INFO	2020-09-15 19:19:54	MarkDuplicates	Tracking 135 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 19:20:01	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    7s.  Last read position: lcl|42964:9
INFO	2020-09-15 19:20:01	MarkDuplicates	Tracking 1819 as yet unmatched pairs. 1808 records in RAM.
INFO	2020-09-15 19:20:03	MarkDuplicates	Read 5525172 records. 0 pairs never matched.
INFO	2020-09-15 19:20:09	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8812583120; totalMemory: 10173284352; maxMemory: 28631367680
INFO	2020-09-15 19:20:09	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:20:13	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:20:34	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:20:34	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:20:35	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15900047272; totalMemory: 23193976832; maxMemory: 28631367680
INFO	2020-09-15 19:20:35	MarkDuplicates	Marking 1599413 records as duplicates.
INFO	2020-09-15 19:20:35	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:20:35	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:21:41	MarkDuplicates	Before output close freeMemory: 23019302136; totalMemory: 23187685376; maxMemory: 28631367680
INFO	2020-09-15 19:21:41	MarkDuplicates	After output close freeMemory: 22797004024; totalMemory: 22965387264; maxMemory: 28631367680
[Tue Sep 15 19:21:41 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.19 minutes.
Runtime.totalMemory()=22965387264
INFO	2020-09-15 19:21:42	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG_DM.bam
**********


19:21:42.869 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:21:42 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:21:42 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:22:00	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/312c_CA_sorted_RG_DM.bai
[Tue Sep 15 19:22:00 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.30 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226199m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374f_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374f_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374f_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374f_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.503 seconds.
Analyzed Index:   	2.983 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	1.275 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4425852	(385334561 bases)

Mapping:          	154.809 seconds.
Reads/sec:       	28589.04
kBases/sec:      	2489.09


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 20.6981% 	   458033 	 20.2095% 	    77874302
bad pairs:       	  0.0092% 	      204 	  0.0079% 	       30488
insert size avg: 	  461.26


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 53.7044% 	  1188439 	 51.5088% 	    98886174
unambiguous:     	 36.8690% 	   815884 	 37.2618% 	    71534898
ambiguous:       	 16.8354% 	   372555 	 14.2470% 	    27351276
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.5669% 	   300226 	 10.1174% 	    19423379
semiperfect site:	 19.4477% 	   430363 	 16.1180% 	    30943194
rescued:         	  2.9435% 	    65138

Match Rate:      	      NA 	       NA 	 92.7783% 	    92447157
Error Rate:      	 54.2933% 	   834448 	  4.4256% 	     4409810
Sub Rate:        	 53.4250% 	   821102 	  3.4393% 	     3426981
Del Rate:        	  6.7917% 	   104384 	  0.7597% 	      756959
Ins Rate:        	  4.9686% 	    76363 	  0.2267% 	      225870
N Rate:          	 13.1092% 	   201478 	  2.7961% 	     2786166


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.6255% 	   987530 	 43.1364% 	    83406503
unambiguous:     	 32.6374% 	   722242 	 32.8985% 	    63611035
ambiguous:       	 11.9881% 	   265288 	 10.2379% 	    19795468
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.0594% 	   200477 	  6.9768% 	    13490038
semiperfect site:	 14.3945% 	   318540 	 12.2113% 	    23611254
rescued:         	  3.5782% 	    79184

Match Rate:      	      NA 	       NA 	 91.5144% 	    77042723
Error Rate:      	 47.8649% 	   727338 	  4.9664% 	     4180997
Sub Rate:        	 47.0258% 	   714587 	  3.7712% 	     3174801
Del Rate:        	  6.6539% 	   101111 	  0.9265% 	      779952
Ins Rate:        	  4.8708% 	    74015 	  0.2687% 	      226244
N Rate:          	 14.5669% 	   221354 	  3.5193% 	     2962735

Total time:     	159.988 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:25:07	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG.bam -RGID 1 -RGLB 374f_CA -RGPL illumina -RGPU combined_runs -RGSM 374f_CA
**********


19:25:07.653 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:25:07 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG.bam RGID=1 RGLB=374f_CA RGPL=illumina RGPU=combined_runs RGSM=374f_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:25:07 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:25:07	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=374f_CA SM=374f_CA

INFO	2020-09-15 19:25:18	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:   10s.  Last read position: lcl|3582:5
INFO	2020-09-15 19:25:27	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: lcl|17996:90
INFO	2020-09-15 19:25:37	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: lcl|43326:78
INFO	2020-09-15 19:25:48	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:   11s.  Last read position: */*
[Tue Sep 15 19:25:51 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.73 minutes.
Runtime.totalMemory()=3426222080
INFO	2020-09-15 19:25:57	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:25:57.619 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:25:57 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:25:57 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:25:57	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:25:57	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:25:57	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:26:00	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1216:12789:23800 1:N:0:ACGTTACC+AGTGGCAA. Cause: String 'ACGTTACC+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:26:07	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|3582:5
INFO	2020-09-15 19:26:07	MarkDuplicates	Tracking 34 as yet unmatched pairs. 27 records in RAM.
INFO	2020-09-15 19:26:11	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|17996:90
INFO	2020-09-15 19:26:11	MarkDuplicates	Tracking 13 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 19:26:20	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    8s.  Last read position: lcl|43326:78
INFO	2020-09-15 19:26:20	MarkDuplicates	Tracking 131 as yet unmatched pairs. 122 records in RAM.
INFO	2020-09-15 19:26:23	MarkDuplicates	Read 3435464 records. 0 pairs never matched.
INFO	2020-09-15 19:26:27	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4738265704; totalMemory: 5852626944; maxMemory: 28631367680
INFO	2020-09-15 19:26:27	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:26:31	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:26:32	OpticalDuplicateFinder	Large duplicate set. size = 2340
INFO	2020-09-15 19:26:32	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:26:32	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:26:32	OpticalDuplicateFinder	Large duplicate set. size = 2064
INFO	2020-09-15 19:26:32	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:26:32	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:26:32	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:26:32	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:26:33	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5800892416; totalMemory: 13055295488; maxMemory: 28631367680
INFO	2020-09-15 19:26:33	MarkDuplicates	Marking 1190045 records as duplicates.
INFO	2020-09-15 19:26:33	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:26:33	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:27:18	MarkDuplicates	Before output close freeMemory: 17174949704; totalMemory: 17361797120; maxMemory: 28631367680
INFO	2020-09-15 19:27:18	MarkDuplicates	After output close freeMemory: 17029197640; totalMemory: 17216045056; maxMemory: 28631367680
[Tue Sep 15 19:27:18 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.35 minutes.
Runtime.totalMemory()=17216045056
INFO	2020-09-15 19:27:19	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG_DM.bam
**********


19:27:19.965 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:27:19 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:27:19 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:27:32	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374f_CA_sorted_RG_DM.bai
[Tue Sep 15 19:27:32 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.21 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226370m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374g_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374g_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374g_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374g_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.572 seconds.
Analyzed Index:   	2.704 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.570 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	6148370	(535640778 bases)

Mapping:          	222.172 seconds.
Reads/sec:       	27673.95
kBases/sec:      	2410.93


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 18.8900% 	   580713 	 18.3928% 	    98519176
bad pairs:       	  0.0088% 	      271 	  0.0075% 	       40344
insert size avg: 	  603.85


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.2096% 	  1666504 	 52.4356% 	   140328238
unambiguous:     	 36.3352% 	  1117012 	 37.2725% 	    99748673
ambiguous:       	 17.8744% 	   549492 	 15.1631% 	    40579565
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.2134% 	   436947 	 10.7222% 	    28694691
semiperfect site:	 20.5665% 	   632252 	 17.2680% 	    46212695
rescued:         	  2.6495% 	    81452

Match Rate:      	      NA 	       NA 	 93.0019% 	   131535651
Error Rate:      	 51.7121% 	  1143869 	  4.2071% 	     5950259
Sub Rate:        	 50.8355% 	  1124478 	  3.1991% 	     4524580
Del Rate:        	  6.6416% 	   146912 	  0.7814% 	     1105121
Ins Rate:        	  4.7923% 	   106006 	  0.2266% 	      320558
N Rate:          	 13.6758% 	   302509 	  2.7910% 	     3947449


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.7936% 	  1377038 	 43.6845% 	   117083430
unambiguous:     	 31.7432% 	   975846 	 32.5594% 	    87266044
ambiguous:       	 13.0504% 	   401192 	 11.1250% 	    29817386
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.9332% 	   305365 	  7.7243% 	    20702834
semiperfect site:	 15.3637% 	   472308 	 13.1282% 	    35186179
rescued:         	  3.1807% 	    97781

Match Rate:      	      NA 	       NA 	 92.0114% 	   108694918
Error Rate:      	 45.2548% 	   987053 	  4.7051% 	     5558286
Sub Rate:        	 44.4490% 	   969478 	  3.5567% 	     4201612
Del Rate:        	  6.3171% 	   137782 	  0.8876% 	     1048543
Ins Rate:        	  4.5384% 	    98988 	  0.2608% 	      308131
N Rate:          	 13.9751% 	   304812 	  3.2834% 	     3878769

Total time:     	226.434 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:31:55	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG.bam -RGID 1 -RGLB 374g_CA -RGPL illumina -RGPU combined_runs -RGSM 374g_CA
**********


19:31:55.606 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:31:55 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG.bam RGID=1 RGLB=374g_CA RGPL=illumina RGPU=combined_runs RGSM=374g_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:31:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:31:55	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=374g_CA SM=374g_CA

INFO	2020-09-15 19:32:05	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|5296:54
INFO	2020-09-15 19:32:13	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|23383:61
INFO	2020-09-15 19:32:23	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|32947:83
INFO	2020-09-15 19:32:32	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|40860:233
INFO	2020-09-15 19:32:42	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:46s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 19:32:52	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 19:32:53 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.96 minutes.
Runtime.totalMemory()=3336568832
INFO	2020-09-15 19:33:00	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:33:00.327 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:33:00 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:33:00 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:33:00	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:33:00	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:33:00	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:33:02	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2113:14085:48270 1:N:0:CTGTGTTG+AGTGGCAA. Cause: String 'CTGTGTTG+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:33:08	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|5296:54
INFO	2020-09-15 19:33:08	MarkDuplicates	Tracking 17212 as yet unmatched pairs. 17202 records in RAM.
INFO	2020-09-15 19:33:13	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|23383:61
INFO	2020-09-15 19:33:13	MarkDuplicates	Tracking 40 as yet unmatched pairs. 24 records in RAM.
INFO	2020-09-15 19:33:18	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|32947:83
INFO	2020-09-15 19:33:18	MarkDuplicates	Tracking 42 as yet unmatched pairs. 21 records in RAM.
INFO	2020-09-15 19:33:24	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    5s.  Last read position: lcl|40860:233
INFO	2020-09-15 19:33:24	MarkDuplicates	Tracking 468 as yet unmatched pairs. 273 records in RAM.
INFO	2020-09-15 19:33:32	MarkDuplicates	Read 4925116 records. 0 pairs never matched.
INFO	2020-09-15 19:33:36	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8901425960; totalMemory: 10172235776; maxMemory: 28631367680
INFO	2020-09-15 19:33:36	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:33:40	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 2205
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 2525
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 8324
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         6,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         7,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         8,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 7385
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         6,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         7,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 1774
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 2119
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 2589
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 2173
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 1003
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 1562
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 1835
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:58	OpticalDuplicateFinder	Large duplicate set. size = 1041
INFO	2020-09-15 19:33:59	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:33:59	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:33:59	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:34:00	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15214735504; totalMemory: 22577938432; maxMemory: 28631367680
INFO	2020-09-15 19:34:00	MarkDuplicates	Marking 1993528 records as duplicates.
INFO	2020-09-15 19:34:00	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:34:00	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:35:01	MarkDuplicates	Before output close freeMemory: 22359615464; totalMemory: 22574268416; maxMemory: 28631367680
INFO	2020-09-15 19:35:01	MarkDuplicates	After output close freeMemory: 22181357544; totalMemory: 22396010496; maxMemory: 28631367680
[Tue Sep 15 19:35:01 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.03 minutes.
Runtime.totalMemory()=22396010496
INFO	2020-09-15 19:35:03	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG_DM.bam
**********


19:35:03.685 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:35:03 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:35:03 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:35:20	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374g_CA_sorted_RG_DM.bai
[Tue Sep 15 19:35:20 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.28 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226413m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374c_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374c_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374c_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374c_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.569 seconds.
Analyzed Index:   	3.100 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.534 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3924234	(335532900 bases)

Mapping:          	110.326 seconds.
Reads/sec:       	35569.47
kBases/sec:      	3041.29


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 12.1286% 	   237978 	 12.2773% 	    41194380
bad pairs:       	  0.0102% 	      200 	  0.0086% 	       28934
insert size avg: 	  521.83


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 36.0005% 	   706371 	 35.3193% 	    59253229
unambiguous:     	 24.6746% 	   484144 	 25.4841% 	    42753209
ambiguous:       	 11.3259% 	   222227 	  9.8352% 	    16500020
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.7246% 	   190809 	  7.4770% 	    12543725
semiperfect site:	 14.2896% 	   280379 	 12.1902% 	    20450887
rescued:         	  1.6602% 	    32575

Match Rate:      	      NA 	       NA 	 92.6396% 	    55428064
Error Rate:      	 51.5231% 	   477551 	  4.1773% 	     2499384
Sub Rate:        	 50.4975% 	   468045 	  2.9410% 	     1759640
Del Rate:        	  7.1217% 	    66009 	  0.9672% 	      578680
Ins Rate:        	  5.3031% 	    49153 	  0.2692% 	      161064
N Rate:          	 14.1349% 	   131012 	  3.1830% 	     1904461


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 30.0994% 	   590586 	 29.9183% 	    50193472
unambiguous:     	 21.9170% 	   430038 	 22.6820% 	    38053265
ambiguous:       	  8.1824% 	   160548 	  7.2363% 	    12140207
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.7042% 	   131544 	  5.3116% 	     8911171
semiperfect site:	 10.6873% 	   209697 	  9.2990% 	    15600828
rescued:         	  2.0292% 	    39816

Match Rate:      	      NA 	       NA 	 91.4224% 	    46420225
Error Rate:      	 45.6611% 	   420463 	  4.7717% 	     2422861
Sub Rate:        	 44.6996% 	   411609 	  3.3150% 	     1683203
Del Rate:        	  7.0851% 	    65242 	  1.1464% 	      582071
Ins Rate:        	  5.2023% 	    47905 	  0.3104% 	      157587
N Rate:          	 14.6368% 	   134781 	  3.8059% 	     1932457

Total time:     	114.940 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:37:39	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG.bam -RGID 1 -RGLB 374c_CA -RGPL illumina -RGPU combined_runs -RGSM 374c_CA
**********


19:37:39.734 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:37:39 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG.bam RGID=1 RGLB=374c_CA RGPL=illumina RGPU=combined_runs RGSM=374c_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:37:39 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:37:39	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=374c_CA SM=374c_CA

INFO	2020-09-15 19:37:49	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|21954:53
INFO	2020-09-15 19:37:59	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|46021:4
INFO	2020-09-15 19:38:10	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:30s.  Time for last 1,000,000:   11s.  Last read position: */*
[Tue Sep 15 19:38:17 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.62 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 19:38:21	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:38:21.882 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:38:21 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:38:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:38:21	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:38:21	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:38:21	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:38:24	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1213:14029:41335 1:N:0:TGAGGTGT+AGTGGCAA. Cause: String 'TGAGGTGT+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:38:31	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|21954:53
INFO	2020-09-15 19:38:31	MarkDuplicates	Tracking 59 as yet unmatched pairs. 47 records in RAM.
INFO	2020-09-15 19:38:36	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|46021:4
INFO	2020-09-15 19:38:36	MarkDuplicates	Tracking 101 as yet unmatched pairs. 100 records in RAM.
INFO	2020-09-15 19:38:36	MarkDuplicates	Read 2117558 records. 0 pairs never matched.
INFO	2020-09-15 19:38:40	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2667880008; totalMemory: 3660054528; maxMemory: 28631367680
INFO	2020-09-15 19:38:40	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:38:44	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	Large duplicate set. size = 1163
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	Large duplicate set. size = 1191
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	Large duplicate set. size = 2566
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	Large duplicate set. size = 2057
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	Large duplicate set. size = 1768
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	Large duplicate set. size = 1674
INFO	2020-09-15 19:38:44	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:38:44	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:38:45	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:38:45	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3643222816; totalMemory: 10853810176; maxMemory: 28631367680
INFO	2020-09-15 19:38:45	MarkDuplicates	Marking 742636 records as duplicates.
INFO	2020-09-15 19:38:45	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:38:46	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:39:24	MarkDuplicates	Before output close freeMemory: 12787839536; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-15 19:39:25	MarkDuplicates	After output close freeMemory: 12888502832; totalMemory: 12990283776; maxMemory: 28631367680
[Tue Sep 15 19:39:25 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.05 minutes.
Runtime.totalMemory()=12990283776
INFO	2020-09-15 19:39:26	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG_DM.bam
**********


19:39:26.385 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:39:26 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:39:26 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:39:36	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374c_CA_sorted_RG_DM.bai
[Tue Sep 15 19:39:36 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.17 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226435m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374d_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374d_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374d_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374d_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.046 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.519 seconds.
Analyzed Index:   	2.966 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.549 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	1346950	(117732720 bases)

Mapping:          	51.391 seconds.
Reads/sec:       	26209.78
kBases/sec:      	2290.92


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.5438% 	   145092 	 21.2675% 	    25038758
bad pairs:       	  0.0097% 	       65 	  0.0079% 	        9266
insert size avg: 	  494.83


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.3192% 	   365826 	 52.2665% 	    30694438
unambiguous:     	 37.5969% 	   253206 	 37.8886% 	    22250743
ambiguous:       	 16.7222% 	   112620 	 14.3779% 	     8443695
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 16.3889% 	   110375 	 12.4611% 	     7317987
semiperfect site:	 23.6903% 	   159548 	 20.0664% 	    11784322
rescued:         	  2.6865% 	    18093

Match Rate:      	      NA 	       NA 	 93.4068% 	    28873051
Error Rate:      	 50.3887% 	   236987 	  3.6460% 	     1127031
Sub Rate:        	 49.4417% 	   232533 	  2.7313% 	      844260
Del Rate:        	  6.0389% 	    28402 	  0.7009% 	      216652
Ins Rate:        	  4.5493% 	    21396 	  0.2139% 	       66119
N Rate:          	 12.6417% 	    59456 	  2.9472% 	      911008


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.2485% 	   304737 	 43.9826% 	    25952332
unambiguous:     	 33.4529% 	   225297 	 33.6310% 	    19844289
ambiguous:       	 11.7955% 	    79440 	 10.3516% 	     6108043
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.7062% 	    78838 	  9.2597% 	     5463794
semiperfect site:	 18.0283% 	   121416 	 15.6275% 	     9221155
rescued:         	  3.3226% 	    22377

Match Rate:      	      NA 	       NA 	 92.3997% 	    24181959
Error Rate:      	 44.4242% 	   207021 	  4.1102% 	     1075675
Sub Rate:        	 43.5816% 	   203094 	  3.0331% 	      793792
Del Rate:        	  5.9398% 	    27680 	  0.8357% 	      218707
Ins Rate:        	  4.3819% 	    20420 	  0.2414% 	       63176
N Rate:          	 13.0736% 	    60924 	  3.4901% 	      913405

Total time:     	55.838 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:40:41	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG.bam -RGID 1 -RGLB 374d_CA -RGPL illumina -RGPU combined_runs -RGSM 374d_CA
**********


19:40:41.629 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:40:41 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG.bam RGID=1 RGLB=374d_CA RGPL=illumina RGPU=combined_runs RGSM=374d_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:40:41 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:40:41	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=374d_CA SM=374d_CA

INFO	2020-09-15 19:40:51	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|46178:1
[Tue Sep 15 19:40:55 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.23 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 19:40:57	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:40:57.725 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:40:57 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:40:57 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:40:57	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:40:57	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:40:57	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:41:00	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1211:5919:97860 1:N:0:GATCCATG+AGTGGCAA. Cause: String 'GATCCATG+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:41:05	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|46178:1
INFO	2020-09-15 19:41:05	MarkDuplicates	Tracking 10 as yet unmatched pairs. 1 records in RAM.
INFO	2020-09-15 19:41:06	MarkDuplicates	Read 1050812 records. 0 pairs never matched.
INFO	2020-09-15 19:41:07	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2730535944; totalMemory: 3670540288; maxMemory: 28631367680
INFO	2020-09-15 19:41:07	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:41:11	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:41:11	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:41:11	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:41:14	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3618377088; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 19:41:14	MarkDuplicates	Marking 288347 records as duplicates.
INFO	2020-09-15 19:41:14	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:41:14	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:41:28	MarkDuplicates	Before output close freeMemory: 10769325360; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 19:41:28	MarkDuplicates	After output close freeMemory: 12855959504; totalMemory: 12956729344; maxMemory: 28631367680
[Tue Sep 15 19:41:28 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.52 minutes.
Runtime.totalMemory()=12956729344
INFO	2020-09-15 19:41:29	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG_DM.bam
**********


19:41:29.843 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:41:29 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:41:29 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:41:35	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374d_CA_sorted_RG_DM.bai
[Tue Sep 15 19:41:35 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.10 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226373m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374e_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374e_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374e_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/374e_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.509 seconds.
Analyzed Index:   	2.890 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.723 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3990132	(332428775 bases)

Mapping:          	128.828 seconds.
Reads/sec:       	30972.67
kBases/sec:      	2580.42


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.1936% 	   522580 	 25.8179% 	    85826006
bad pairs:       	  0.0108% 	      216 	  0.0091% 	       30374
insert size avg: 	  461.29


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 59.0982% 	  1179048 	 57.8038% 	    96071694
unambiguous:     	 38.8277% 	   774638 	 39.7203% 	    66016466
ambiguous:       	 20.2705% 	   404410 	 18.0834% 	    30055228
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.6836% 	   352800 	 13.7032% 	    22775139
semiperfect site:	 25.9371% 	   517462 	 22.5291% 	    37444002
rescued:         	  3.1104% 	    62055

Match Rate:      	      NA 	       NA 	 93.8431% 	    90724045
Error Rate:      	 51.0280% 	   767980 	  3.6103% 	     3490261
Sub Rate:        	 50.2411% 	   756137 	  2.7896% 	     2696913
Del Rate:        	  5.2063% 	    78356 	  0.6254% 	      604648
Ins Rate:        	  3.9963% 	    60145 	  0.1952% 	      188700
N Rate:          	 12.0003% 	   180606 	  2.5467% 	     2462036


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.8216% 	   993973 	 49.4085% 	    82129618
unambiguous:     	 34.5580% 	   689455 	 35.5457% 	    59086051
ambiguous:       	 15.2636% 	   304518 	 13.8628% 	    23043567
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.9471% 	   258303 	 10.3571% 	    17216081
semiperfect site:	 20.1561% 	   402127 	 17.8982% 	    29751465
rescued:         	  3.9440% 	    78685

Match Rate:      	      NA 	       NA 	 93.0436% 	    76977460
Error Rate:      	 45.4725% 	   680029 	  4.0573% 	     3356724
Sub Rate:        	 44.7223% 	   668809 	  3.0990% 	     2563876
Del Rate:        	  5.1113% 	    76438 	  0.7290% 	      603089
Ins Rate:        	  3.9559% 	    59159 	  0.2294% 	      189759
N Rate:          	 11.7659% 	   175955 	  2.8991% 	     2398523

Total time:     	134.357 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:44:13	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG.bam -RGID 1 -RGLB 374e_CA -RGPL illumina -RGPU combined_runs -RGSM 374e_CA
**********


19:44:13.852 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:44:13 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG.bam RGID=1 RGLB=374e_CA RGPL=illumina RGPU=combined_runs RGSM=374e_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:44:13 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:44:14	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=374e_CA SM=374e_CA

INFO	2020-09-15 19:44:23	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|1575:64
INFO	2020-09-15 19:44:32	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|31995:50
INFO	2020-09-15 19:44:42	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|42964:59
[Tue Sep 15 19:44:51 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.62 minutes.
Runtime.totalMemory()=3508011008
INFO	2020-09-15 19:44:55	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:44:56.246 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:44:56 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:44:56 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:44:56	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:44:56	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:44:56	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:44:58	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2207:7718:98189 1:N:0:GCCTATCA+AGTGGCAA. Cause: String 'GCCTATCA+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:45:05	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|1575:64
INFO	2020-09-15 19:45:05	MarkDuplicates	Tracking 905 as yet unmatched pairs. 892 records in RAM.
INFO	2020-09-15 19:45:10	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|31995:50
INFO	2020-09-15 19:45:10	MarkDuplicates	Tracking 25 as yet unmatched pairs. 15 records in RAM.
INFO	2020-09-15 19:45:15	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|42964:59
INFO	2020-09-15 19:45:15	MarkDuplicates	Tracking 24 as yet unmatched pairs. 20 records in RAM.
INFO	2020-09-15 19:45:18	MarkDuplicates	Read 3300450 records. 0 pairs never matched.
INFO	2020-09-15 19:45:21	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4738869904; totalMemory: 5858394112; maxMemory: 28631367680
INFO	2020-09-15 19:45:21	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:45:25	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:45:25	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:45:26	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:45:26	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5801202376; totalMemory: 13056344064; maxMemory: 28631367680
INFO	2020-09-15 19:45:26	MarkDuplicates	Marking 964470 records as duplicates.
INFO	2020-09-15 19:45:26	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:45:27	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:46:05	MarkDuplicates	Before output close freeMemory: 17169645032; totalMemory: 17356554240; maxMemory: 28631367680
INFO	2020-09-15 19:46:05	MarkDuplicates	After output close freeMemory: 17016552936; totalMemory: 17203462144; maxMemory: 28631367680
[Tue Sep 15 19:46:05 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.15 minutes.
Runtime.totalMemory()=17203462144
INFO	2020-09-15 19:46:06	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG_DM.bam
**********


19:46:06.553 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:46:06 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:46:06 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:46:18	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/374e_CA_sorted_RG_DM.bai
[Tue Sep 15 19:46:18 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.20 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226347m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.519 seconds.
Analyzed Index:   	2.942 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.534 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4064538	(336334024 bases)

Mapping:          	128.270 seconds.
Reads/sec:       	31687.38
kBases/sec:      	2622.08


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 23.9212% 	   486143 	 23.8155% 	    80099634
bad pairs:       	  0.0109% 	      222 	  0.0095% 	       31882
insert size avg: 	  509.26


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 57.7692% 	  1174025 	 56.5959% 	    95187193
unambiguous:     	 38.1946% 	   776217 	 39.2497% 	    66013096
ambiguous:       	 19.5746% 	   397808 	 17.3462% 	    29174097
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 18.1008% 	   367857 	 14.0667% 	    23658435
semiperfect site:	 26.3059% 	   534607 	 22.7540% 	    38269343
rescued:         	  2.7851% 	    56600

Match Rate:      	      NA 	       NA 	 93.9515% 	    89884127
Error Rate:      	 48.6539% 	   740055 	  3.2237% 	     3084166
Sub Rate:        	 47.9243% 	   728957 	  2.5656% 	     2454550
Del Rate:        	  4.4551% 	    67765 	  0.5054% 	      483546
Ins Rate:        	  3.1798% 	    48367 	  0.1527% 	      146070
N Rate:          	 12.2613% 	   186501 	  2.8247% 	     2702446


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.5483% 	   986632 	 48.4059% 	    81392868
unambiguous:     	 33.9582% 	   690122 	 35.1734% 	    59142981
ambiguous:       	 14.5901% 	   296510 	 13.2324% 	    22249887
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.3279% 	   270858 	 10.7541% 	    18082612
semiperfect site:	 20.4432% 	   415461 	 18.1394% 	    30500774
rescued:         	  3.4860% 	    70845

Match Rate:      	      NA 	       NA 	 93.2435% 	    76333829
Error Rate:      	 43.2260% 	   653954 	  3.6013% 	     2948214
Sub Rate:        	 42.5304% 	   643431 	  2.8490% 	     2332374
Del Rate:        	  4.2908% 	    64914 	  0.5768% 	      472202
Ins Rate:        	  3.1317% 	    47378 	  0.1755% 	      143638
N Rate:          	 11.7471% 	   177719 	  3.1552% 	     2583027

Total time:     	132.679 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:48:55	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG.bam -RGID 1 -RGLB 427a_CA -RGPL illumina -RGPU combined_runs -RGSM 427a_CA
**********


19:48:55.594 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:48:55 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG.bam RGID=1 RGLB=427a_CA RGPL=illumina RGPU=combined_runs RGSM=427a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:48:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:48:55	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=427a_CA SM=427a_CA

INFO	2020-09-15 19:49:05	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|10803:2
INFO	2020-09-15 19:49:14	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|33399:8
INFO	2020-09-15 19:49:24	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: lcl|42641:81
INFO	2020-09-15 19:49:34	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 19:49:34 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.65 minutes.
Runtime.totalMemory()=3670540288
INFO	2020-09-15 19:49:39	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:49:39.456 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:49:39 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:49:39 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:49:39	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:49:39	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:49:39	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:49:41	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1106:9115:50912 1:N:0:AACAACCG+AGTGGCAA. Cause: String 'AACAACCG+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:49:47	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|10803:2
INFO	2020-09-15 19:49:47	MarkDuplicates	Tracking 25 as yet unmatched pairs. 15 records in RAM.
INFO	2020-09-15 19:49:52	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|33399:8
INFO	2020-09-15 19:49:52	MarkDuplicates	Tracking 10 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 19:49:57	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:15s.  Time for last 1,000,000:    5s.  Last read position: lcl|42641:81
INFO	2020-09-15 19:49:57	MarkDuplicates	Tracking 59 as yet unmatched pairs. 1 records in RAM.
INFO	2020-09-15 19:50:00	MarkDuplicates	Read 3348584 records. 0 pairs never matched.
INFO	2020-09-15 19:50:03	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4741323504; totalMemory: 5857345536; maxMemory: 28631367680
INFO	2020-09-15 19:50:03	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:50:07	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:50:07	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:50:08	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:50:10	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5796516344; totalMemory: 13051625472; maxMemory: 28631367680
INFO	2020-09-15 19:50:10	MarkDuplicates	Marking 971622 records as duplicates.
INFO	2020-09-15 19:50:10	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:50:10	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:50:49	MarkDuplicates	Before output close freeMemory: 17164029776; totalMemory: 17350787072; maxMemory: 28631367680
INFO	2020-09-15 19:50:49	MarkDuplicates	After output close freeMemory: 17014607696; totalMemory: 17201364992; maxMemory: 28631367680
[Tue Sep 15 19:50:49 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.17 minutes.
Runtime.totalMemory()=17201364992
INFO	2020-09-15 19:50:50	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG_DM.bam
**********


19:50:51.204 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:50:51 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:50:51 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:51:02	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427a_CA_sorted_RG_DM.bai
[Tue Sep 15 19:51:02 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5745672192
java -ea -Xmx226366m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/427b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.505 seconds.
Analyzed Index:   	2.939 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.557 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3634614	(300701180 bases)

Mapping:          	83.626 seconds.
Reads/sec:       	43462.86
kBases/sec:      	3595.80


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 15.5376% 	   282366 	 15.5060% 	    46626806
bad pairs:       	  0.0084% 	      153 	  0.0073% 	       21858
insert size avg: 	  421.83


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 35.9976% 	   654186 	 35.7062% 	    53657694
unambiguous:     	 24.5051% 	   445333 	 25.3530% 	    38099387
ambiguous:       	 11.4924% 	   208853 	 10.3532% 	    15558307
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.4837% 	   190521 	  8.2979% 	    12469693
semiperfect site:	 15.3144% 	   278309 	 13.5039% 	    20293136
rescued:         	  1.8736% 	    34049

Match Rate:      	      NA 	       NA 	 93.4496% 	    50546148
Error Rate:      	 51.7301% 	   430109 	  3.8436% 	     2078997
Sub Rate:        	 50.6182% 	   420864 	  2.7716% 	     1499162
Del Rate:        	  6.4805% 	    53882 	  0.7978% 	      431519
Ins Rate:        	  5.2686% 	    43806 	  0.2742% 	      148316
N Rate:          	 12.6699% 	   105344 	  2.7068% 	     1464068


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 30.4579% 	   553514 	 30.5228% 	    45914073
unambiguous:     	 21.8526% 	   397128 	 22.6445% 	    34063075
ambiguous:       	  8.6054% 	   156386 	  7.8783% 	    11850998
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.7773% 	   141338 	  6.3319% 	     9524811
semiperfect site:	 11.8869% 	   216022 	 10.6632% 	    16040241
rescued:         	  2.4107% 	    43809

Match Rate:      	      NA 	       NA 	 92.6620% 	    42931258
Error Rate:      	 46.2108% 	   380754 	  4.3168% 	     2000029
Sub Rate:        	 45.1847% 	   372300 	  3.1031% 	     1437704
Del Rate:        	  6.3193% 	    52068 	  0.8999% 	      416952
Ins Rate:        	  5.1220% 	    42203 	  0.3138% 	      145373
N Rate:          	 12.2261% 	   100737 	  3.0212% 	     1399738

Total time:     	88.041 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:52:52	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG.bam -RGID 1 -RGLB 427b_CA -RGPL illumina -RGPU combined_runs -RGSM 427b_CA
**********


19:52:52.265 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:52:52 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG.bam RGID=1 RGLB=427b_CA RGPL=illumina RGPU=combined_runs RGSM=427b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:52:52 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:52:52	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=427b_CA SM=427b_CA

INFO	2020-09-15 19:53:02	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|1265:215
INFO	2020-09-15 19:53:12	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 19:53:22	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 19:53:26 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.57 minutes.
Runtime.totalMemory()=2449473536
INFO	2020-09-15 19:53:30	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:53:30.922 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:53:30 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:53:30 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:53:31	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:53:31	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:53:31	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:53:33	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1115:20610:41693 1:N:0:ACTCGTTG+AGTGGCAA. Cause: String 'ACTCGTTG+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:53:39	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|1265:215
INFO	2020-09-15 19:53:39	MarkDuplicates	Tracking 10 as yet unmatched pairs. 5 records in RAM.
INFO	2020-09-15 19:53:45	MarkDuplicates	Read 1850362 records. 0 pairs never matched.
INFO	2020-09-15 19:53:49	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2676035168; totalMemory: 3665297408; maxMemory: 28631367680
INFO	2020-09-15 19:53:49	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:53:53	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:53:53	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:53:53	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:53:54	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3645009720; totalMemory: 10855907328; maxMemory: 28631367680
INFO	2020-09-15 19:53:54	MarkDuplicates	Marking 518543 records as duplicates.
INFO	2020-09-15 19:53:54	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:53:54	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:54:31	MarkDuplicates	Before output close freeMemory: 12787345056; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-15 19:54:31	MarkDuplicates	After output close freeMemory: 12890629792; totalMemory: 12992905216; maxMemory: 28631367680
[Tue Sep 15 19:54:31 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.01 minutes.
Runtime.totalMemory()=12992905216
INFO	2020-09-15 19:54:32	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG_DM.bam
**********


19:54:32.782 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:54:32 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:54:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:54:43	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/427b_CA_sorted_RG_DM.bai
[Tue Sep 15 19:54:43 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226332m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.510 seconds.
Analyzed Index:   	2.792 seconds.
Started output stream:	0.024 seconds.
Cleared Memory:    	2.049 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2174	(229310 bases)

Mapping:          	1.719 seconds.
Reads/sec:       	1264.72
kBases/sec:      	133.40


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 16.2833% 	      177 	 14.6797% 	       33662
bad pairs:       	  0.0000% 	        0 	  0.0000% 	           0
insert size avg: 	  301.60


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.5299% 	      571 	 51.9937% 	       58390
unambiguous:     	 34.0386% 	      370 	 34.8400% 	       39126
ambiguous:       	 18.4913% 	      201 	 17.1537% 	       19264
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.8077% 	       74 	  4.6980% 	        5276
semiperfect site:	 13.6155% 	      148 	 11.2269% 	       12608
rescued:         	  2.2079% 	       24

Match Rate:      	      NA 	       NA 	 89.7229% 	       52609
Error Rate:      	 73.7834% 	      470 	  5.3211% 	        3120
Sub Rate:        	 72.9984% 	      465 	  4.5434% 	        2664
Del Rate:        	  7.0644% 	       45 	  0.4178% 	         245
Ins Rate:        	  8.3203% 	       53 	  0.3599% 	         211
N Rate:          	 25.1177% 	      160 	  4.9561% 	        2906


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 26.0350% 	      283 	 23.0540% 	       26975
unambiguous:     	 18.4913% 	      201 	 16.7476% 	       19596
ambiguous:       	  7.5437% 	       82 	  6.3064% 	        7379
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  3.4039% 	       37 	  2.2178% 	        2595
semiperfect site:	  6.4397% 	       70 	  4.7928% 	        5608
rescued:         	  2.1159% 	       23

Match Rate:      	      NA 	       NA 	 89.3564% 	       24254
Error Rate:      	 55.6872% 	      235 	  5.9131% 	        1605
Sub Rate:        	 54.2654% 	      229 	  5.0289% 	        1365
Del Rate:        	  5.2133% 	       22 	  0.6189% 	         168
Ins Rate:        	  5.4502% 	       23 	  0.2653% 	          72
N Rate:          	 17.5355% 	       74 	  4.7305% 	        1284

Total time:     	7.481 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:54:52	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG.bam -RGID 1 -RGLB 428a_CA -RGPL illumina -RGPU combined_runs -RGSM 428a_CA
**********


19:54:52.511 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:54:52 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG.bam RGID=1 RGLB=428a_CA RGPL=illumina RGPU=combined_runs RGSM=428a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:54:52 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:54:52	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=428a_CA SM=428a_CA

[Tue Sep 15 19:54:53 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=2058354688
INFO	2020-09-15 19:54:53	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:54:53.890 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:54:53 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:54:53 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:54:53	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:54:53	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:54:53	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:54:56	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2104:16972:51645 1:N:0:CCTATGGT+AGTGGAAA. Cause: String 'CCTATGGT+AGTGGAAA' did not start with a parsable number.
INFO	2020-09-15 19:54:56	MarkDuplicates	Read 1354 records. 0 pairs never matched.
INFO	2020-09-15 19:54:56	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1209489912; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:54:56	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:55:00	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:55:00	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:55:00	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:55:01	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2566668672; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 19:55:01	MarkDuplicates	Marking 14 records as duplicates.
INFO	2020-09-15 19:55:01	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:55:02	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:55:02	MarkDuplicates	Before output close freeMemory: 9717357976; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 19:55:02	MarkDuplicates	After output close freeMemory: 9717433992; totalMemory: 9753853952; maxMemory: 28631367680
[Tue Sep 15 19:55:02 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=9753853952
INFO	2020-09-15 19:55:03	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG_DM.bam
**********


19:55:03.720 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:55:03 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:55:03 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:55:05	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428a_CA_sorted_RG_DM.bai
[Tue Sep 15 19:55:05 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.04 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226348m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/428b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.045 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.536 seconds.
Analyzed Index:   	3.263 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.547 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4177942	(358531129 bases)

Mapping:          	128.991 seconds.
Reads/sec:       	32389.29
kBases/sec:      	2779.49


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.3826% 	   467565 	 22.1474% 	    79405164
bad pairs:       	  0.0105% 	      220 	  0.0091% 	       32468
insert size avg: 	  437.66


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.1971% 	  1132162 	 52.4609% 	    93765373
unambiguous:     	 37.2930% 	   779040 	 37.8627% 	    67673519
ambiguous:       	 16.9041% 	   353122 	 14.5982% 	    26091854
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.8359% 	   330808 	 12.0390% 	    21517750
semiperfect site:	 23.3402% 	   487570 	 19.8409% 	    35462470
rescued:         	  2.7843% 	    58164

Match Rate:      	      NA 	       NA 	 93.4235% 	    88211286
Error Rate:      	 50.7129% 	   736512 	  3.6297% 	     3427160
Sub Rate:        	 49.8116% 	   723423 	  2.7265% 	     2574361
Del Rate:        	  6.0405% 	    87727 	  0.6942% 	      655483
Ins Rate:        	  4.2551% 	    61797 	  0.2090% 	      197316
N Rate:          	 13.4100% 	   194756 	  2.9468% 	     2782410


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.3157% 	   946631 	 44.2660% 	    79588979
unambiguous:     	 33.1956% 	   693446 	 33.6169% 	    60442253
ambiguous:       	 12.1201% 	   253185 	 10.6491% 	    19146726
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.1770% 	   233485 	  8.8268% 	    15870313
semiperfect site:	 17.9061% 	   374054 	 15.5831% 	    28018044
rescued:         	  3.4694% 	    72474

Match Rate:      	      NA 	       NA 	 92.4151% 	    74147991
Error Rate:      	 44.9144% 	   645865 	  4.0782% 	     3272103
Sub Rate:        	 44.0904% 	   634016 	  3.0382% 	     2437628
Del Rate:        	  5.8290% 	    83820 	  0.8035% 	      644660
Ins Rate:        	  4.1300% 	    59389 	  0.2366% 	      189815
N Rate:          	 14.0053% 	   201395 	  3.5067% 	     2813545

Total time:     	133.831 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 19:57:44	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG.bam -RGID 1 -RGLB 428b_CA -RGPL illumina -RGPU combined_runs -RGSM 428b_CA
**********


19:57:44.839 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:57:44 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG.bam RGID=1 RGLB=428b_CA RGPL=illumina RGPU=combined_runs RGSM=428b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:57:44 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:57:45	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=428b_CA SM=428b_CA

INFO	2020-09-15 19:57:54	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|11632:1
INFO	2020-09-15 19:58:03	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|28548:39
INFO	2020-09-15 19:58:12	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|40059:205
INFO	2020-09-15 19:58:23	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 19:58:24 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.66 minutes.
Runtime.totalMemory()=3670540288
INFO	2020-09-15 19:58:29	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


19:58:29.620 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:58:29 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:58:29 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:58:29	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 19:58:29	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 19:58:29	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 19:58:32	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1116:21078:85823 1:N:0:TGTACACC+AGTGGCAA. Cause: String 'TGTACACC+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 19:58:40	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|11632:1
INFO	2020-09-15 19:58:40	MarkDuplicates	Tracking 9 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 19:58:44	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:12s.  Time for last 1,000,000:    4s.  Last read position: lcl|28548:39
INFO	2020-09-15 19:58:44	MarkDuplicates	Tracking 42 as yet unmatched pairs. 16 records in RAM.
INFO	2020-09-15 19:58:50	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    5s.  Last read position: lcl|40059:205
INFO	2020-09-15 19:58:50	MarkDuplicates	Tracking 52 as yet unmatched pairs. 48 records in RAM.
INFO	2020-09-15 19:58:52	MarkDuplicates	Read 3222016 records. 0 pairs never matched.
INFO	2020-09-15 19:58:55	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4749044128; totalMemory: 5857345536; maxMemory: 28631367680
INFO	2020-09-15 19:58:55	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 19:58:59	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 19:58:59	OpticalDuplicateFinder	Large duplicate set. size = 1165
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	Large duplicate set. size = 1063
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	Large duplicate set. size = 2128
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	Large duplicate set. size = 2026
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:59:00	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 19:59:00	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 19:59:00	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 19:59:01	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5793949176; totalMemory: 13048479744; maxMemory: 28631367680
INFO	2020-09-15 19:59:01	MarkDuplicates	Marking 1097797 records as duplicates.
INFO	2020-09-15 19:59:01	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 19:59:01	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 19:59:43	MarkDuplicates	Before output close freeMemory: 17162033664; totalMemory: 17348165632; maxMemory: 28631367680
INFO	2020-09-15 19:59:43	MarkDuplicates	After output close freeMemory: 17014184448; totalMemory: 17200316416; maxMemory: 28631367680
[Tue Sep 15 19:59:43 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.23 minutes.
Runtime.totalMemory()=17200316416
INFO	2020-09-15 19:59:44	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG_DM.bam
**********


19:59:44.684 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 19:59:44 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 19:59:44 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 19:59:56	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/428b_CA_sorted_RG_DM.bai
[Tue Sep 15 19:59:56 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5745672192
java -ea -Xmx226371m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432a_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432a_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432a_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432a_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.045 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.516 seconds.
Analyzed Index:   	2.880 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	1.243 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	5087616	(428944624 bases)

Mapping:          	155.115 seconds.
Reads/sec:       	32798.96
kBases/sec:      	2765.33


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.0663% 	   663076 	 25.7968% 	   110654032
bad pairs:       	  0.0132% 	      335 	  0.0109% 	       46700
insert size avg: 	  436.55


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 58.0484% 	  1476640 	 56.3906% 	   120670094
unambiguous:     	 38.0822% 	   968737 	 38.7704% 	    82964642
ambiguous:       	 19.9662% 	   507903 	 17.6202% 	    37705452
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 16.7692% 	   426577 	 12.6016% 	    26966160
semiperfect site:	 25.1235% 	   639093 	 21.3349% 	    45654477
rescued:         	  3.1549% 	    80255

Match Rate:      	      NA 	       NA 	 93.5075% 	   113493534
Error Rate:      	 51.7408% 	   972083 	  3.4478% 	     4184703
Sub Rate:        	 50.9713% 	   957627 	  2.6985% 	     3275259
Del Rate:        	  4.9214% 	    92461 	  0.5798% 	      703689
Ins Rate:        	  3.7128% 	    69754 	  0.1695% 	      205755
N Rate:          	 13.0367% 	   244928 	  3.0448% 	     3695546


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.8984% 	  1243882 	 48.0863% 	   103363719
unambiguous:     	 33.9682% 	   864087 	 34.6507% 	    74483322
ambiguous:       	 14.9302% 	   379795 	 13.4356% 	    28880397
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.0522% 	   306584 	  9.3312% 	    20057906
semiperfect site:	 19.3875% 	   493180 	 16.7938% 	    36098970
rescued:         	  3.8817% 	    98744

Match Rate:      	      NA 	       NA 	 92.6606% 	    96407693
Error Rate:      	 46.1997% 	   861523 	  3.8368% 	     3991978
Sub Rate:        	 45.4835% 	   848167 	  2.9930% 	     3114029
Del Rate:        	  4.7934% 	    89387 	  0.6538% 	      680211
Ins Rate:        	  3.6228% 	    67558 	  0.1901% 	      197738
N Rate:          	 13.0106% 	   242620 	  3.5026% 	     3644259

Total time:     	160.163 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:03:05	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG.bam -RGID 1 -RGLB 432a_CA -RGPL illumina -RGPU combined_runs -RGSM 432a_CA
**********


20:03:06.091 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:03:06 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG.bam RGID=1 RGLB=432a_CA RGPL=illumina RGPU=combined_runs RGSM=432a_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:03:06 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:03:06	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=432a_CA SM=432a_CA

INFO	2020-09-15 20:03:15	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|12314:29
INFO	2020-09-15 20:03:23	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|21946:62
INFO	2020-09-15 20:03:32	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|39858:172
INFO	2020-09-15 20:03:41	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:35s.  Time for last 1,000,000:    8s.  Last read position: lcl|44973:37
INFO	2020-09-15 20:03:51	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:45s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 20:03:52 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.77 minutes.
Runtime.totalMemory()=2344091648
INFO	2020-09-15 20:03:57	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:03:58.221 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:03:58 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:03:58 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:03:58	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:03:58	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:03:58	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:04:00	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1201:11704:38450 1:N:0:GTATGCTG+AGTGGCAA. Cause: String 'GTATGCTG+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 20:04:06	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|12314:29
INFO	2020-09-15 20:04:06	MarkDuplicates	Tracking 21 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 20:04:12	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|21946:62
INFO	2020-09-15 20:04:12	MarkDuplicates	Tracking 47 as yet unmatched pairs. 17 records in RAM.
INFO	2020-09-15 20:04:17	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|39858:172
INFO	2020-09-15 20:04:17	MarkDuplicates	Tracking 463 as yet unmatched pairs. 452 records in RAM.
INFO	2020-09-15 20:04:22	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    5s.  Last read position: lcl|44973:37
INFO	2020-09-15 20:04:22	MarkDuplicates	Tracking 236 as yet unmatched pairs. 234 records in RAM.
INFO	2020-09-15 20:04:23	MarkDuplicates	Read 4114222 records. 0 pairs never matched.
INFO	2020-09-15 20:04:28	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4691526432; totalMemory: 5859966976; maxMemory: 28631367680
INFO	2020-09-15 20:04:28	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:04:32	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:04:33	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:04:33	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:04:34	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5831630432; totalMemory: 13086228480; maxMemory: 28631367680
INFO	2020-09-15 20:04:34	MarkDuplicates	Marking 1258530 records as duplicates.
INFO	2020-09-15 20:04:34	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:04:34	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:05:23	MarkDuplicates	Before output close freeMemory: 17192554848; totalMemory: 17380147200; maxMemory: 28631367680
INFO	2020-09-15 20:05:23	MarkDuplicates	After output close freeMemory: 17009578336; totalMemory: 17197170688; maxMemory: 28631367680
[Tue Sep 15 20:05:23 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.42 minutes.
Runtime.totalMemory()=17197170688
INFO	2020-09-15 20:05:24	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG_DM.bam
**********


20:05:24.740 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:05:24 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:05:24 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:05:40	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432a_CA_sorted_RG_DM.bai
[Tue Sep 15 20:05:40 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.26 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226482m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432b_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432b_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432b_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432b_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.038 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.473 seconds.
Analyzed Index:   	2.788 seconds.
Started output stream:	0.024 seconds.
Cleared Memory:    	0.512 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3393504	(279026662 bases)

Mapping:          	103.663 seconds.
Reads/sec:       	32735.90
kBases/sec:      	2691.67


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 23.8946% 	   405432 	 23.6657% 	    66033512
bad pairs:       	  0.0097% 	      164 	  0.0079% 	       21982
insert size avg: 	  537.11


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.7875% 	   963543 	 55.5863% 	    77576955
unambiguous:     	 36.6607% 	   622042 	 37.6682% 	    52570253
ambiguous:       	 20.1267% 	   341501 	 17.9181% 	    25006702
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.3410% 	   294234 	 13.3708% 	    18660506
semiperfect site:	 25.2267% 	   428034 	 21.7775% 	    30392958
rescued:         	  2.7075% 	    45939

Match Rate:      	      NA 	       NA 	 94.0823% 	    73321724
Error Rate:      	 49.7946% 	   621023 	  3.1949% 	     2489887
Sub Rate:        	 49.1128% 	   612520 	  2.5972% 	     2024054
Del Rate:        	  4.1378% 	    51606 	  0.4576% 	      356656
Ins Rate:        	  3.0095% 	    37534 	  0.1401% 	      109177
N Rate:          	 12.0130% 	   149822 	  2.7228% 	     2122000


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.5574% 	   806931 	 47.3757% 	    66072700
unambiguous:     	 32.5404% 	   552130 	 33.6843% 	    46977934
ambiguous:       	 15.0170% 	   254801 	 13.6914% 	    19094766
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.6241% 	   214199 	 10.0814% 	    14060089
semiperfect site:	 19.4375% 	   329806 	 17.2093% 	    24001023
rescued:         	  3.3417% 	    56701

Match Rate:      	      NA 	       NA 	 93.3103% 	    61983846
Error Rate:      	 44.0694% 	   546484 	  3.5841% 	     2380823
Sub Rate:        	 43.4272% 	   538521 	  2.8865% 	     1917429
Del Rate:        	  4.0272% 	    49940 	  0.5344% 	      354976
Ins Rate:        	  2.9508% 	    36591 	  0.1632% 	      108418
N Rate:          	 11.8253% 	   146640 	  3.1056% 	     2063007

Total time:     	107.839 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:07:47	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG.bam -RGID 1 -RGLB 432b_CA -RGPL illumina -RGPU combined_runs -RGSM 432b_CA
**********


20:07:47.994 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:07:48 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG.bam RGID=1 RGLB=432b_CA RGPL=illumina RGPU=combined_runs RGSM=432b_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:07:48 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:07:48	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=432b_CA SM=432b_CA

INFO	2020-09-15 20:07:57	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|6225:35
INFO	2020-09-15 20:08:07	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|39265:1
INFO	2020-09-15 20:08:17	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 20:08:20 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.54 minutes.
Runtime.totalMemory()=3670540288
INFO	2020-09-15 20:08:24	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:08:24.646 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:08:24 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:08:24 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:08:24	MarkDuplicates	Start of doWork freeMemory: 2037938232; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:08:24	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:08:24	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:08:26	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1114:6813:60318 1:N:0:TGATGTCC+AGTGGCAA. Cause: String 'TGATGTCC+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 20:08:33	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|6225:35
INFO	2020-09-15 20:08:33	MarkDuplicates	Tracking 85 as yet unmatched pairs. 78 records in RAM.
INFO	2020-09-15 20:08:38	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|39265:1
INFO	2020-09-15 20:08:38	MarkDuplicates	Tracking 224 as yet unmatched pairs. 21 records in RAM.
INFO	2020-09-15 20:08:43	MarkDuplicates	Read 2729756 records. 0 pairs never matched.
INFO	2020-09-15 20:08:46	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4762451512; totalMemory: 5843714048; maxMemory: 28631367680
INFO	2020-09-15 20:08:46	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:08:49	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:08:50	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:08:50	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:08:51	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5761948416; totalMemory: 13015449600; maxMemory: 28631367680
INFO	2020-09-15 20:08:51	MarkDuplicates	Marking 809190 records as duplicates.
INFO	2020-09-15 20:08:51	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:08:51	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:09:24	MarkDuplicates	Before output close freeMemory: 12927051288; totalMemory: 13029081088; maxMemory: 28631367680
INFO	2020-09-15 20:09:24	MarkDuplicates	After output close freeMemory: 17103661360; totalMemory: 17288921088; maxMemory: 28631367680
[Tue Sep 15 20:09:24 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.00 minutes.
Runtime.totalMemory()=17288921088
INFO	2020-09-15 20:09:25	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG_DM.bam
**********


20:09:25.956 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:09:25 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:09:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:09:36	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432b_CA_sorted_RG_DM.bai
[Tue Sep 15 20:09:36 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.17 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226289m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432c_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432c_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432c_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432c_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.047 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.520 seconds.
Analyzed Index:   	2.764 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	1.258 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3816362	(313079903 bases)

Mapping:          	121.940 seconds.
Reads/sec:       	31297.12
kBases/sec:      	2567.50


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.0210% 	   496528 	 25.7020% 	    80467944
bad pairs:       	  0.0105% 	      200 	  0.0086% 	       26900
insert size avg: 	  543.10


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 60.9635% 	  1163293 	 59.5727% 	    93293622
unambiguous:     	 38.4033% 	   732804 	 39.5453% 	    61929873
ambiguous:       	 22.5602% 	   430489 	 20.0273% 	    31363749
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 19.3725% 	   369663 	 14.7560% 	    23108600
semiperfect site:	 28.6178% 	   546080 	 24.6793% 	    38649005
rescued:         	  2.9819% 	    56901

Match Rate:      	      NA 	       NA 	 94.1661% 	    88266304
Error Rate:      	 48.7565% 	   728369 	  3.1844% 	     2984845
Sub Rate:        	 48.1355% 	   719092 	  2.5619% 	     2401371
Del Rate:        	  4.0475% 	    60465 	  0.4705% 	      441024
Ins Rate:        	  3.0873% 	    46121 	  0.1520% 	      142450
N Rate:          	 11.9823% 	   179003 	  2.6495% 	     2483497


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.2064% 	   958029 	 49.9556% 	    78168123
unambiguous:     	 33.8552% 	   646018 	 35.1115% 	    54940787
ambiguous:       	 16.3512% 	   312011 	 14.8441% 	    23227336
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.5765% 	   259064 	 10.7173% 	    16769963
semiperfect site:	 21.5938% 	   412049 	 19.0857% 	    29864440
rescued:         	  3.6970% 	    70545

Match Rate:      	      NA 	       NA 	 93.2218% 	    73282502
Error Rate:      	 42.7157% 	   635058 	  3.6422% 	     2863202
Sub Rate:        	 42.1492% 	   626635 	  2.8980% 	     2278155
Del Rate:        	  3.9375% 	    58539 	  0.5633% 	      442823
Ins Rate:        	  3.0142% 	    44812 	  0.1809% 	      142224
N Rate:          	 11.9805% 	   178115 	  3.1360% 	     2465242

Total time:     	126.899 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:12:05	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG.bam -RGID 1 -RGLB 432c_CA -RGPL illumina -RGPU combined_runs -RGSM 432c_CA
**********


20:12:05.319 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:12:05 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG.bam RGID=1 RGLB=432c_CA RGPL=illumina RGPU=combined_runs RGSM=432c_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:12:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:12:05	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=432c_CA SM=432c_CA

INFO	2020-09-15 20:12:14	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|14200:2
INFO	2020-09-15 20:12:23	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    9s.  Last read position: lcl|32947:83
INFO	2020-09-15 20:12:32	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    9s.  Last read position: lcl|43701:50
[Tue Sep 15 20:12:40 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.58 minutes.
Runtime.totalMemory()=3508011008
INFO	2020-09-15 20:12:44	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:12:44.946 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:12:44 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:12:44 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:12:45	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:12:45	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:12:45	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:12:47	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2215:7110:35314 1:N:0:GTCCTTCT+AGTGGCAA. Cause: String 'GTCCTTCT+AGTGGCAA' did not start with a parsable number.
INFO	2020-09-15 20:12:53	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|14200:2
INFO	2020-09-15 20:12:53	MarkDuplicates	Tracking 157 as yet unmatched pairs. 36 records in RAM.
INFO	2020-09-15 20:12:59	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|32947:83
INFO	2020-09-15 20:12:59	MarkDuplicates	Tracking 57 as yet unmatched pairs. 43 records in RAM.
INFO	2020-09-15 20:13:05	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    6s.  Last read position: lcl|43701:50
INFO	2020-09-15 20:13:05	MarkDuplicates	Tracking 9 as yet unmatched pairs. 1 records in RAM.
INFO	2020-09-15 20:13:08	MarkDuplicates	Read 3249188 records. 0 pairs never matched.
INFO	2020-09-15 20:13:11	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4743485592; totalMemory: 5857345536; maxMemory: 28631367680
INFO	2020-09-15 20:13:11	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:13:15	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:13:15	OpticalDuplicateFinder	Large duplicate set. size = 1075
INFO	2020-09-15 20:13:15	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:13:15	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:13:16	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:13:17	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5796043744; totalMemory: 13051101184; maxMemory: 28631367680
INFO	2020-09-15 20:13:17	MarkDuplicates	Marking 983621 records as duplicates.
INFO	2020-09-15 20:13:17	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:13:17	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:13:54	MarkDuplicates	Before output close freeMemory: 17165161656; totalMemory: 17351835648; maxMemory: 28631367680
INFO	2020-09-15 20:13:54	MarkDuplicates	After output close freeMemory: 17015739576; totalMemory: 17202413568; maxMemory: 28631367680
[Tue Sep 15 20:13:54 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.16 minutes.
Runtime.totalMemory()=17202413568
INFO	2020-09-15 20:13:55	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG_DM.bam
**********


20:13:55.655 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:13:55 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:13:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:14:06	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432c_CA_sorted_RG_DM.bai
[Tue Sep 15 20:14:06 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226308m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432d_CA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432d_CA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432d_CA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/432d_CA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.516 seconds.
Analyzed Index:   	2.953 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	1.206 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4166836	(343934598 bases)

Mapping:          	118.811 seconds.
Reads/sec:       	35071.02
kBases/sec:      	2894.80


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 27.0801% 	   564191 	 26.6836% 	    91774196
bad pairs:       	  0.0093% 	      193 	  0.0081% 	       27752
insert size avg: 	  411.38


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 53.5145% 	  1114931 	 52.4247% 	    90099910
unambiguous:     	 35.1690% 	   732718 	 35.9706% 	    61820986
ambiguous:       	 18.3455% 	   382213 	 16.4541% 	    28278924
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 16.4379% 	   342470 	 12.8686% 	    22116637
semiperfect site:	 24.1354% 	   502842 	 21.1640% 	    36373604
rescued:         	  3.0039% 	    62584

Match Rate:      	      NA 	       NA 	 93.9545% 	    85297330
Error Rate:      	 51.6235% 	   717681 	  3.6403% 	     3304847
Sub Rate:        	 50.6212% 	   703747 	  2.6411% 	     2397740
Del Rate:        	  5.9525% 	    82753 	  0.7555% 	      685920
Ins Rate:        	  4.7677% 	    66281 	  0.2436% 	      221187
N Rate:          	 11.7219% 	   162961 	  2.4053% 	     2183653


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.8465% 	   955174 	 45.4749% 	    78248342
unambiguous:     	 31.8750% 	   664089 	 32.6836% 	    56238430
ambiguous:       	 13.9715% 	   291085 	 12.7913% 	    22009912
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.3372% 	   257036 	 10.0010% 	    17208667
semiperfect site:	 19.1736% 	   399466 	 17.2100% 	    29613139
rescued:         	  3.8701% 	    80631

Match Rate:      	      NA 	       NA 	 93.1967% 	    73567271
Error Rate:      	 46.5695% 	   644629 	  4.0651% 	     3208897
Sub Rate:        	 45.6177% 	   631454 	  2.9144% 	     2300588
Del Rate:        	  5.8431% 	    80882 	  0.8732% 	      689252
Ins Rate:        	  4.7145% 	    65260 	  0.2775% 	      219057
N Rate:          	 11.7196% 	   162226 	  2.7381% 	     2161426

Total time:     	123.894 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:16:34	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG.bam -RGID 1 -RGLB 432d_CA -RGPL illumina -RGPU combined_runs -RGSM 432d_CA
**********


20:16:35.109 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:16:35 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG.bam RGID=1 RGLB=432d_CA RGPL=illumina RGPU=combined_runs RGSM=432d_CA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:16:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:16:35	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=432d_CA SM=432d_CA

INFO	2020-09-15 20:16:44	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|6192:418
INFO	2020-09-15 20:16:52	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|31170:252
INFO	2020-09-15 20:17:02	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    9s.  Last read position: lcl|46769:436
INFO	2020-09-15 20:17:11	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 20:17:12 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.62 minutes.
Runtime.totalMemory()=1858076672
INFO	2020-09-15 20:17:17	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:17:17.482 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:17:17 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:17:17 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:17:17	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:17:17	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:17:17	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:17:19	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1101:19437:21681 1:N:0:ACGTTACC+CACAGACT. Cause: String 'ACGTTACC+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 20:17:25	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|6192:418
INFO	2020-09-15 20:17:25	MarkDuplicates	Tracking 112 as yet unmatched pairs. 107 records in RAM.
INFO	2020-09-15 20:17:30	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|31170:252
INFO	2020-09-15 20:17:30	MarkDuplicates	Tracking 3676 as yet unmatched pairs. 3670 records in RAM.
INFO	2020-09-15 20:17:37	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    7s.  Last read position: lcl|46769:436
INFO	2020-09-15 20:17:37	MarkDuplicates	Tracking 24 as yet unmatched pairs. 23 records in RAM.
INFO	2020-09-15 20:17:38	MarkDuplicates	Read 3011442 records. 0 pairs never matched.
INFO	2020-09-15 20:17:40	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4749350152; totalMemory: 5864161280; maxMemory: 28631367680
INFO	2020-09-15 20:17:40	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:17:44	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:17:45	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:17:45	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:17:46	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5793199720; totalMemory: 13047955456; maxMemory: 28631367680
INFO	2020-09-15 20:17:46	MarkDuplicates	Marking 919228 records as duplicates.
INFO	2020-09-15 20:17:46	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:17:46	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:18:28	MarkDuplicates	Before output close freeMemory: 17154475568; totalMemory: 17340825600; maxMemory: 28631367680
INFO	2020-09-15 20:18:28	MarkDuplicates	After output close freeMemory: 17001383472; totalMemory: 17187733504; maxMemory: 28631367680
[Tue Sep 15 20:18:28 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.18 minutes.
Runtime.totalMemory()=17187733504
INFO	2020-09-15 20:18:29	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG_DM.bam
**********


20:18:29.758 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:18:29 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:18:29 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:18:41	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/432d_CA_sorted_RG_DM.bai
[Tue Sep 15 20:18:41 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.20 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226293m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163a_CO_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163a_CO_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163a_CO_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163a_CO_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.047 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.490 seconds.
Analyzed Index:   	2.693 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	1.218 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2959758	(250475985 bases)

Mapping:          	79.182 seconds.
Reads/sec:       	37379.14
kBases/sec:      	3163.29


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 16.4963% 	   244125 	 16.5148% 	    41365628
bad pairs:       	  0.0107% 	      159 	  0.0095% 	       23708
insert size avg: 	  381.55


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 40.8798% 	   604971 	 40.0250% 	    49917541
unambiguous:     	 28.2289% 	   417753 	 28.7913% 	    35907295
ambiguous:       	 12.6509% 	   187218 	 11.2337% 	    14010246
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.6082% 	   142190 	  7.1433% 	     8908834
semiperfect site:	 15.0142% 	   222192 	 12.6926% 	    15829669
rescued:         	  2.1799% 	    32260

Match Rate:      	      NA 	       NA 	 92.1873% 	    46403116
Error Rate:      	 55.3430% 	   429497 	  4.2756% 	     2152173
Sub Rate:        	 54.4964% 	   422927 	  3.2046% 	     1613076
Del Rate:        	  6.1146% 	    47453 	  0.8307% 	      418153
Ins Rate:        	  5.2241% 	    40542 	  0.2403% 	      120944
N Rate:          	 15.0412% 	   116729 	  3.5371% 	     1780405


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 35.1023% 	   519471 	 34.4132% 	    43278071
unambiguous:     	 25.3591% 	   375284 	 25.6905% 	    32308439
ambiguous:       	  9.7432% 	   144187 	  8.7227% 	    10969632
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.9088% 	   102242 	  5.1862% 	     6522160
semiperfect site:	 11.6243% 	   172026 	  9.8730% 	    12416312
rescued:         	  2.7305% 	    40408

Match Rate:      	      NA 	       NA 	 91.4454% 	    39945858
Error Rate:      	 50.3012% 	   386292 	  4.7315% 	     2066858
Sub Rate:        	 49.4875% 	   380043 	  3.5317% 	     1542727
Del Rate:        	  5.9742% 	    45879 	  0.9264% 	      404684
Ins Rate:        	  5.0724% 	    38954 	  0.2734% 	      119447
N Rate:          	 14.4934% 	   111303 	  3.8231% 	     1670039

Total time:     	83.982 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:20:23	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG.bam -RGID 1 -RGLB 163a_CO -RGPL illumina -RGPU combined_runs -RGSM 163a_CO
**********


20:20:23.435 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:20:23 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG.bam RGID=1 RGLB=163a_CO RGPL=illumina RGPU=combined_runs RGSM=163a_CO    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:20:23 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:20:23	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=163a_CO SM=163a_CO

INFO	2020-09-15 20:20:33	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|29151:1
INFO	2020-09-15 20:20:43	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 20:20:51 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.47 minutes.
Runtime.totalMemory()=2560098304
INFO	2020-09-15 20:20:55	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:20:55.672 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:20:55 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:20:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:20:55	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:20:55	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:20:55	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:20:58	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1212:14470:43892 1:N:0:CTGTGTTG+CACAGACT. Cause: String 'CTGTGTTG+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 20:21:03	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|29151:1
INFO	2020-09-15 20:21:03	MarkDuplicates	Tracking 12 as yet unmatched pairs. 9 records in RAM.
INFO	2020-09-15 20:21:07	MarkDuplicates	Read 1760316 records. 0 pairs never matched.
INFO	2020-09-15 20:21:09	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2682909408; totalMemory: 3663200256; maxMemory: 28631367680
INFO	2020-09-15 20:21:09	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:21:13	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:21:13	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:21:14	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:21:14	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3639448616; totalMemory: 10850140160; maxMemory: 28631367680
INFO	2020-09-15 20:21:14	MarkDuplicates	Marking 522103 records as duplicates.
INFO	2020-09-15 20:21:14	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:21:14	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:21:43	MarkDuplicates	Before output close freeMemory: 12787559504; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-15 20:21:43	MarkDuplicates	After output close freeMemory: 12885601360; totalMemory: 12987662336; maxMemory: 28631367680
[Tue Sep 15 20:21:43 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.80 minutes.
Runtime.totalMemory()=12987662336
INFO	2020-09-15 20:21:44	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG_DM.bam
**********


20:21:44.662 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:21:44 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:21:44 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:21:52	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163a_CO_sorted_RG_DM.bai
[Tue Sep 15 20:21:52 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226343m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163b_CO_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163b_CO_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163b_CO_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163b_CO_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.049 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.550 seconds.
Analyzed Index:   	2.914 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.074 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	7318352	(611423692 bases)

Mapping:          	210.111 seconds.
Reads/sec:       	34830.92
kBases/sec:      	2910.01


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 23.5009% 	   859939 	 23.5952% 	   144266806
bad pairs:       	  0.0131% 	      479 	  0.0117% 	       71492
insert size avg: 	  348.33


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.0012% 	  1902815 	 50.9125% 	   155286463
unambiguous:     	 36.2978% 	  1328200 	 37.0298% 	   112943264
ambiguous:       	 15.7034% 	   574615 	 13.8827% 	    42343199
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.4217% 	   454532 	  9.3918% 	    28645513
semiperfect site:	 17.9998% 	   658644 	 15.1697% 	    46268545
rescued:         	  2.9837% 	   109180

Match Rate:      	      NA 	       NA 	 92.7520% 	   145079075
Error Rate:      	 56.3971% 	  1363570 	  4.3955% 	     6875230
Sub Rate:        	 55.5428% 	  1342913 	  3.4542% 	     5402922
Del Rate:        	  5.8785% 	   142130 	  0.7222% 	     1129678
Ins Rate:        	  5.0476% 	   122040 	  0.2191% 	      342630
N Rate:          	 12.6635% 	   306178 	  2.8525% 	     4461836


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.5345% 	  1666189 	 45.0253% 	   137965098
unambiguous:     	 33.2741% 	  1217559 	 33.9875% 	   104143564
ambiguous:       	 12.2604% 	   448630 	 11.0377% 	    33821534
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.2430% 	   338219 	  7.1773% 	    21992629
semiperfect site:	 14.3128% 	   523730 	 12.3005% 	    37690859
rescued:         	  3.6325% 	   132919

Match Rate:      	      NA 	       NA 	 92.0805% 	   128056548
Error Rate:      	 51.8370% 	  1245415 	  4.7559% 	     6614096
Sub Rate:        	 51.0042% 	  1225407 	  3.7212% 	     5175058
Del Rate:        	  5.7357% 	   137803 	  0.7947% 	     1105141
Ins Rate:        	  4.9491% 	   118904 	  0.2401% 	      333897
N Rate:          	 12.6045% 	   302832 	  3.1636% 	     4399595

Total time:     	215.069 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:26:09	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG.bam -RGID 1 -RGLB 163b_CO -RGPL illumina -RGPU combined_runs -RGSM 163b_CO
**********


20:26:09.947 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:26:09 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG.bam RGID=1 RGLB=163b_CO RGPL=illumina RGPU=combined_runs RGSM=163b_CO    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:26:09 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:26:10	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=163b_CO SM=163b_CO

INFO	2020-09-15 20:26:19	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|9428:125
INFO	2020-09-15 20:26:27	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|18265:72
INFO	2020-09-15 20:26:36	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|21512:44
INFO	2020-09-15 20:26:45	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    8s.  Last read position: lcl|40718:2
INFO	2020-09-15 20:26:53	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:    8s.  Last read position: lcl|39940:52
INFO	2020-09-15 20:27:04	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:54s.  Time for last 1,000,000:   11s.  Last read position: */*
INFO	2020-09-15 20:27:13	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:02s.  Time for last 1,000,000:    8s.  Last read position: */*
[Tue Sep 15 20:27:15 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.09 minutes.
Runtime.totalMemory()=2213019648
INFO	2020-09-15 20:27:23	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:27:23.256 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:27:23 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:27:23 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:27:23	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:27:23	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:27:23	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:27:25	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2103:15968:26826 1:N:0:TGAGGTGT+CACAGACT. Cause: String 'TGAGGTGT+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 20:27:33	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|9428:125
INFO	2020-09-15 20:27:33	MarkDuplicates	Tracking 2560 as yet unmatched pairs. 2555 records in RAM.
INFO	2020-09-15 20:27:37	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:12s.  Time for last 1,000,000:    4s.  Last read position: lcl|18265:72
INFO	2020-09-15 20:27:37	MarkDuplicates	Tracking 34 as yet unmatched pairs. 14 records in RAM.
INFO	2020-09-15 20:27:43	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    5s.  Last read position: lcl|21512:44
INFO	2020-09-15 20:27:43	MarkDuplicates	Tracking 46 as yet unmatched pairs. 34 records in RAM.
INFO	2020-09-15 20:27:48	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    4s.  Last read position: lcl|40718:2
INFO	2020-09-15 20:27:48	MarkDuplicates	Tracking 189 as yet unmatched pairs. 174 records in RAM.
INFO	2020-09-15 20:27:54	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    6s.  Last read position: lcl|39940:52
INFO	2020-09-15 20:27:54	MarkDuplicates	Tracking 468 as yet unmatched pairs. 464 records in RAM.
INFO	2020-09-15 20:27:56	MarkDuplicates	Read 5417172 records. 0 pairs never matched.
INFO	2020-09-15 20:28:01	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8840264288; totalMemory: 10169090048; maxMemory: 28631367680
INFO	2020-09-15 20:28:01	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:28:04	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:28:25	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:28:25	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:28:26	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15828390376; totalMemory: 23190831104; maxMemory: 28631367680
INFO	2020-09-15 20:28:26	MarkDuplicates	Marking 1757984 records as duplicates.
INFO	2020-09-15 20:28:26	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:28:26	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:29:36	MarkDuplicates	Before output close freeMemory: 22971042448; totalMemory: 23184015360; maxMemory: 28631367680
INFO	2020-09-15 20:29:36	MarkDuplicates	After output close freeMemory: 22767618704; totalMemory: 22980591616; maxMemory: 28631367680
[Tue Sep 15 20:29:36 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.21 minutes.
Runtime.totalMemory()=22980591616
INFO	2020-09-15 20:29:37	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG_DM.bam
**********


20:29:37.739 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:29:37 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:29:37 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:29:58	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163b_CO_sorted_RG_DM.bai
[Tue Sep 15 20:29:58 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.34 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226307m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163c_CO_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163c_CO_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163c_CO_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163c_CO_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.513 seconds.
Analyzed Index:   	2.990 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	1.264 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	26118492	(2219247255 bases)

Mapping:          	782.787 seconds.
Reads/sec:       	33366.04
kBases/sec:      	2835.06


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.6650% 	  2829283 	 21.4362% 	   475721520
bad pairs:       	  0.0095% 	     1246 	  0.0084% 	      186178
insert size avg: 	  419.30


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.5933% 	  7129479 	 53.3372% 	   591154456
unambiguous:     	 38.2148% 	  4990563 	 38.9520% 	   431718698
ambiguous:       	 16.3786% 	  2138916 	 14.3852% 	   159435758
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.6531% 	  1652397 	  9.7029% 	   107540951
semiperfect site:	 18.0360% 	  2355369 	 15.2285% 	   168782419
rescued:         	  2.9442% 	   384494

Match Rate:      	      NA 	       NA 	 93.0345% 	   553304312
Error Rate:      	 55.2001% 	  5171500 	  4.3522% 	    25883730
Sub Rate:        	 54.3782% 	  5094501 	  3.5486% 	    21104882
Del Rate:        	  5.6127% 	   525829 	  0.6012% 	     3575710
Ins Rate:        	  4.6755% 	   438030 	  0.2023% 	     1203138
N Rate:          	 12.0858% 	  1132271 	  2.6133% 	    15542124


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.3977% 	  6189782 	 46.8218% 	   520149593
unambiguous:     	 34.6567% 	  4525902 	 35.4320% 	   393618587
ambiguous:       	 12.7410% 	  1663880 	 11.3898% 	   126531006
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.3364% 	  1219257 	  7.3559% 	    81717687
semiperfect site:	 14.1055% 	  1842069 	 12.1414% 	   134880599
rescued:         	  3.5163% 	   459203

Match Rate:      	      NA 	       NA 	 92.3804% 	   483746442
Error Rate:      	 50.2577% 	  4677608 	  4.7226% 	    24729681
Sub Rate:        	 49.4707% 	  4604361 	  3.8310% 	    20060790
Del Rate:        	  5.4675% 	   508874 	  0.6677% 	     3496352
Ins Rate:        	  4.5778% 	   426070 	  0.2239% 	     1172539
N Rate:          	 11.9613% 	  1113266 	  2.8970% 	    15169822

Total time:     	787.963 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 20:45:32	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG.bam -RGID 1 -RGLB 163c_CO -RGPL illumina -RGPU combined_runs -RGSM 163c_CO
**********


20:45:32.656 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:45:32 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG.bam RGID=1 RGLB=163c_CO RGPL=illumina RGPU=combined_runs RGSM=163c_CO    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:45:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:45:32	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=163c_CO SM=163c_CO

INFO	2020-09-15 20:45:41	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|4915:43
INFO	2020-09-15 20:45:49	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|9715:33
INFO	2020-09-15 20:45:57	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:    7s.  Last read position: lcl|10843:182
INFO	2020-09-15 20:46:05	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    8s.  Last read position: lcl|7288:247
INFO	2020-09-15 20:46:13	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:    7s.  Last read position: lcl|13214:11
INFO	2020-09-15 20:46:21	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:48s.  Time for last 1,000,000:    7s.  Last read position: lcl|11830:179
INFO	2020-09-15 20:46:29	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:    8s.  Last read position: lcl|2988:82
INFO	2020-09-15 20:46:37	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:04s.  Time for last 1,000,000:    8s.  Last read position: lcl|20702:52
INFO	2020-09-15 20:46:46	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:13s.  Time for last 1,000,000:    8s.  Last read position: lcl|19628:138
INFO	2020-09-15 20:46:54	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:21s.  Time for last 1,000,000:    8s.  Last read position: lcl|26202:207
INFO	2020-09-15 20:47:03	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:30s.  Time for last 1,000,000:    8s.  Last read position: lcl|992:55
INFO	2020-09-15 20:47:11	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:38s.  Time for last 1,000,000:    8s.  Last read position: lcl|17980:9
INFO	2020-09-15 20:47:19	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:46s.  Time for last 1,000,000:    8s.  Last read position: lcl|32147:128
INFO	2020-09-15 20:47:27	AddOrReplaceReadGroups	Processed    14,000,000 records.  Elapsed time: 00:01:54s.  Time for last 1,000,000:    8s.  Last read position: lcl|36985:317
INFO	2020-09-15 20:47:36	AddOrReplaceReadGroups	Processed    15,000,000 records.  Elapsed time: 00:02:03s.  Time for last 1,000,000:    8s.  Last read position: lcl|38144:276
INFO	2020-09-15 20:47:44	AddOrReplaceReadGroups	Processed    16,000,000 records.  Elapsed time: 00:02:11s.  Time for last 1,000,000:    8s.  Last read position: lcl|12546:280
INFO	2020-09-15 20:47:53	AddOrReplaceReadGroups	Processed    17,000,000 records.  Elapsed time: 00:02:20s.  Time for last 1,000,000:    8s.  Last read position: lcl|16608:73
INFO	2020-09-15 20:48:01	AddOrReplaceReadGroups	Processed    18,000,000 records.  Elapsed time: 00:02:28s.  Time for last 1,000,000:    8s.  Last read position: lcl|42760:1
INFO	2020-09-15 20:48:10	AddOrReplaceReadGroups	Processed    19,000,000 records.  Elapsed time: 00:02:36s.  Time for last 1,000,000:    8s.  Last read position: lcl|37871:89
INFO	2020-09-15 20:48:18	AddOrReplaceReadGroups	Processed    20,000,000 records.  Elapsed time: 00:02:45s.  Time for last 1,000,000:    8s.  Last read position: lcl|46203:1
INFO	2020-09-15 20:48:27	AddOrReplaceReadGroups	Processed    21,000,000 records.  Elapsed time: 00:02:54s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 20:48:41	AddOrReplaceReadGroups	Processed    22,000,000 records.  Elapsed time: 00:03:08s.  Time for last 1,000,000:   13s.  Last read position: */*
INFO	2020-09-15 20:48:50	AddOrReplaceReadGroups	Processed    23,000,000 records.  Elapsed time: 00:03:17s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 20:49:00	AddOrReplaceReadGroups	Processed    24,000,000 records.  Elapsed time: 00:03:27s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 20:49:08	AddOrReplaceReadGroups	Processed    25,000,000 records.  Elapsed time: 00:03:35s.  Time for last 1,000,000:    8s.  Last read position: */*
INFO	2020-09-15 20:49:14	AddOrReplaceReadGroups	Processed    26,000,000 records.  Elapsed time: 00:03:41s.  Time for last 1,000,000:    5s.  Last read position: */*
[Tue Sep 15 20:49:15 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 3.71 minutes.
Runtime.totalMemory()=1771044864
INFO	2020-09-15 20:49:41	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


20:49:41.431 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:49:41 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:49:41 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:49:41	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 20:49:41	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 20:49:41	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 20:49:43	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1106:13757:12576 1:N:0:GATCCATG+CACAGACT. Cause: String 'GATCCATG+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 20:49:48	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|4915:43
INFO	2020-09-15 20:49:48	MarkDuplicates	Tracking 145 as yet unmatched pairs. 138 records in RAM.
INFO	2020-09-15 20:49:54	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|9715:33
INFO	2020-09-15 20:49:54	MarkDuplicates	Tracking 389 as yet unmatched pairs. 296 records in RAM.
INFO	2020-09-15 20:50:00	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|10843:182
INFO	2020-09-15 20:50:00	MarkDuplicates	Tracking 1351 as yet unmatched pairs. 1333 records in RAM.
INFO	2020-09-15 20:50:05	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    4s.  Last read position: lcl|7288:247
INFO	2020-09-15 20:50:05	MarkDuplicates	Tracking 4445 as yet unmatched pairs. 4110 records in RAM.
INFO	2020-09-15 20:50:12	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    6s.  Last read position: lcl|13214:11
INFO	2020-09-15 20:50:12	MarkDuplicates	Tracking 1725 as yet unmatched pairs. 1681 records in RAM.
INFO	2020-09-15 20:50:16	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    4s.  Last read position: lcl|11830:179
INFO	2020-09-15 20:50:16	MarkDuplicates	Tracking 692 as yet unmatched pairs. 635 records in RAM.
INFO	2020-09-15 20:50:21	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:37s.  Time for last 1,000,000:    5s.  Last read position: lcl|2988:82
INFO	2020-09-15 20:50:21	MarkDuplicates	Tracking 138 as yet unmatched pairs. 86 records in RAM.
INFO	2020-09-15 20:50:25	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:41s.  Time for last 1,000,000:    3s.  Last read position: lcl|20702:52
INFO	2020-09-15 20:50:25	MarkDuplicates	Tracking 234 as yet unmatched pairs. 171 records in RAM.
INFO	2020-09-15 20:50:29	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:00:45s.  Time for last 1,000,000:    3s.  Last read position: lcl|19628:138
INFO	2020-09-15 20:50:29	MarkDuplicates	Tracking 1629 as yet unmatched pairs. 1575 records in RAM.
INFO	2020-09-15 20:50:36	MarkDuplicates	Read    10,000,000 records.  Elapsed time: 00:00:52s.  Time for last 1,000,000:    7s.  Last read position: lcl|26202:207
INFO	2020-09-15 20:50:36	MarkDuplicates	Tracking 173 as yet unmatched pairs. 110 records in RAM.
INFO	2020-09-15 20:50:39	MarkDuplicates	Read    11,000,000 records.  Elapsed time: 00:00:55s.  Time for last 1,000,000:    3s.  Last read position: lcl|992:55
INFO	2020-09-15 20:50:39	MarkDuplicates	Tracking 99 as yet unmatched pairs. 34 records in RAM.
INFO	2020-09-15 20:50:42	MarkDuplicates	Read    12,000,000 records.  Elapsed time: 00:00:59s.  Time for last 1,000,000:    3s.  Last read position: lcl|17980:9
INFO	2020-09-15 20:50:42	MarkDuplicates	Tracking 356 as yet unmatched pairs. 295 records in RAM.
INFO	2020-09-15 20:51:00	MarkDuplicates	Read    13,000,000 records.  Elapsed time: 00:01:16s.  Time for last 1,000,000:   17s.  Last read position: lcl|32147:128
INFO	2020-09-15 20:51:00	MarkDuplicates	Tracking 126 as yet unmatched pairs. 29 records in RAM.
INFO	2020-09-15 20:51:04	MarkDuplicates	Read    14,000,000 records.  Elapsed time: 00:01:21s.  Time for last 1,000,000:    4s.  Last read position: lcl|36985:317
INFO	2020-09-15 20:51:04	MarkDuplicates	Tracking 8729 as yet unmatched pairs. 8629 records in RAM.
INFO	2020-09-15 20:51:08	MarkDuplicates	Read    15,000,000 records.  Elapsed time: 00:01:25s.  Time for last 1,000,000:    4s.  Last read position: lcl|38144:276
INFO	2020-09-15 20:51:08	MarkDuplicates	Tracking 3273 as yet unmatched pairs. 3213 records in RAM.
INFO	2020-09-15 20:51:13	MarkDuplicates	Read    16,000,000 records.  Elapsed time: 00:01:29s.  Time for last 1,000,000:    4s.  Last read position: lcl|12546:280
INFO	2020-09-15 20:51:13	MarkDuplicates	Tracking 685 as yet unmatched pairs. 633 records in RAM.
INFO	2020-09-15 20:51:22	MarkDuplicates	Read    17,000,000 records.  Elapsed time: 00:01:38s.  Time for last 1,000,000:    8s.  Last read position: lcl|16608:73
INFO	2020-09-15 20:51:22	MarkDuplicates	Tracking 161 as yet unmatched pairs. 106 records in RAM.
INFO	2020-09-15 20:51:26	MarkDuplicates	Read    18,000,000 records.  Elapsed time: 00:01:42s.  Time for last 1,000,000:    4s.  Last read position: lcl|42760:1
INFO	2020-09-15 20:51:26	MarkDuplicates	Tracking 173 as yet unmatched pairs. 128 records in RAM.
INFO	2020-09-15 20:51:30	MarkDuplicates	Read    19,000,000 records.  Elapsed time: 00:01:46s.  Time for last 1,000,000:    3s.  Last read position: lcl|37871:89
INFO	2020-09-15 20:51:30	MarkDuplicates	Tracking 5625 as yet unmatched pairs. 5603 records in RAM.
INFO	2020-09-15 20:51:34	MarkDuplicates	Read    20,000,000 records.  Elapsed time: 00:01:50s.  Time for last 1,000,000:    4s.  Last read position: lcl|46203:1
INFO	2020-09-15 20:51:34	MarkDuplicates	Tracking 406 as yet unmatched pairs. 288 records in RAM.
INFO	2020-09-15 20:51:43	MarkDuplicates	Read 20977464 records. 0 pairs never matched.
INFO	2020-09-15 20:51:58	MarkDuplicates	After buildSortedReadEndLists freeMemory: 10651288976; totalMemory: 12852920320; maxMemory: 28631367680
INFO	2020-09-15 20:51:58	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 20:52:02	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 2959
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 3118
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 3799
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 3410
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 1471
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 1486
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 3697
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 3627
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 3143
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 2902
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	Large duplicate set. size = 1050
INFO	2020-09-15 20:52:26	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 20:52:27	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 20:52:28	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 20:52:29	MarkDuplicates	After generateDuplicateIndexes freeMemory: 16293235944; totalMemory: 23641718784; maxMemory: 28631367680
INFO	2020-09-15 20:52:29	MarkDuplicates	Marking 8785860 records as duplicates.
INFO	2020-09-15 20:52:29	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 20:52:29	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 20:53:58	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:28s.  Time for last 10,000,000:   88s.  Last read position: lcl|26202:207
INFO	2020-09-15 20:55:30	MarkDuplicates	Written    20,000,000 records.  Elapsed time: 00:03:01s.  Time for last 10,000,000:   92s.  Last read position: lcl|46203:1
INFO	2020-09-15 20:56:30	MarkDuplicates	Before output close freeMemory: 23459818920; totalMemory: 23675273216; maxMemory: 28631367680
INFO	2020-09-15 20:56:30	MarkDuplicates	After output close freeMemory: 23172509096; totalMemory: 23387963392; maxMemory: 28631367680
[Tue Sep 15 20:56:30 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 6.81 minutes.
Runtime.totalMemory()=23387963392
INFO	2020-09-15 20:56:31	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG_DM.bam
**********


20:56:31.717 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 20:56:31 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 20:56:31 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 20:57:31	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163c_CO_sorted_RG_DM.bai
[Tue Sep 15 20:57:31 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.99 minutes.
Runtime.totalMemory()=9258401792
java -ea -Xmx226066m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163d_CO_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163d_CO_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163d_CO_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163d_CO_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.589 seconds.
Analyzed Index:   	2.928 seconds.
Started output stream:	0.030 seconds.
Cleared Memory:    	0.543 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4783366	(410554355 bases)

Mapping:          	149.745 seconds.
Reads/sec:       	31943.38
kBases/sec:      	2741.69


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.6274% 	   541175 	 22.5634% 	    92634920
bad pairs:       	  0.0082% 	      197 	  0.0076% 	       31206
insert size avg: 	  423.74


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.5408% 	  1304443 	 53.1438% 	   108888763
unambiguous:     	 37.7182% 	   902099 	 38.4738% 	    78830768
ambiguous:       	 16.8226% 	   402344 	 14.6700% 	    30057995
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.6977% 	   303689 	  9.5195% 	    19504955
semiperfect site:	 18.6286% 	   445536 	 15.5899% 	    31942920
rescued:         	  3.0790% 	    73641

Match Rate:      	      NA 	       NA 	 92.8594% 	   101773298
Error Rate:      	 55.7640% 	   942852 	  4.2474% 	     4655100
Sub Rate:        	 54.9656% 	   929354 	  3.3880% 	     3713209
Del Rate:        	  5.7689% 	    97540 	  0.6484% 	      710644
Ins Rate:        	  4.7553% 	    80403 	  0.2110% 	      231247
N Rate:          	 12.8762% 	   217710 	  2.8933% 	     3171009


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 46.8195% 	  1119774 	 46.0422% 	    94690311
unambiguous:     	 34.2948% 	   820224 	 34.9819% 	    71943627
ambiguous:       	 12.5247% 	   299550 	 11.0603% 	    22746684
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.2043% 	   220137 	  7.0974% 	    14596490
semiperfect site:	 14.6215% 	   349699 	 12.4595% 	    25624224
rescued:         	  3.6986% 	    88459

Match Rate:      	      NA 	       NA 	 91.9334% 	    87698951
Error Rate:      	 50.0273% 	   837938 	  4.6460% 	     4432002
Sub Rate:        	 49.2799% 	   825420 	  3.6678% 	     3498868
Del Rate:        	  5.7241% 	    95877 	  0.7377% 	      703740
Ins Rate:        	  4.6478% 	    77849 	  0.2405% 	      229394
N Rate:          	 13.8515% 	   232008 	  3.4207% 	     3263098

Total time:     	154.226 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:00:34	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG.bam -RGID 1 -RGLB 163d_CO -RGPL illumina -RGPU combined_runs -RGSM 163d_CO
**********


21:00:34.385 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:00:34 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG.bam RGID=1 RGLB=163d_CO RGPL=illumina RGPU=combined_runs RGSM=163d_CO    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:00:34 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:00:34	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=163d_CO SM=163d_CO

INFO	2020-09-15 21:00:43	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|14020:169
INFO	2020-09-15 21:00:52	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|18696:4
INFO	2020-09-15 21:01:01	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|28170:82
INFO	2020-09-15 21:01:11	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:37s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 21:01:18 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.73 minutes.
Runtime.totalMemory()=2344091648
INFO	2020-09-15 21:01:23	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:01:23.962 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:01:23 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:01:23 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:01:24	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:01:24	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:01:24	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:01:26	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1212:10137:40583 1:N:0:GCCTATCA+CACAGACT. Cause: String 'GCCTATCA+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:01:32	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|14020:169
INFO	2020-09-15 21:01:32	MarkDuplicates	Tracking 1478 as yet unmatched pairs. 1231 records in RAM.
INFO	2020-09-15 21:01:37	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|18696:4
INFO	2020-09-15 21:01:37	MarkDuplicates	Tracking 13 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-15 21:01:42	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|28170:82
INFO	2020-09-15 21:01:42	MarkDuplicates	Tracking 326 as yet unmatched pairs. 315 records in RAM.
INFO	2020-09-15 21:01:47	MarkDuplicates	Read 3765690 records. 0 pairs never matched.
INFO	2020-09-15 21:01:52	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4716161360; totalMemory: 5854199808; maxMemory: 28631367680
INFO	2020-09-15 21:01:52	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:01:56	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	Large duplicate set. size = 3178
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	Large duplicate set. size = 2953
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:01:56	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:01:57	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:01:57	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:01:58	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5813180376; totalMemory: 13067354112; maxMemory: 28631367680
INFO	2020-09-15 21:01:58	MarkDuplicates	Marking 1317104 records as duplicates.
INFO	2020-09-15 21:01:58	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:01:59	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:02:46	MarkDuplicates	Before output close freeMemory: 17185137624; totalMemory: 17371758592; maxMemory: 28631367680
INFO	2020-09-15 21:02:46	MarkDuplicates	After output close freeMemory: 17025229784; totalMemory: 17211850752; maxMemory: 28631367680
[Tue Sep 15 21:02:46 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.37 minutes.
Runtime.totalMemory()=17211850752
INFO	2020-09-15 21:02:47	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG_DM.bam
**********


21:02:47.544 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:02:47 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:02:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:03:01	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163d_CO_sorted_RG_DM.bai
[Tue Sep 15 21:03:01 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.23 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226301m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163e_CO_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163e_CO_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163e_CO_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/163e_CO_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.539 seconds.
Analyzed Index:   	2.934 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.225 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3376186	(282934949 bases)

Mapping:          	98.992 seconds.
Reads/sec:       	34105.76
kBases/sec:      	2858.17


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.9557% 	   370633 	 21.7197% 	    61452652
bad pairs:       	  0.0082% 	      139 	  0.0075% 	       21102
insert size avg: 	  409.62


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.8582% 	   875414 	 50.7509% 	    71698610
unambiguous:     	 36.1790% 	   610735 	 36.9484% 	    52199044
ambiguous:       	 15.6792% 	   264679 	 13.8025% 	    19499566
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.1096% 	   221303 	 10.1563% 	    14348402
semiperfect site:	 18.8425% 	   318079 	 16.1163% 	    22768357
rescued:         	  2.6814% 	    45265

Match Rate:      	      NA 	       NA 	 93.1395% 	    67173777
Error Rate:      	 54.4143% 	   612200 	  4.0433% 	     2916067
Sub Rate:        	 53.4264% 	   601085 	  3.2628% 	     2353161
Del Rate:        	  5.3115% 	    59758 	  0.5866% 	      423096
Ins Rate:        	  4.5956% 	    51704 	  0.1939% 	      139810
N Rate:          	 12.5605% 	   141314 	  2.8173% 	     2031862


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.0620% 	   760689 	 44.5169% 	    63062325
unambiguous:     	 32.7776% 	   553316 	 33.5335% 	    47503298
ambiguous:       	 12.2845% 	   207373 	 10.9834% 	    15559027
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.8578% 	   166409 	  7.8267% 	    11087316
semiperfect site:	 14.9408% 	   252215 	 12.9873% 	    18397687
rescued:         	  3.2734% 	    55258

Match Rate:      	      NA 	       NA 	 92.5166% 	    58721259
Error Rate:      	 49.6595% 	   554476 	  4.3870% 	     2784501
Sub Rate:        	 48.7070% 	   543840 	  3.5280% 	     2239278
Del Rate:        	  5.2230% 	    58318 	  0.6440% 	      408726
Ins Rate:        	  4.4492% 	    49678 	  0.2151% 	      136497
N Rate:          	 12.3887% 	   138327 	  3.0964% 	     1965291

Total time:     	104.108 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:05:05	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG.bam -RGID 1 -RGLB 163e_CO -RGPL illumina -RGPU combined_runs -RGSM 163e_CO
**********


21:05:05.686 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:05:05 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG.bam RGID=1 RGLB=163e_CO RGPL=illumina RGPU=combined_runs RGSM=163e_CO    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:05:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:05:05	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=163e_CO SM=163e_CO

INFO	2020-09-15 21:05:15	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|21706:1
INFO	2020-09-15 21:05:24	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|25612:43
INFO	2020-09-15 21:05:34	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 21:05:37 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.53 minutes.
Runtime.totalMemory()=2449473536
INFO	2020-09-15 21:05:41	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:05:41.707 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:05:41 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:05:41 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:05:41	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:05:41	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:05:41	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:05:44	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1104:8649:9151 1:N:0:AACAACCG+CACAGACT. Cause: String 'AACAACCG+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:05:51	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|21706:1
INFO	2020-09-15 21:05:51	MarkDuplicates	Tracking 46 as yet unmatched pairs. 40 records in RAM.
INFO	2020-09-15 21:05:58	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:14s.  Time for last 1,000,000:    6s.  Last read position: lcl|25612:43
INFO	2020-09-15 21:05:58	MarkDuplicates	Tracking 5 as yet unmatched pairs. 1 records in RAM.
INFO	2020-09-15 21:06:02	MarkDuplicates	Read 2530662 records. 0 pairs never matched.
INFO	2020-09-15 21:06:04	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4776608872; totalMemory: 5845811200; maxMemory: 28631367680
INFO	2020-09-15 21:06:04	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:06:08	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:06:08	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:06:09	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:06:10	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5759660616; totalMemory: 13013352448; maxMemory: 28631367680
INFO	2020-09-15 21:06:10	MarkDuplicates	Marking 752920 records as duplicates.
INFO	2020-09-15 21:06:10	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:06:10	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:06:43	MarkDuplicates	Before output close freeMemory: 12920504424; totalMemory: 13022789632; maxMemory: 28631367680
INFO	2020-09-15 21:06:43	MarkDuplicates	After output close freeMemory: 17106633720; totalMemory: 17293115392; maxMemory: 28631367680
[Tue Sep 15 21:06:43 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.03 minutes.
Runtime.totalMemory()=17293115392
INFO	2020-09-15 21:06:44	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG_DM.bam
**********


21:06:45.216 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:06:45 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:06:45 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:06:54	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/163e_CO_sorted_RG_DM.bai
[Tue Sep 15 21:06:54 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.16 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226286m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110a_AZ_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110a_AZ_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110a_AZ_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110a_AZ_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.045 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.505 seconds.
Analyzed Index:   	3.484 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.540 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3189312	(270696308 bases)

Mapping:          	103.103 seconds.
Reads/sec:       	30933.20
kBases/sec:      	2625.49


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.2494% 	   354801 	 21.8366% 	    59110978
bad pairs:       	  0.0101% 	      161 	  0.0087% 	       23576
insert size avg: 	  471.61


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.1976% 	   880212 	 53.7507% 	    72524334
unambiguous:     	 37.3403% 	   595449 	 38.0351% 	    51319752
ambiguous:       	 17.8573% 	   284763 	 15.7156% 	    21204582
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.6361% 	   217449 	 10.2666% 	    13852441
semiperfect site:	 19.7217% 	   314494 	 16.5468% 	    22326138
rescued:         	  2.8854% 	    46013

Match Rate:      	      NA 	       NA 	 93.2466% 	    67976275
Error Rate:      	 54.4558% 	   622417 	  4.0502% 	     2952581
Sub Rate:        	 53.6477% 	   613181 	  3.3624% 	     2451152
Del Rate:        	  5.0925% 	    58206 	  0.5146% 	      375136
Ins Rate:        	  4.1163% 	    47048 	  0.1732% 	      126293
N Rate:          	 12.0922% 	   138211 	  2.7032% 	     1970614


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.0088% 	   749629 	 46.0385% 	    62506084
unambiguous:     	 33.3590% 	   531961 	 33.8872% 	    46008357
ambiguous:       	 13.6498% 	   217668 	 12.1513% 	    16497727
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.9425% 	   158549 	  7.6466% 	    10381681
semiperfect site:	 15.2307% 	   242878 	 12.9390% 	    17567161
rescued:         	  3.4461% 	    54954

Match Rate:      	      NA 	       NA 	 92.5750% 	    58190000
Error Rate:      	 48.9505% 	   553287 	  4.4428% 	     2792606
Sub Rate:        	 48.2107% 	   544925 	  3.6915% 	     2320357
Del Rate:        	  4.8623% 	    54958 	  0.5585% 	      351067
Ins Rate:        	  3.9734% 	    44911 	  0.1928% 	      121182
N Rate:          	 11.7418% 	   132717 	  2.9822% 	     1874545

Total time:     	108.050 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:09:02	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG.bam -RGID 1 -RGLB 110a_AZ -RGPL illumina -RGPU combined_runs -RGSM 110a_AZ
**********


21:09:02.253 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:09:02 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG.bam RGID=1 RGLB=110a_AZ RGPL=illumina RGPU=combined_runs RGSM=110a_AZ    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:09:02 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:09:02	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=110a_AZ SM=110a_AZ

INFO	2020-09-15 21:09:11	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|20613:45
INFO	2020-09-15 21:09:21	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|21116:297
INFO	2020-09-15 21:09:31	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 21:09:32 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.51 minutes.
Runtime.totalMemory()=2449473536
INFO	2020-09-15 21:09:36	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:09:36.585 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:09:36 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:09:36 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:09:36	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:09:36	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:09:36	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:09:39	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2110:15844:89761 1:N:0:ACTCGTTG+CACAGACT. Cause: String 'ACTCGTTG+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:09:44	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|20613:45
INFO	2020-09-15 21:09:44	MarkDuplicates	Tracking 95 as yet unmatched pairs. 89 records in RAM.
INFO	2020-09-15 21:09:49	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|21116:297
INFO	2020-09-15 21:09:49	MarkDuplicates	Tracking 192 as yet unmatched pairs. 188 records in RAM.
INFO	2020-09-15 21:09:53	MarkDuplicates	Read 2549758 records. 0 pairs never matched.
INFO	2020-09-15 21:09:57	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4775594200; totalMemory: 5843189760; maxMemory: 28631367680
INFO	2020-09-15 21:09:57	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:10:01	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:10:01	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:10:01	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:10:02	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5757593072; totalMemory: 13011255296; maxMemory: 28631367680
INFO	2020-09-15 21:10:02	MarkDuplicates	Marking 776969 records as duplicates.
INFO	2020-09-15 21:10:02	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:10:02	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:10:34	MarkDuplicates	Before output close freeMemory: 12919108664; totalMemory: 13021216768; maxMemory: 28631367680
INFO	2020-09-15 21:10:34	MarkDuplicates	After output close freeMemory: 17103385928; totalMemory: 17289445376; maxMemory: 28631367680
[Tue Sep 15 21:10:34 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.96 minutes.
Runtime.totalMemory()=17289445376
INFO	2020-09-15 21:10:35	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG_DM.bam
**********


21:10:35.638 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:10:35 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:10:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:10:44	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110a_AZ_sorted_RG_DM.bai
[Tue Sep 15 21:10:44 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.15 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226429m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110b_AZ_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110b_AZ_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110b_AZ_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110b_AZ_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.535 seconds.
Analyzed Index:   	2.994 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.558 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	8022984	(677626741 bases)

Mapping:          	251.519 seconds.
Reads/sec:       	31898.18
kBases/sec:      	2694.14


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.8155% 	   915243 	 22.6963% 	   153796016
bad pairs:       	  0.0101% 	      406 	  0.0086% 	       58348
insert size avg: 	  449.38


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.6071% 	  2190561 	 53.2165% 	   179855816
unambiguous:     	 36.3776% 	  1459283 	 37.1801% 	   125657409
ambiguous:       	 18.2296% 	   731278 	 16.0365% 	    54198407
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.4462% 	   539392 	  9.8237% 	    33201052
semiperfect site:	 19.9824% 	   801592 	 16.5806% 	    56037449
rescued:         	  2.9806% 	   119566

Match Rate:      	      NA 	       NA 	 92.8589% 	   168120747
Error Rate:      	 54.7087% 	  1547163 	  4.1762% 	     7560944
Sub Rate:        	 53.8799% 	  1523724 	  3.3038% 	     5981593
Del Rate:        	  5.5581% 	   157182 	  0.6594% 	     1193856
Ins Rate:        	  4.6378% 	   131156 	  0.2129% 	      385495
N Rate:          	 13.2744% 	   375399 	  2.9649% 	     5367981


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 46.5939% 	  1869112 	 45.8648% 	   155782881
unambiguous:     	 32.7703% 	  1314576 	 33.5205% 	   113854860
ambiguous:       	 13.8237% 	   554536 	 12.3442% 	    41928021
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.5198% 	   381885 	  7.1364% 	    24239163
semiperfect site:	 15.3713% 	   616620 	 12.9973% 	    44146206
rescued:         	  3.6362% 	   145867

Match Rate:      	      NA 	       NA 	 92.0367% 	   144455885
Error Rate:      	 49.3224% 	  1384055 	  4.6061% 	     7229491
Sub Rate:        	 48.5506% 	  1362396 	  3.6202% 	     5682080
Del Rate:        	  5.4024% 	   151598 	  0.7465% 	     1171697
Ins Rate:        	  4.5072% 	   126478 	  0.2394% 	      375714
N Rate:          	 13.3151% 	   373639 	  3.3572% 	     5269202

Total time:     	256.015 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:15:45	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG.bam -RGID 1 -RGLB 110b_AZ -RGPL illumina -RGPU combined_runs -RGSM 110b_AZ
**********


21:15:45.879 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:15:45 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG.bam RGID=1 RGLB=110b_AZ RGPL=illumina RGPU=combined_runs RGSM=110b_AZ    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:15:45 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:15:46	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=110b_AZ SM=110b_AZ

INFO	2020-09-15 21:15:54	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|11349:100
INFO	2020-09-15 21:16:03	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|11044:3
INFO	2020-09-15 21:16:12	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|15558:826
INFO	2020-09-15 21:16:20	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    8s.  Last read position: lcl|31028:86
INFO	2020-09-15 21:16:29	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:    8s.  Last read position: lcl|29745:571
INFO	2020-09-15 21:16:38	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:52s.  Time for last 1,000,000:    8s.  Last read position: lcl|46493:4
INFO	2020-09-15 21:16:49	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:03s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 21:16:56	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:10s.  Time for last 1,000,000:    7s.  Last read position: */*
[Tue Sep 15 21:16:57 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.19 minutes.
Runtime.totalMemory()=2167930880
INFO	2020-09-15 21:17:05	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:17:05.762 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:17:05 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:17:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:17:05	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:17:05	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:17:05	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:17:08	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1109:23552:7314 1:N:0:CCTATGGT+CACAGACT. Cause: String 'CCTATGGT+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:17:14	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|11349:100
INFO	2020-09-15 21:17:14	MarkDuplicates	Tracking 90 as yet unmatched pairs. 81 records in RAM.
INFO	2020-09-15 21:17:19	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|11044:3
INFO	2020-09-15 21:17:19	MarkDuplicates	Tracking 47 as yet unmatched pairs. 33 records in RAM.
INFO	2020-09-15 21:17:25	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|15558:826
INFO	2020-09-15 21:17:25	MarkDuplicates	Tracking 20 as yet unmatched pairs. 5 records in RAM.
INFO	2020-09-15 21:17:30	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:21s.  Time for last 1,000,000:    5s.  Last read position: lcl|31028:86
INFO	2020-09-15 21:17:30	MarkDuplicates	Tracking 58 as yet unmatched pairs. 31 records in RAM.
INFO	2020-09-15 21:17:36	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    6s.  Last read position: lcl|29745:571
INFO	2020-09-15 21:17:36	MarkDuplicates	Tracking 55 as yet unmatched pairs. 46 records in RAM.
INFO	2020-09-15 21:17:40	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:32s.  Time for last 1,000,000:    4s.  Last read position: lcl|46493:4
INFO	2020-09-15 21:17:40	MarkDuplicates	Tracking 7 as yet unmatched pairs. 5 records in RAM.
INFO	2020-09-15 21:17:41	MarkDuplicates	Read 6288048 records. 0 pairs never matched.
INFO	2020-09-15 21:17:47	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8771165448; totalMemory: 10137632768; maxMemory: 28631367680
INFO	2020-09-15 21:17:47	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:17:51	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	Large duplicate set. size = 1286
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	Large duplicate set. size = 5056
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	Large duplicate set. size = 4535
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	Large duplicate set. size = 1163
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	Large duplicate set. size = 1520
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	Large duplicate set. size = 1260
INFO	2020-09-15 21:18:11	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:18:11	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:18:12	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:18:13	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15814908960; totalMemory: 23175102464; maxMemory: 28631367680
INFO	2020-09-15 21:18:13	MarkDuplicates	Marking 2348356 records as duplicates.
INFO	2020-09-15 21:18:13	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:18:13	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:19:29	MarkDuplicates	Before output close freeMemory: 23065856600; totalMemory: 23278387200; maxMemory: 28631367680
INFO	2020-09-15 21:19:29	MarkDuplicates	After output close freeMemory: 23058516568; totalMemory: 23271047168; maxMemory: 28631367680
[Tue Sep 15 21:19:29 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.39 minutes.
Runtime.totalMemory()=23271047168
INFO	2020-09-15 21:19:30	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG_DM.bam
**********


21:19:30.958 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:19:30 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:19:30 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:19:51	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110b_AZ_sorted_RG_DM.bai
[Tue Sep 15 21:19:51 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.34 minutes.
Runtime.totalMemory()=10046930944
java -ea -Xmx226266m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110c_AZ_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110c_AZ_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110c_AZ_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/110c_AZ_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.526 seconds.
Analyzed Index:   	2.882 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	0.574 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4552774	(365784130 bases)

Mapping:          	150.125 seconds.
Reads/sec:       	30326.51
kBases/sec:      	2436.53


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 29.4525% 	   670454 	 29.1566% 	   106650334
bad pairs:       	  0.0106% 	      241 	  0.0097% 	       35442
insert size avg: 	  416.10


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 59.4409% 	  1353104 	 58.3302% 	   106543628
unambiguous:     	 37.2742% 	   848506 	 38.3448% 	    70039164
ambiguous:       	 22.1666% 	   504598 	 19.9854% 	    36504464
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.1682% 	   345286 	 11.1942% 	    20446971
semiperfect site:	 22.4413% 	   510850 	 18.9235% 	    34564921
rescued:         	  3.5610% 	    81063

Match Rate:      	      NA 	       NA 	 93.6154% 	   100341074
Error Rate:      	 55.7764% 	   951805 	  3.9840% 	     4270200
Sub Rate:        	 54.9966% 	   938498 	  3.2008% 	     3430709
Del Rate:        	  5.0711% 	    86536 	  0.5977% 	      640693
Ins Rate:        	  3.9937% 	    68151 	  0.1855% 	      198798
N Rate:          	 11.3611% 	   193873 	  2.4006% 	     2573047


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.2202% 	  1165971 	 50.8195% 	    93064721
unambiguous:     	 33.9440% 	   772696 	 35.0161% 	    64124294
ambiguous:       	 17.2763% 	   393275 	 15.8034% 	    28940427
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.0897% 	   252444 	  8.3628% 	    15314698
semiperfect site:	 17.6529% 	   401849 	 15.1534% 	    27750087
rescued:         	  4.4599% 	   101525

Match Rate:      	      NA 	       NA 	 92.9322% 	    87090198
Error Rate:      	 50.5824% 	   859117 	  4.4056% 	     4128606
Sub Rate:        	 49.8210% 	   846185 	  3.4939% 	     3274232
Del Rate:        	  4.9694% 	    84403 	  0.6925% 	      648986
Ins Rate:        	  3.9720% 	    67462 	  0.2192% 	      205388
N Rate:          	 11.2189% 	   190547 	  2.6623% 	     2494903

Total time:     	154.516 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:22:51	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG.bam -RGID 1 -RGLB 110c_AZ -RGPL illumina -RGPU combined_runs -RGSM 110c_AZ
**********


21:22:52.150 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:22:52 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG.bam RGID=1 RGLB=110c_AZ RGPL=illumina RGPU=combined_runs RGSM=110c_AZ    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:22:52 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:22:52	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=110c_AZ SM=110c_AZ

INFO	2020-09-15 21:23:01	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|11144:34
INFO	2020-09-15 21:23:10	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    9s.  Last read position: lcl|15852:163
INFO	2020-09-15 21:23:19	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|40859:80
INFO	2020-09-15 21:23:29	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 21:23:33 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.68 minutes.
Runtime.totalMemory()=2373976064
INFO	2020-09-15 21:23:38	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:23:38.412 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:23:38 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:23:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:23:38	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:23:38	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:23:38	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:23:40	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2112:11143:11300 1:N:0:TGTACACC+CACAGACT. Cause: String 'TGTACACC+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:23:47	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|11144:34
INFO	2020-09-15 21:23:47	MarkDuplicates	Tracking 126 as yet unmatched pairs. 60 records in RAM.
INFO	2020-09-15 21:23:51	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|15852:163
INFO	2020-09-15 21:23:51	MarkDuplicates	Tracking 68 as yet unmatched pairs. 54 records in RAM.
INFO	2020-09-15 21:23:58	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    6s.  Last read position: lcl|40859:80
INFO	2020-09-15 21:23:58	MarkDuplicates	Tracking 197 as yet unmatched pairs. 154 records in RAM.
INFO	2020-09-15 21:24:00	MarkDuplicates	Read 3696760 records. 0 pairs never matched.
INFO	2020-09-15 21:24:04	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4706809064; totalMemory: 5862064128; maxMemory: 28631367680
INFO	2020-09-15 21:24:04	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:24:08	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:24:08	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:24:09	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:24:10	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5808631728; totalMemory: 13063684096; maxMemory: 28631367680
INFO	2020-09-15 21:24:10	MarkDuplicates	Marking 1048908 records as duplicates.
INFO	2020-09-15 21:24:10	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:24:10	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:24:53	MarkDuplicates	Before output close freeMemory: 17167767480; totalMemory: 17354981376; maxMemory: 28631367680
INFO	2020-09-15 21:24:53	MarkDuplicates	After output close freeMemory: 17001568184; totalMemory: 17188782080; maxMemory: 28631367680
[Tue Sep 15 21:24:53 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.25 minutes.
Runtime.totalMemory()=17188782080
INFO	2020-09-15 21:24:54	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG_DM.bam
**********


21:24:54.816 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:24:54 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:24:54 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:25:08	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/110c_AZ_sorted_RG_DM.bai
[Tue Sep 15 21:25:08 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.22 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226551m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112b_AZ_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112b_AZ_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112b_AZ_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112b_AZ_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.045 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.541 seconds.
Analyzed Index:   	3.054 seconds.
Started output stream:	0.031 seconds.
Cleared Memory:    	1.151 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	771988	(73132606 bases)

Mapping:          	31.445 seconds.
Reads/sec:       	24550.06
kBases/sec:      	2325.70


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.4078% 	    82633 	 19.0684% 	    13945242
bad pairs:       	  0.0101% 	       39 	  0.0082% 	        5964
insert size avg: 	  387.67


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.7192% 	   191913 	 44.5117% 	    15896633
unambiguous:     	 32.8220% 	   126691 	 30.7623% 	    10986232
ambiguous:       	 16.8972% 	    65222 	 13.7495% 	     4910401
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.5178% 	    44458 	  7.6744% 	     2740787
semiperfect site:	 17.6249% 	    68031 	 13.4037% 	     4786902
rescued:         	  3.0213% 	    11662

Match Rate:      	      NA 	       NA 	 92.6552% 	    14829639
Error Rate:      	 56.4905% 	   139109 	  4.1902% 	      670657
Sub Rate:        	 55.5780% 	   136862 	  3.3080% 	      529456
Del Rate:        	  5.6178% 	    13834 	  0.6783% 	      108561
Ins Rate:        	  4.5194% 	    11129 	  0.2039% 	       32640
N Rate:          	 13.8992% 	    34227 	  3.1546% 	      504898


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 42.1722% 	   162782 	 36.4634% 	    13644343
unambiguous:     	 29.4725% 	   113762 	 26.4056% 	     9880771
ambiguous:       	 12.6997% 	    49020 	 10.0578% 	     3763572
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.2066% 	    31677 	  5.3749% 	     2011247
semiperfect site:	 13.4678% 	    51985 	  9.9853% 	     3736421
rescued:         	  3.6117% 	    13941

Match Rate:      	      NA 	       NA 	 91.8650% 	    12630494
Error Rate:      	 50.6018% 	   123149 	  4.5869% 	      630648
Sub Rate:        	 49.6990% 	   120952 	  3.5811% 	      492362
Del Rate:        	  5.5393% 	    13481 	  0.7610% 	      104627
Ins Rate:        	  4.3843% 	    10670 	  0.2448% 	       33659
N Rate:          	 13.7146% 	    33377 	  3.5481% 	      487828

Total time:     	36.614 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:25:50	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG.bam -RGID 1 -RGLB 112b_AZ -RGPL illumina -RGPU combined_runs -RGSM 112b_AZ
**********


21:25:51.056 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:25:51 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG.bam RGID=1 RGLB=112b_AZ RGPL=illumina RGPU=combined_runs RGSM=112b_AZ    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:25:51 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:25:51	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=112b_AZ SM=112b_AZ

[Tue Sep 15 21:26:00 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.15 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 21:26:01	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:26:01.906 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:26:01 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:26:01 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:26:01	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:26:01	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:26:01	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:26:04	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2109:22909:20330 1:N:0:GTATGCTG+CACAGACT. Cause: String 'GTATGCTG+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:26:07	MarkDuplicates	Read 544046 records. 0 pairs never matched.
INFO	2020-09-15 21:26:08	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1703887152; totalMemory: 2595749888; maxMemory: 28631367680
INFO	2020-09-15 21:26:08	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:26:12	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:26:13	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:26:13	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:26:14	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2564526024; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 21:26:14	MarkDuplicates	Marking 104680 records as duplicates.
INFO	2020-09-15 21:26:14	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:26:14	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:26:23	MarkDuplicates	Before output close freeMemory: 10769462656; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 21:26:23	MarkDuplicates	After output close freeMemory: 10769462656; totalMemory: 10828644352; maxMemory: 28631367680
[Tue Sep 15 21:26:23 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.37 minutes.
Runtime.totalMemory()=10828644352
INFO	2020-09-15 21:26:24	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG_DM.bam
**********


21:26:25.074 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:26:25 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:26:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:26:29	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112b_AZ_sorted_RG_DM.bai
[Tue Sep 15 21:26:29 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.07 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226333m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112c_AZ_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112c_AZ_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112c_AZ_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/112c_AZ_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.494 seconds.
Analyzed Index:   	2.960 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.198 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	73626	(6377676 bases)

Mapping:          	10.161 seconds.
Reads/sec:       	7245.67
kBases/sec:      	627.64


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.9240% 	     8439 	 22.1107% 	     1410150
bad pairs:       	  0.0217% 	        8 	  0.0158% 	        1010
insert size avg: 	  442.79


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.2308% 	    19964 	 51.7545% 	     1639267
unambiguous:     	 36.8701% 	    13573 	 36.7809% 	     1164994
ambiguous:       	 17.3607% 	     6391 	 14.9736% 	      474273
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.1856% 	     4854 	  9.5415% 	      302217
semiperfect site:	 19.4605% 	     7164 	 15.8439% 	      501837
rescued:         	  3.2869% 	     1210

Match Rate:      	      NA 	       NA 	 93.1130% 	     1534367
Error Rate:      	 55.8648% 	    14250 	  3.9220% 	       64629
Sub Rate:        	 54.9279% 	    14011 	  3.2441% 	       53458
Del Rate:        	  5.0141% 	     1279 	  0.5212% 	        8588
Ins Rate:        	  3.7282% 	      951 	  0.1567% 	        2583
N Rate:          	 13.3056% 	     3394 	  2.9650% 	       48859


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.9895% 	    16562 	 42.8492% 	     1375582
unambiguous:     	 32.0919% 	    11814 	 31.6967% 	     1017556
ambiguous:       	 12.8976% 	     4748 	 11.1525% 	      358026
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.2657% 	     3411 	  6.7822% 	      217728
semiperfect site:	 14.7774% 	     5440 	 12.1129% 	      388859
rescued:         	  3.7025% 	     1363

Match Rate:      	      NA 	       NA 	 92.3854% 	     1278449
Error Rate:      	 49.1039% 	    12302 	  4.3753% 	       60546
Sub Rate:        	 48.3216% 	    12106 	  3.5833% 	       49586
Del Rate:        	  4.8896% 	     1225 	  0.5954% 	        8239
Ins Rate:        	  3.7201% 	      932 	  0.1966% 	        2721
N Rate:          	 12.5095% 	     3134 	  3.2393% 	       44826

Total time:     	15.222 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:26:46	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG.bam -RGID 1 -RGLB 112c_AZ -RGPL illumina -RGPU combined_runs -RGSM 112c_AZ
**********


21:26:46.421 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:26:46 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG.bam RGID=1 RGLB=112c_AZ RGPL=illumina RGPU=combined_runs RGSM=112c_AZ    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:26:46 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:26:46	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=112c_AZ SM=112c_AZ

[Tue Sep 15 21:26:47 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.03 minutes.
Runtime.totalMemory()=2058354688
INFO	2020-09-15 21:26:48	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:26:48.989 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:26:49 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:26:49 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:26:49	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:26:49	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:26:49	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:26:51	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1111:18937:51345 1:N:0:TGATGTCC+CACAGACT. Cause: String 'TGATGTCC+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:26:51	MarkDuplicates	Read 56158 records. 0 pairs never matched.
INFO	2020-09-15 21:26:53	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1205755168; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:26:53	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:26:57	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:26:57	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:26:57	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:26:58	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2565451880; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 21:26:58	MarkDuplicates	Marking 5158 records as duplicates.
INFO	2020-09-15 21:26:58	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:26:58	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:26:59	MarkDuplicates	Before output close freeMemory: 9719511712; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 21:27:00	MarkDuplicates	After output close freeMemory: 9723218560; totalMemory: 9753853952; maxMemory: 28631367680
[Tue Sep 15 21:27:00 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=9753853952
INFO	2020-09-15 21:27:00	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG_DM.bam
**********


21:27:01.162 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:27:01 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:27:01 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:27:03	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/112c_AZ_sorted_RG_DM.bai
[Tue Sep 15 21:27:03 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.04 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226401m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103a_NM_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103a_NM_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103a_NM_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103a_NM_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.571 seconds.
Analyzed Index:   	3.240 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	1.228 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	13272282	(1130593754 bases)

Mapping:          	448.488 seconds.
Reads/sec:       	29593.38
kBases/sec:      	2520.90


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 24.8315% 	  1647852 	 24.1331% 	   272847786
bad pairs:       	  0.0161% 	     1066 	  0.0140% 	      157766
insert size avg: 	  316.18


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.1592% 	  3461355 	 50.3063% 	   283490094
unambiguous:     	 35.3095% 	  2343189 	 36.1431% 	   203676432
ambiguous:       	 16.8496% 	  1118166 	 14.1632% 	    79813662
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.0795% 	   735252 	  8.2991% 	    46767778
semiperfect site:	 16.2736% 	  1079941 	 13.6588% 	    76971308
rescued:         	  3.5616% 	   236355

Match Rate:      	      NA 	       NA 	 91.2829% 	   261047451
Error Rate:      	 59.7762% 	  2586769 	  4.5381% 	    12977883
Sub Rate:        	 53.8942% 	  2332230 	  3.2572% 	     9314736
Del Rate:        	  6.8670% 	   297165 	  0.8694% 	     2486282
Ins Rate:        	 12.8741% 	   557118 	  0.4115% 	     1176865
N Rate:          	 16.1512% 	   698932 	  4.1790% 	    11951042


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.8213% 	  3040765 	 44.3479% 	   251481721
unambiguous:     	 32.1517% 	  2133635 	 32.8278% 	   186155258
ambiguous:       	 13.6695% 	   907130 	 11.5201% 	    65326463
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.1267% 	   539296 	  6.2242% 	    35295136
semiperfect site:	 12.8092% 	   850039 	 10.9269% 	    61962985
rescued:         	  4.3178% 	   286535

Match Rate:      	      NA 	       NA 	 90.6466% 	   230152943
Error Rate:      	 55.2838% 	  2365038 	  4.9528% 	    12575100
Sub Rate:        	 49.9750% 	  2137927 	  3.5504% 	     9014621
Del Rate:        	  6.7004% 	   286641 	  0.9530% 	     2419556
Ins Rate:        	 12.4453% 	   532407 	  0.4494% 	     1140923
N Rate:          	 15.7426% 	   673466 	  4.4006% 	    11173234

Total time:     	453.941 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:35:51	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG.bam -RGID 1 -RGLB 103a_NM -RGPL illumina -RGPU combined_runs -RGSM 103a_NM
**********


21:35:51.830 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:35:51 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG.bam RGID=1 RGLB=103a_NM RGPL=illumina RGPU=combined_runs RGSM=103a_NM    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:35:51 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:35:52	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=103a_NM SM=103a_NM

INFO	2020-09-15 21:36:01	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|6564:117
INFO	2020-09-15 21:36:09	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|5509:44
INFO	2020-09-15 21:36:18	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|8478:120
INFO	2020-09-15 21:36:27	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:35s.  Time for last 1,000,000:    9s.  Last read position: lcl|23417:1
INFO	2020-09-15 21:36:36	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:    8s.  Last read position: lcl|23709:356
INFO	2020-09-15 21:36:45	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:53s.  Time for last 1,000,000:    9s.  Last read position: lcl|33204:663
INFO	2020-09-15 21:36:54	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:02s.  Time for last 1,000,000:    9s.  Last read position: lcl|34510:8
INFO	2020-09-15 21:37:03	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:11s.  Time for last 1,000,000:    9s.  Last read position: lcl|18464:457
INFO	2020-09-15 21:37:12	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:20s.  Time for last 1,000,000:    9s.  Last read position: lcl|39677:93
INFO	2020-09-15 21:37:25	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:32s.  Time for last 1,000,000:   12s.  Last read position: */*
INFO	2020-09-15 21:37:35	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:43s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 21:37:45	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:53s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 21:37:52	AddOrReplaceReadGroups	Processed    13,000,000 records.  Elapsed time: 00:01:59s.  Time for last 1,000,000:    6s.  Last read position: */*
[Tue Sep 15 21:37:53 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 2.03 minutes.
Runtime.totalMemory()=2907701248
INFO	2020-09-15 21:38:07	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:38:07.810 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:38:07 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:38:07 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:38:07	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:38:07	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:38:07	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:38:10	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1109:10483:6723 1:N:0:GTCCTTCT+CACAGACT. Cause: String 'GTCCTTCT+CACAGACT' did not start with a parsable number.
INFO	2020-09-15 21:38:16	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|6564:117
INFO	2020-09-15 21:38:16	MarkDuplicates	Tracking 551 as yet unmatched pairs. 521 records in RAM.
INFO	2020-09-15 21:38:20	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|5509:44
INFO	2020-09-15 21:38:20	MarkDuplicates	Tracking 22 as yet unmatched pairs. 9 records in RAM.
INFO	2020-09-15 21:38:25	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:15s.  Time for last 1,000,000:    5s.  Last read position: lcl|8478:120
INFO	2020-09-15 21:38:25	MarkDuplicates	Tracking 46 as yet unmatched pairs. 21 records in RAM.
INFO	2020-09-15 21:38:30	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:    4s.  Last read position: lcl|23417:1
INFO	2020-09-15 21:38:30	MarkDuplicates	Tracking 162747 as yet unmatched pairs. 162710 records in RAM.
INFO	2020-09-15 21:38:37	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    7s.  Last read position: lcl|23709:356
INFO	2020-09-15 21:38:37	MarkDuplicates	Tracking 1050 as yet unmatched pairs. 888 records in RAM.
INFO	2020-09-15 21:38:41	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:31s.  Time for last 1,000,000:    4s.  Last read position: lcl|33204:663
INFO	2020-09-15 21:38:41	MarkDuplicates	Tracking 1006 as yet unmatched pairs. 948 records in RAM.
INFO	2020-09-15 21:38:46	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    4s.  Last read position: lcl|34510:8
INFO	2020-09-15 21:38:46	MarkDuplicates	Tracking 73 as yet unmatched pairs. 44 records in RAM.
INFO	2020-09-15 21:38:50	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:    4s.  Last read position: lcl|18464:457
INFO	2020-09-15 21:38:50	MarkDuplicates	Tracking 224 as yet unmatched pairs. 207 records in RAM.
INFO	2020-09-15 21:39:05	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:00:55s.  Time for last 1,000,000:   14s.  Last read position: lcl|39677:93
INFO	2020-09-15 21:39:05	MarkDuplicates	Tracking 46 as yet unmatched pairs. 42 records in RAM.
INFO	2020-09-15 21:39:08	MarkDuplicates	Read 9706404 records. 0 pairs never matched.
INFO	2020-09-15 21:39:16	MarkDuplicates	After buildSortedReadEndLists freeMemory: 11220269960; totalMemory: 12849250304; maxMemory: 28631367680
INFO	2020-09-15 21:39:16	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:39:19	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1074
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1128
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1828
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1704
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1435
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1320
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 3330
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2912
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1754
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1012
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2200
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1971
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1687
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1327
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 3065
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2935
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1717
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2126
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1973
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1635
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1328
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 4135
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 3788
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2144
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1474
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1142
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1280
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2992
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2808
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 2138
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1863
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1016
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1079
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	Large duplicate set. size = 1123
INFO	2020-09-15 21:39:37	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1025
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2848
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2956
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2367
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2560
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 4274
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 4598
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2051
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2159
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1061
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1084
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1419
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1210
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 4090
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 4067
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 3089
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 3327
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 5669
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 5873
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2697
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2603
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1361
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1341
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1173
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1181
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1136
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1156
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1037
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1028
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1290
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1015
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1218
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1558
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1004
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 3094
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 3053
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2385
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2494
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 4282
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 4702
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2104
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 2190
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1028
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	Large duplicate set. size = 1167
INFO	2020-09-15 21:39:38	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:39:38	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:39:39	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:39:40	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15663780664; totalMemory: 23014146048; maxMemory: 28631367680
INFO	2020-09-15 21:39:40	MarkDuplicates	Marking 4108690 records as duplicates.
INFO	2020-09-15 21:39:40	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:39:40	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:41:18	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:37s.  Time for last 10,000,000:   97s.  Last read position: */*
INFO	2020-09-15 21:41:49	MarkDuplicates	Before output close freeMemory: 22563046824; totalMemory: 22773497856; maxMemory: 28631367680
INFO	2020-09-15 21:41:49	MarkDuplicates	After output close freeMemory: 22803170728; totalMemory: 23013621760; maxMemory: 28631367680
[Tue Sep 15 21:41:49 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 3.70 minutes.
Runtime.totalMemory()=23013621760
INFO	2020-09-15 21:41:51	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG_DM.bam
**********


21:41:51.693 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:41:51 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:41:51 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:42:22	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103a_NM_sorted_RG_DM.bai
[Tue Sep 15 21:42:22 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.52 minutes.
Runtime.totalMemory()=10046930944
java -ea -Xmx226369m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103b_NM_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103b_NM_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103b_NM_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103b_NM_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.547 seconds.
Analyzed Index:   	2.818 seconds.
Started output stream:	0.032 seconds.
Cleared Memory:    	0.980 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2066682	(178528950 bases)

Mapping:          	54.727 seconds.
Reads/sec:       	37763.35
kBases/sec:      	3262.16


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 15.4526% 	   159678 	 15.1015% 	    26960476
bad pairs:       	  0.0083% 	       86 	  0.0073% 	       13104
insert size avg: 	  360.33


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 36.6317% 	   378530 	 35.2649% 	    31246681
unambiguous:     	 25.3443% 	   261893 	 25.4420% 	    22543045
ambiguous:       	 11.2874% 	   116637 	  9.8229% 	     8703636
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.4210% 	    87018 	  6.1826% 	     5478134
semiperfect site:	 12.7201% 	   131442 	 10.5141% 	     9316117
rescued:         	  2.1148% 	    21853

Match Rate:      	      NA 	       NA 	 92.3052% 	    29080802
Error Rate:      	 56.1577% 	   273327 	  4.4470% 	     1401040
Sub Rate:        	 55.2330% 	   268826 	  3.3685% 	     1061234
Del Rate:        	  6.3917% 	    31109 	  0.8200% 	      258356
Ins Rate:        	  5.2429% 	    25518 	  0.2585% 	       81450
N Rate:          	 14.0769% 	    68514 	  3.2477% 	     1023195


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 31.6873% 	   327438 	 30.3776% 	    27316540
unambiguous:     	 22.8758% 	   236385 	 22.6941% 	    20407319
ambiguous:       	  8.8115% 	    91053 	  7.6834% 	     6909221
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.1235% 	    63277 	  4.5244% 	     4068522
semiperfect site:	  9.9810% 	   103138 	  8.2653% 	     7432485
rescued:         	  2.5983% 	    26849

Match Rate:      	      NA 	       NA 	 91.6261% 	    25247359
Error Rate:      	 51.1601% 	   246433 	  4.7864% 	     1318895
Sub Rate:        	 50.2906% 	   242245 	  3.6317% 	     1000719
Del Rate:        	  6.2447% 	    30080 	  0.8646% 	      238230
Ins Rate:        	  5.0993% 	    24563 	  0.2901% 	       79946
N Rate:          	 13.9758% 	    67320 	  3.5875% 	      988516

Total time:     	59.490 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:43:35	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG.bam -RGID 1 -RGLB 103b_NM -RGPL illumina -RGPU combined_runs -RGSM 103b_NM
**********


21:43:35.650 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:43:35 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG.bam RGID=1 RGLB=103b_NM RGPL=illumina RGPU=combined_runs RGSM=103b_NM    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:43:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:43:35	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=103b_NM SM=103b_NM

INFO	2020-09-15 21:43:46	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|39940:299
INFO	2020-09-15 21:43:56	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 21:43:56 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.35 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 21:43:59	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:43:59.973 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:43:59 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:43:59 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:44:00	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:44:00	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:44:00	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:44:02	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2115:1852:51905 1:N:0:ACGTTACC+CGACACTT. Cause: String 'ACGTTACC+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 21:44:09	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|39940:299
INFO	2020-09-15 21:44:09	MarkDuplicates	Tracking 230 as yet unmatched pairs. 230 records in RAM.
INFO	2020-09-15 21:44:09	MarkDuplicates	Read 1092408 records. 0 pairs never matched.
INFO	2020-09-15 21:44:11	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2726566016; totalMemory: 3670540288; maxMemory: 28631367680
INFO	2020-09-15 21:44:11	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:44:15	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:44:15	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:44:15	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:44:16	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3618007368; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 21:44:16	MarkDuplicates	Marking 268312 records as duplicates.
INFO	2020-09-15 21:44:16	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:44:16	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:44:38	MarkDuplicates	Before output close freeMemory: 10769160200; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 21:44:38	MarkDuplicates	After output close freeMemory: 12857582360; totalMemory: 12958302208; maxMemory: 28631367680
[Tue Sep 15 21:44:38 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.64 minutes.
Runtime.totalMemory()=12958302208
INFO	2020-09-15 21:44:39	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG_DM.bam
**********


21:44:39.383 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:44:39 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:44:39 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:44:46	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103b_NM_sorted_RG_DM.bai
[Tue Sep 15 21:44:46 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.11 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226364m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103c_NM_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103c_NM_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103c_NM_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103c_NM_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.538 seconds.
Analyzed Index:   	3.017 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	0.535 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	928	(103005 bases)

Mapping:          	2.255 seconds.
Reads/sec:       	411.53
kBases/sec:      	45.68


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 12.2845% 	       57 	 11.6460% 	       11996
bad pairs:       	  0.0000% 	        0 	  0.0000% 	           0
insert size avg: 	  179.58


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.3534% 	      229 	 48.2080% 	       24131
unambiguous:     	 32.5431% 	      151 	 33.6723% 	       16855
ambiguous:       	 16.8103% 	       78 	 14.5357% 	        7276
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  4.9569% 	       23 	  3.0346% 	        1519
semiperfect site:	 10.9914% 	       51 	  8.7762% 	        4393
rescued:         	  1.2931% 	        6

Match Rate:      	      NA 	       NA 	 88.7178% 	       21546
Error Rate:      	 73.3591% 	      190 	  5.5505% 	        1348
Sub Rate:        	 70.6564% 	      183 	  4.5417% 	        1103
Del Rate:        	  9.6525% 	       25 	  0.6382% 	         155
Ins Rate:        	 12.7413% 	       33 	  0.3706% 	          90
N Rate:          	 31.6602% 	       82 	  5.7317% 	        1392


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 24.7845% 	      115 	 21.5679% 	       11420
unambiguous:     	 16.5948% 	       77 	 14.9219% 	        7901
ambiguous:       	  8.1897% 	       38 	  6.6460% 	        3519
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  2.5862% 	       12 	  1.3334% 	         706
semiperfect site:	  5.8190% 	       27 	  3.9623% 	        2098
rescued:         	  3.2328% 	       15

Match Rate:      	      NA 	       NA 	 87.7856% 	       10105
Error Rate:      	 56.1404% 	       96 	  6.4981% 	         748
Sub Rate:        	 54.3860% 	       93 	  5.4817% 	         631
Del Rate:        	  5.8480% 	       10 	  0.7905% 	          91
Ins Rate:        	  8.1871% 	       14 	  0.2259% 	          26
N Rate:          	 19.2982% 	       33 	  5.7163% 	         658

Total time:     	6.752 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:44:54	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG.bam -RGID 1 -RGLB 103c_NM -RGPL illumina -RGPU combined_runs -RGSM 103c_NM
**********


21:44:54.348 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:44:54 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG.bam RGID=1 RGLB=103c_NM RGPL=illumina RGPU=combined_runs RGSM=103c_NM    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:44:54 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:44:54	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=103c_NM SM=103c_NM

[Tue Sep 15 21:44:54 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=2058354688
INFO	2020-09-15 21:44:55	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:44:55.681 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:44:55 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:44:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:44:55	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:44:55	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:44:55	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:44:58	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1107:17684:39170 1:N:0:CTGCGTTG+CGACACTT. Cause: String 'CTGCGTTG+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 21:44:58	MarkDuplicates	Read 574 records. 0 pairs never matched.
INFO	2020-09-15 21:44:58	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1209565288; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:44:58	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:45:02	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:45:02	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:45:02	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:45:03	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2566695768; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 21:45:03	MarkDuplicates	Marking 6 records as duplicates.
INFO	2020-09-15 21:45:03	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:45:03	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:45:03	MarkDuplicates	Before output close freeMemory: 9717382624; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 21:45:03	MarkDuplicates	After output close freeMemory: 9717458640; totalMemory: 9753853952; maxMemory: 28631367680
[Tue Sep 15 21:45:03 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=9753853952
INFO	2020-09-15 21:45:04	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG_DM.bam
**********


21:45:05.068 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:45:05 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:45:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:45:07	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103c_NM_sorted_RG_DM.bai
[Tue Sep 15 21:45:07 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.04 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226311m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103d_NM_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103d_NM_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103d_NM_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103d_NM_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.511 seconds.
Analyzed Index:   	2.950 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.560 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	5320880	(448742494 bases)

Mapping:          	162.299 seconds.
Reads/sec:       	32784.49
kBases/sec:      	2764.92


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.6770% 	   683122 	 25.6692% 	   115188536
bad pairs:       	  0.0085% 	      226 	  0.0078% 	       34782
insert size avg: 	  367.10


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.5687% 	  1478372 	 54.3907% 	   121776724
unambiguous:     	 38.4397% 	  1022665 	 39.2743% 	    87932171
ambiguous:       	 17.1290% 	   455707 	 15.1164% 	    33844553
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.1889% 	   350884 	  9.9997% 	    22388515
semiperfect site:	 19.1381% 	   509157 	 16.1359% 	    36127130
rescued:         	  3.3409% 	    88883

Match Rate:      	      NA 	       NA 	 92.9761% 	   113899787
Error Rate:      	 56.0242% 	  1062144 	  4.3423% 	     5319543
Sub Rate:        	 55.1907% 	  1046341 	  3.5451% 	     4342903
Del Rate:        	  5.6921% 	   107914 	  0.5940% 	      727620
Ins Rate:        	  4.4684% 	    84714 	  0.2033% 	      249020
N Rate:          	 12.6217% 	   239291 	  2.6815% 	     3285014


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.5065% 	  1290487 	 47.9466% 	   107807898
unambiguous:     	 35.1997% 	   936467 	 36.0202% 	    80991491
ambiguous:       	 13.3068% 	   354020 	 11.9264% 	    26816407
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.7424% 	   259191 	  7.6007% 	    17090083
semiperfect site:	 15.1193% 	   402239 	 13.0036% 	    29238658
rescued:         	  4.0578% 	   107956

Match Rate:      	      NA 	       NA 	 92.2966% 	   100161381
Error Rate:      	 51.3757% 	   967019 	  4.6938% 	     5093716
Sub Rate:        	 50.5595% 	   951656 	  3.8097% 	     4134317
Del Rate:        	  5.5403% 	   104282 	  0.6573% 	      713327
Ins Rate:        	  4.3970% 	    82762 	  0.2268% 	      246072
N Rate:          	 12.6771% 	   238615 	  3.0097% 	     3266128

Total time:     	166.729 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:48:25	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG.bam -RGID 1 -RGLB 103d_NM -RGPL illumina -RGPU combined_runs -RGSM 103d_NM
**********


21:48:25.403 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:48:25 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG.bam RGID=1 RGLB=103d_NM RGPL=illumina RGPU=combined_runs RGSM=103d_NM    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:48:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:48:25	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=103d_NM SM=103d_NM

INFO	2020-09-15 21:48:34	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|13655:1
INFO	2020-09-15 21:48:43	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|22987:51
INFO	2020-09-15 21:48:52	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    8s.  Last read position: lcl|40169:132
INFO	2020-09-15 21:49:01	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|41583:78
INFO	2020-09-15 21:49:12	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:46s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 21:49:14 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.82 minutes.
Runtime.totalMemory()=2315780096
INFO	2020-09-15 21:49:20	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:49:20.512 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:49:20 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:49:20 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:49:20	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:49:20	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:49:20	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:49:23	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1109:14713:4268 1:N:0:TGAGGTGT+CGACACTT. Cause: String 'TGAGGTGT+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 21:49:29	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|13655:1
INFO	2020-09-15 21:49:29	MarkDuplicates	Tracking 211 as yet unmatched pairs. 202 records in RAM.
INFO	2020-09-15 21:49:34	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|22987:51
INFO	2020-09-15 21:49:34	MarkDuplicates	Tracking 1633 as yet unmatched pairs. 1616 records in RAM.
INFO	2020-09-15 21:49:41	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    6s.  Last read position: lcl|40169:132
INFO	2020-09-15 21:49:41	MarkDuplicates	Tracking 59 as yet unmatched pairs. 53 records in RAM.
INFO	2020-09-15 21:49:45	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    3s.  Last read position: lcl|41583:78
INFO	2020-09-15 21:49:45	MarkDuplicates	Tracking 312 as yet unmatched pairs. 283 records in RAM.
INFO	2020-09-15 21:49:46	MarkDuplicates	Read 4171022 records. 0 pairs never matched.
INFO	2020-09-15 21:49:51	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4681389016; totalMemory: 5854199808; maxMemory: 28631367680
INFO	2020-09-15 21:49:51	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:49:55	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:49:55	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:49:56	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:49:57	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5837617728; totalMemory: 13091471360; maxMemory: 28631367680
INFO	2020-09-15 21:49:57	MarkDuplicates	Marking 1380611 records as duplicates.
INFO	2020-09-15 21:49:57	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:49:57	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:50:48	MarkDuplicates	Before output close freeMemory: 15518662360; totalMemory: 15672541184; maxMemory: 28631367680
INFO	2020-09-15 21:50:48	MarkDuplicates	After output close freeMemory: 15335685848; totalMemory: 15489564672; maxMemory: 28631367680
[Tue Sep 15 21:50:48 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.46 minutes.
Runtime.totalMemory()=15489564672
INFO	2020-09-15 21:50:49	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG_DM.bam
**********


21:50:49.539 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:50:49 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:50:49 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:51:05	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103d_NM_sorted_RG_DM.bai
[Tue Sep 15 21:51:05 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.27 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226337m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103e_NM_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103e_NM_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103e_NM_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/103e_NM_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.518 seconds.
Analyzed Index:   	2.628 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.789 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4355770	(374007321 bases)

Mapping:          	153.412 seconds.
Reads/sec:       	28392.56
kBases/sec:      	2437.92


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 20.1711% 	   439303 	 19.7730% 	    73952624
bad pairs:       	  0.0143% 	      311 	  0.0119% 	       44530
insert size avg: 	  388.87


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.0217% 	  1089416 	 48.3589% 	    90303349
unambiguous:     	 34.3750% 	   748649 	 34.8293% 	    65038876
ambiguous:       	 15.6467% 	   340767 	 13.5295% 	    25264473
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.0711% 	   241115 	  8.4148% 	    15713530
semiperfect site:	 16.2239% 	   353337 	 13.6579% 	    25504191
rescued:         	  2.8587% 	    62259

Match Rate:      	      NA 	       NA 	 92.1082% 	    83930365
Error Rate:      	 57.0978% 	   801302 	  4.7175% 	     4298701
Sub Rate:        	 54.8396% 	   769610 	  3.5104% 	     3198688
Del Rate:        	  6.9421% 	    97425 	  0.8979% 	      818148
Ins Rate:        	  7.8047% 	   109530 	  0.3093% 	      281865
N Rate:          	 13.8192% 	   193936 	  3.1743% 	     2892431


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 43.3331% 	   943746 	 42.1534% 	    78941267
unambiguous:     	 31.3134% 	   681970 	 31.6549% 	    59280599
ambiguous:       	 12.0197% 	   261776 	 10.4985% 	    19660668
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.0447% 	   175205 	  6.2768% 	    11754559
semiperfect site:	 12.8616% 	   280110 	 11.0123% 	    20622900
rescued:         	  3.5027% 	    76285

Match Rate:      	      NA 	       NA 	 91.1301% 	    72685398
Error Rate:      	 51.5667% 	   717015 	  5.1922% 	     4141327
Sub Rate:        	 49.5209% 	   688569 	  3.8187% 	     3045791
Del Rate:        	  6.7985% 	    94530 	  1.0265% 	      818764
Ins Rate:        	  7.6247% 	   106019 	  0.3470% 	      276772
N Rate:          	 14.7201% 	   204677 	  3.6777% 	     2933306

Total time:     	157.749 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:54:09	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG.bam -RGID 1 -RGLB 103e_NM -RGPL illumina -RGPU combined_runs -RGSM 103e_NM
**********


21:54:09.855 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:54:09 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG.bam RGID=1 RGLB=103e_NM RGPL=illumina RGPU=combined_runs RGSM=103e_NM    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:54:09 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:54:10	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=103e_NM SM=103e_NM

INFO	2020-09-15 21:54:19	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|6363:78
INFO	2020-09-15 21:54:29	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|28698:19
INFO	2020-09-15 21:54:38	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: lcl|46021:5
INFO	2020-09-15 21:54:49	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:39s.  Time for last 1,000,000:   11s.  Last read position: */*
[Tue Sep 15 21:54:52 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.70 minutes.
Runtime.totalMemory()=3426222080
INFO	2020-09-15 21:54:57	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:54:57.574 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:54:57 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:54:57 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:54:57	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:54:57	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:54:57	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:55:00	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1104:4899:57777 1:N:0:GATCCATG+CGACACTT. Cause: String 'GATCCATG+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 21:55:07	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|6363:78
INFO	2020-09-15 21:55:07	MarkDuplicates	Tracking 326 as yet unmatched pairs. 323 records in RAM.
INFO	2020-09-15 21:55:11	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|28698:19
INFO	2020-09-15 21:55:11	MarkDuplicates	Tracking 12 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 21:55:16	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|46021:5
INFO	2020-09-15 21:55:16	MarkDuplicates	Tracking 120 as yet unmatched pairs. 119 records in RAM.
INFO	2020-09-15 21:55:18	MarkDuplicates	Read 3187096 records. 0 pairs never matched.
INFO	2020-09-15 21:55:21	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4749164272; totalMemory: 5852102656; maxMemory: 28631367680
INFO	2020-09-15 21:55:21	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:55:25	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	Large duplicate set. size = 1542
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	Large duplicate set. size = 1363
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	Large duplicate set. size = 2724
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	Large duplicate set. size = 2504
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:55:25	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:55:25	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:55:26	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:55:27	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5794384416; totalMemory: 13049004032; maxMemory: 28631367680
INFO	2020-09-15 21:55:27	MarkDuplicates	Marking 1068172 records as duplicates.
INFO	2020-09-15 21:55:27	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:55:27	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 21:56:10	MarkDuplicates	Before output close freeMemory: 17168747736; totalMemory: 17355505664; maxMemory: 28631367680
INFO	2020-09-15 21:56:10	MarkDuplicates	After output close freeMemory: 17028238552; totalMemory: 17214996480; maxMemory: 28631367680
[Tue Sep 15 21:56:10 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.22 minutes.
Runtime.totalMemory()=17214996480
INFO	2020-09-15 21:56:11	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG_DM.bam
**********


21:56:11.651 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:56:11 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:56:11 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:56:23	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/103e_NM_sorted_RG_DM.bai
[Tue Sep 15 21:56:23 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.20 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226339m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_1_MT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_1_MT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_1_MT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_1_MT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.562 seconds.
Analyzed Index:   	2.871 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.455 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3671914	(308997253 bases)

Mapping:          	119.301 seconds.
Reads/sec:       	30778.51
kBases/sec:      	2590.06


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.7015% 	   471869 	 25.6243% 	    79178402
bad pairs:       	  0.0088% 	      162 	  0.0082% 	       25360
insert size avg: 	  432.26


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.7489% 	  1041885 	 55.6039% 	    85914642
unambiguous:     	 37.2475% 	   683849 	 38.0390% 	    58774775
ambiguous:       	 19.5013% 	   358036 	 17.5649% 	    27139867
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.9197% 	   255560 	 10.6233% 	    16414268
semiperfect site:	 21.3234% 	   391489 	 18.4070% 	    28440949
rescued:         	  3.0405% 	    55822

Match Rate:      	      NA 	       NA 	 93.5319% 	    80797249
Error Rate:      	 54.8911% 	   737680 	  3.6756% 	     3175133
Sub Rate:        	 53.9767% 	   725392 	  2.9382% 	     2538187
Del Rate:        	  4.9528% 	    66560 	  0.5442% 	      470086
Ins Rate:        	  4.2726% 	    57420 	  0.1932% 	      166860
N Rate:          	 12.7585% 	   171461 	  2.7926% 	     2412346


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.2867% 	   904883 	 48.8466% 	    75460832
unambiguous:     	 33.9275% 	   622894 	 34.7921% 	    53748738
ambiguous:       	 15.3592% 	   281989 	 14.0545% 	    21712094
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.7236% 	   196880 	  8.4138% 	    12998134
semiperfect site:	 17.2826% 	   317301 	 15.1743% 	    23442095
rescued:         	  3.8102% 	    69953

Match Rate:      	      NA 	       NA 	 92.8759% 	    70522856
Error Rate:      	 49.3739% 	   660480 	  4.0121% 	     3046504
Sub Rate:        	 48.5060% 	   648870 	  3.1756% 	     2411304
Del Rate:        	  4.8569% 	    64971 	  0.6210% 	      471506
Ins Rate:        	  4.1649% 	    55714 	  0.2156% 	      163694
N Rate:          	 12.5715% 	   168170 	  3.1120% 	     2362978

Total time:     	124.604 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 21:58:49	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG.bam -RGID 1 -RGLB 187_1_MT -RGPL illumina -RGPU combined_runs -RGSM 187_1_MT
**********


21:58:49.905 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:58:49 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG.bam RGID=1 RGLB=187_1_MT RGPL=illumina RGPU=combined_runs RGSM=187_1_MT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:58:49 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:58:50	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=187_1_MT SM=187_1_MT

INFO	2020-09-15 21:58:59	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|10498:23
INFO	2020-09-15 21:59:08	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|35925:56
INFO	2020-09-15 21:59:18	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 21:59:24 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.57 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 21:59:28	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


21:59:28.531 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 21:59:28 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 21:59:28 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 21:59:28	MarkDuplicates	Start of doWork freeMemory: 2037938080; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 21:59:28	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 21:59:28	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 21:59:30	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1203:8938:54628 1:N:0:GCCTATCA+CGACACTT. Cause: String 'GCCTATCA+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 21:59:37	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|10498:23
INFO	2020-09-15 21:59:37	MarkDuplicates	Tracking 10 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-15 21:59:41	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|35925:56
INFO	2020-09-15 21:59:41	MarkDuplicates	Tracking 28 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 21:59:46	MarkDuplicates	Read 2949474 records. 0 pairs never matched.
INFO	2020-09-15 21:59:49	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4737891960; totalMemory: 5836898304; maxMemory: 28631367680
INFO	2020-09-15 21:59:49	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 21:59:53	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	Large duplicate set. size = 4228
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	Large duplicate set. size = 3314
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 21:59:53	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 21:59:54	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 21:59:55	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5762760448; totalMemory: 13016498176; maxMemory: 28631367680
INFO	2020-09-15 21:59:55	MarkDuplicates	Marking 878861 records as duplicates.
INFO	2020-09-15 21:59:55	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 21:59:55	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:00:30	MarkDuplicates	Before output close freeMemory: 12935035368; totalMemory: 13037469696; maxMemory: 28631367680
INFO	2020-09-15 22:00:31	MarkDuplicates	After output close freeMemory: 17095361880; totalMemory: 17281056768; maxMemory: 28631367680
[Tue Sep 15 22:00:31 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.04 minutes.
Runtime.totalMemory()=17281056768
INFO	2020-09-15 22:00:32	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG_DM.bam
**********


22:00:32.278 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:00:32 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:00:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:00:43	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_1_MT_sorted_RG_DM.bai
[Tue Sep 15 22:00:43 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.20 minutes.
Runtime.totalMemory()=5745147904
java -ea -Xmx226387m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_2_MT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_2_MT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_2_MT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_2_MT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.553 seconds.
Analyzed Index:   	3.406 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.539 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3756650	(300270513 bases)

Mapping:          	129.957 seconds.
Reads/sec:       	28906.76
kBases/sec:      	2310.53


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 24.5223% 	   460609 	 24.5344% 	    73669572
bad pairs:       	  0.0067% 	      125 	  0.0063% 	       19006
insert size avg: 	  553.39


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 58.5793% 	  1100310 	 57.1081% 	    85736740
unambiguous:     	 37.7675% 	   709396 	 38.7264% 	    58140209
ambiguous:       	 20.8118% 	   390914 	 18.3817% 	    27596531
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 15.6290% 	   293564 	 12.0140% 	    18036764
semiperfect site:	 22.0114% 	   413446 	 18.7913% 	    28211508
rescued:         	  3.2438% 	    60929

Match Rate:      	      NA 	       NA 	 93.7871% 	    80844025
Error Rate:      	 52.5580% 	   763467 	  3.8220% 	     3294568
Sub Rate:        	 51.7599% 	   751874 	  3.1082% 	     2679279
Del Rate:        	  4.4303% 	    64356 	  0.5368% 	      462761
Ins Rate:        	  3.8285% 	    55613 	  0.1769% 	      152528
N Rate:          	 10.7851% 	   156666 	  2.3909% 	     2060908


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.1257% 	   941524 	 49.6353% 	    74522384
unambiguous:     	 34.2090% 	   642557 	 35.2990% 	    52997898
ambiguous:       	 15.9167% 	   298967 	 14.3363% 	    21524486
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.5478% 	   216906 	  9.1771% 	    13778433
semiperfect site:	 17.2702% 	   324390 	 15.1068% 	    22681392
rescued:         	  3.9159% 	    73553

Match Rate:      	      NA 	       NA 	 93.0788% 	    69798234
Error Rate:      	 47.1772% 	   681870 	  4.1919% 	     3143461
Sub Rate:        	 46.4228% 	   670966 	  3.3693% 	     2526565
Del Rate:        	  4.2934% 	    62054 	  0.6214% 	      465963
Ins Rate:        	  3.8092% 	    55056 	  0.2013% 	      150933
N Rate:          	 10.7244% 	   155004 	  2.7293% 	     2046652

Total time:     	134.868 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:03:20	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG.bam -RGID 1 -RGLB 187_2_MT -RGPL illumina -RGPU combined_runs -RGSM 187_2_MT
**********


22:03:21.244 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:03:21 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG.bam RGID=1 RGLB=187_2_MT RGPL=illumina RGPU=combined_runs RGSM=187_2_MT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:03:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:03:21	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=187_2_MT SM=187_2_MT

INFO	2020-09-15 22:03:30	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|11085:33
INFO	2020-09-15 22:03:39	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|32097:1
INFO	2020-09-15 22:03:48	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|45665:205
[Tue Sep 15 22:03:55 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.57 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 22:03:59	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:03:59.708 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:03:59 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:03:59 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:03:59	MarkDuplicates	Start of doWork freeMemory: 2037938080; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:03:59	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:03:59	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:04:02	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2101:3117:21321 1:N:0:AACAACCG+CGACACTT. Cause: String 'AACAACCG+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:04:08	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|11085:33
INFO	2020-09-15 22:04:08	MarkDuplicates	Tracking 68 as yet unmatched pairs. 64 records in RAM.
INFO	2020-09-15 22:04:13	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|32097:1
INFO	2020-09-15 22:04:13	MarkDuplicates	Tracking 15 as yet unmatched pairs. 7 records in RAM.
INFO	2020-09-15 22:04:19	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    6s.  Last read position: lcl|45665:205
INFO	2020-09-15 22:04:19	MarkDuplicates	Tracking 25 as yet unmatched pairs. 14 records in RAM.
INFO	2020-09-15 22:04:22	MarkDuplicates	Read 3162200 records. 0 pairs never matched.
INFO	2020-09-15 22:04:26	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4750272968; totalMemory: 5855772672; maxMemory: 28631367680
INFO	2020-09-15 22:04:26	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:04:29	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:04:30	OpticalDuplicateFinder	Large duplicate set. size = 2511
INFO	2020-09-15 22:04:30	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:04:30	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:04:30	OpticalDuplicateFinder	Large duplicate set. size = 1768
INFO	2020-09-15 22:04:30	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:04:30	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:04:30	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:04:31	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5793362912; totalMemory: 13048479744; maxMemory: 28631367680
INFO	2020-09-15 22:04:31	MarkDuplicates	Marking 938666 records as duplicates.
INFO	2020-09-15 22:04:31	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:04:31	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:05:07	MarkDuplicates	Before output close freeMemory: 17163825248; totalMemory: 17351835648; maxMemory: 28631367680
INFO	2020-09-15 22:05:07	MarkDuplicates	After output close freeMemory: 17020694624; totalMemory: 17208705024; maxMemory: 28631367680
[Tue Sep 15 22:05:07 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.14 minutes.
Runtime.totalMemory()=17208705024
INFO	2020-09-15 22:05:08	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG_DM.bam
**********


22:05:09.149 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:05:09 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:05:09 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:05:20	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_2_MT_sorted_RG_DM.bai
[Tue Sep 15 22:05:20 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=5745672192
java -ea -Xmx226211m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_3_MT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_3_MT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_3_MT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_3_MT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.539 seconds.
Analyzed Index:   	3.285 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	1.207 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4953266	(398878180 bases)

Mapping:          	176.941 seconds.
Reads/sec:       	27993.91
kBases/sec:      	2254.30


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 24.3233% 	   602399 	 24.0784% 	    96043516
bad pairs:       	  0.0117% 	      291 	  0.0092% 	       36668
insert size avg: 	  489.09


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 58.7566% 	  1455186 	 58.1526% 	   115963695
unambiguous:     	 38.2229% 	   946640 	 39.6737% 	    79114360
ambiguous:       	 20.5338% 	   508546 	 18.4789% 	    36849335
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.4023% 	   356692 	 10.9554% 	    21846534
semiperfect site:	 20.7635% 	   514236 	 17.5890% 	    35074789
rescued:         	  3.4374% 	    85132

Match Rate:      	      NA 	       NA 	 93.5267% 	   109135969
Error Rate:      	 54.3363% 	  1040821 	  4.1836% 	     4881857
Sub Rate:        	 53.4941% 	  1024689 	  3.3765% 	     3940062
Del Rate:        	  5.1453% 	    98560 	  0.6221% 	      725918
Ins Rate:        	  4.2339% 	    81101 	  0.1850% 	      215877
N Rate:          	 11.1038% 	   212696 	  2.2897% 	     2671787


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.2691% 	  1244980 	 50.0548% 	    99842044
unambiguous:     	 34.4301% 	   852706 	 35.7572% 	    71323132
ambiguous:       	 15.8390% 	   392274 	 14.2977% 	    28518912
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.8928% 	   269774 	  8.4711% 	    16896943
semiperfect site:	 16.3817% 	   405714 	 14.0019% 	    27928858
rescued:         	  4.0579% 	   100500

Match Rate:      	      NA 	       NA 	 92.8413% 	    93353298
Error Rate:      	 48.5193% 	   920559 	  4.5847% 	     4609942
Sub Rate:        	 47.7120% 	   905243 	  3.6742% 	     3694436
Del Rate:        	  4.8938% 	    92850 	  0.7055% 	      709400
Ins Rate:        	  4.0971% 	    77734 	  0.2050% 	      206106
N Rate:          	 10.9136% 	   207065 	  2.5740% 	     2588204

Total time:     	182.385 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:08:51	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG.bam -RGID 1 -RGLB 187_3_MT -RGPL illumina -RGPU combined_runs -RGSM 187_3_MT
**********


22:08:51.423 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:08:51 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG.bam RGID=1 RGLB=187_3_MT RGPL=illumina RGPU=combined_runs RGSM=187_3_MT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:08:51 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:08:51	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=187_3_MT SM=187_3_MT

INFO	2020-09-15 22:09:00	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|13655:1
INFO	2020-09-15 22:09:09	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    9s.  Last read position: lcl|23709:467
INFO	2020-09-15 22:09:19	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|37495:94
INFO	2020-09-15 22:09:28	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|46384:1
[Tue Sep 15 22:09:37 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.76 minutes.
Runtime.totalMemory()=3426222080
INFO	2020-09-15 22:09:42	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:09:43.108 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:09:43 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:09:43 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:09:43	MarkDuplicates	Start of doWork freeMemory: 2037938080; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:09:43	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:09:43	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:09:45	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1102:6922:15344 1:N:0:ACTCGTTG+CGACACTT. Cause: String 'ACTCGTTG+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:09:50	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|13655:1
INFO	2020-09-15 22:09:50	MarkDuplicates	Tracking 41 as yet unmatched pairs. 27 records in RAM.
INFO	2020-09-15 22:09:55	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    4s.  Last read position: lcl|23709:467
INFO	2020-09-15 22:09:55	MarkDuplicates	Tracking 1168 as yet unmatched pairs. 1100 records in RAM.
INFO	2020-09-15 22:10:00	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:14s.  Time for last 1,000,000:    5s.  Last read position: lcl|37495:94
INFO	2020-09-15 22:10:00	MarkDuplicates	Tracking 248 as yet unmatched pairs. 228 records in RAM.
INFO	2020-09-15 22:10:05	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    4s.  Last read position: lcl|46384:1
INFO	2020-09-15 22:10:05	MarkDuplicates	Tracking 251 as yet unmatched pairs. 97 records in RAM.
INFO	2020-09-15 22:10:05	MarkDuplicates	Read 4194952 records. 0 pairs never matched.
INFO	2020-09-15 22:10:11	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4692054696; totalMemory: 5854724096; maxMemory: 28631367680
INFO	2020-09-15 22:10:11	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:10:15	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	Large duplicate set. size = 1212
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	Large duplicate set. size = 1132
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	Large duplicate set. size = 2567
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	Large duplicate set. size = 2289
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:10:15	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:10:15	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:10:16	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:10:17	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5830988328; totalMemory: 13085704192; maxMemory: 28631367680
INFO	2020-09-15 22:10:17	MarkDuplicates	Marking 1313212 records as duplicates.
INFO	2020-09-15 22:10:17	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:10:17	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:11:05	MarkDuplicates	Before output close freeMemory: 17197345032; totalMemory: 17384865792; maxMemory: 28631367680
INFO	2020-09-15 22:11:05	MarkDuplicates	After output close freeMemory: 17020135688; totalMemory: 17207656448; maxMemory: 28631367680
[Tue Sep 15 22:11:05 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.37 minutes.
Runtime.totalMemory()=17207656448
INFO	2020-09-15 22:11:06	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG_DM.bam
**********


22:11:06.660 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:11:06 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:11:06 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:11:20	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_3_MT_sorted_RG_DM.bai
[Tue Sep 15 22:11:20 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.23 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226286m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_4_MT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_4_MT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_4_MT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_4_MT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.549 seconds.
Analyzed Index:   	2.881 seconds.
Started output stream:	0.030 seconds.
Cleared Memory:    	1.374 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3622110	(350485898 bases)

Mapping:          	148.032 seconds.
Reads/sec:       	24468.50
kBases/sec:      	2367.64


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 23.0862% 	   418103 	 22.9842% 	    80556236
bad pairs:       	  0.0098% 	      178 	  0.0095% 	       33368
insert size avg: 	  334.58


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 53.9530% 	   977118 	 53.0730% 	    92873990
unambiguous:     	 38.1537% 	   690984 	 38.4536% 	    67291153
ambiguous:       	 15.7993% 	   286134 	 14.6193% 	    25582837
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.7614% 	   140564 	  6.0799% 	    10639328
semiperfect site:	 14.2908% 	   258814 	 12.5274% 	    21922104
rescued:         	  2.9090% 	    52683

Match Rate:      	      NA 	       NA 	 92.2209% 	    86339013
Error Rate:      	 62.7983% 	   792770 	  4.6721% 	     4374104
Sub Rate:        	 61.8791% 	   781166 	  3.5826% 	     3354063
Del Rate:        	  7.5566% 	    95395 	  0.7989% 	      747972
Ins Rate:        	  6.8734% 	    86770 	  0.2906% 	      272069
N Rate:          	 15.6994% 	   198190 	  3.1070% 	     2908845


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.7258% 	   864340 	 47.0507% 	    82570582
unambiguous:     	 34.8886% 	   631851 	 35.1176% 	    61628873
ambiguous:       	 12.8372% 	   232489 	 11.9331% 	    20941709
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.1107% 	   110669 	  4.8982% 	     8595993
semiperfect site:	 11.7585% 	   212952 	 10.3918% 	    18236797
rescued:         	  3.8475% 	    69681

Match Rate:      	      NA 	       NA 	 91.5749% 	    76316991
Error Rate:      	 56.8329% 	   711591 	  5.0736% 	     4228258
Sub Rate:        	 55.9862% 	   700989 	  3.8373% 	     3197963
Del Rate:        	  7.3103% 	    91531 	  0.9213% 	      767784
Ins Rate:        	  6.7006% 	    83897 	  0.3150% 	      262511
N Rate:          	 15.3084% 	   191673 	  3.3515% 	     2793117

Total time:     	153.247 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:14:18	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG.bam -RGID 1 -RGLB 187_4_MT -RGPL illumina -RGPU combined_runs -RGSM 187_4_MT
**********


22:14:18.286 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:14:18 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG.bam RGID=1 RGLB=187_4_MT RGPL=illumina RGPU=combined_runs RGSM=187_4_MT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:14:18 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:14:18	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=187_4_MT SM=187_4_MT

INFO	2020-09-15 22:14:28	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:   10s.  Last read position: lcl|16037:26
INFO	2020-09-15 22:14:39	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:   10s.  Last read position: lcl|39095:1
INFO	2020-09-15 22:14:50	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:31s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 22:14:55 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.63 minutes.
Runtime.totalMemory()=3508011008
INFO	2020-09-15 22:15:00	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:15:01.073 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:15:01 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:15:01 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:15:01	MarkDuplicates	Start of doWork freeMemory: 2037938080; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:15:01	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:15:01	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:15:03	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2101:7257:7549 1:N:0:CCTATGGT+CGACACTT. Cause: String 'CCTATGGT+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:15:09	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|16037:26
INFO	2020-09-15 22:15:09	MarkDuplicates	Tracking 42 as yet unmatched pairs. 31 records in RAM.
INFO	2020-09-15 22:15:14	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|39095:1
INFO	2020-09-15 22:15:14	MarkDuplicates	Tracking 39 as yet unmatched pairs. 10 records in RAM.
INFO	2020-09-15 22:15:19	MarkDuplicates	Read 2846354 records. 0 pairs never matched.
INFO	2020-09-15 22:15:24	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4744437624; totalMemory: 5831655424; maxMemory: 28631367680
INFO	2020-09-15 22:15:24	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:15:28	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:15:28	OpticalDuplicateFinder	Large duplicate set. size = 1274
INFO	2020-09-15 22:15:28	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:15:28	OpticalDuplicateFinder	Large duplicate set. size = 1213
INFO	2020-09-15 22:15:28	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:15:28	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:15:29	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:15:29	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5755661832; totalMemory: 13009158144; maxMemory: 28631367680
INFO	2020-09-15 22:15:29	MarkDuplicates	Marking 846436 records as duplicates.
INFO	2020-09-15 22:15:29	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:15:30	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:16:08	MarkDuplicates	Before output close freeMemory: 12926090216; totalMemory: 13028032512; maxMemory: 28631367680
INFO	2020-09-15 22:16:08	MarkDuplicates	After output close freeMemory: 17092416984; totalMemory: 17277386752; maxMemory: 28631367680
[Tue Sep 15 22:16:08 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.13 minutes.
Runtime.totalMemory()=17277386752
INFO	2020-09-15 22:16:09	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG_DM.bam
**********


22:16:10.013 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:16:10 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:16:10 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:16:21	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_4_MT_sorted_RG_DM.bai
[Tue Sep 15 22:16:21 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226362m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_5_MT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_5_MT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_5_MT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/187_5_MT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.528 seconds.
Analyzed Index:   	2.939 seconds.
Started output stream:	0.030 seconds.
Cleared Memory:    	0.528 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2522030	(175260904 bases)

Mapping:          	81.482 seconds.
Reads/sec:       	30951.82
kBases/sec:      	2150.90


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.4939% 	   283651 	 21.5876% 	    37834686
bad pairs:       	  0.0135% 	      170 	  0.0123% 	       21516
insert size avg: 	  588.22


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.9361% 	   705362 	 54.5051% 	    47773003
unambiguous:     	 35.1061% 	   442693 	 36.2384% 	    31762474
ambiguous:       	 20.8300% 	   262669 	 18.2667% 	    16010529
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 19.1052% 	   240920 	 15.4121% 	    13508534
semiperfect site:	 24.7782% 	   312457 	 21.1365% 	    18525881
rescued:         	  2.9511% 	    37214

Match Rate:      	      NA 	       NA 	 93.8541% 	    45111274
Error Rate:      	 47.3054% 	   432501 	  3.7595% 	     1807018
Sub Rate:        	 46.3857% 	   424093 	  2.9773% 	     1431055
Del Rate:        	  4.1392% 	    37844 	  0.6082% 	      292337
Ins Rate:        	  3.3539% 	    30664 	  0.1740% 	       83626
N Rate:          	 10.0574% 	    91952 	  2.3864% 	     1147048


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.4293% 	   598090 	 46.8449% 	    41041869
unambiguous:     	 31.6421% 	   399011 	 32.7962% 	    28733459
ambiguous:       	 15.7872% 	   199079 	 14.0487% 	    12308410
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.9297% 	   175655 	 11.4020% 	     9989500
semiperfect site:	 19.3558% 	   244080 	 16.7125% 	    14642172
rescued:         	  3.4820% 	    43908

Match Rate:      	      NA 	       NA 	 93.0027% 	    38444027
Error Rate:      	 42.7859% 	   389590 	  4.1996% 	     1735954
Sub Rate:        	 41.8985% 	   381510 	  3.2941% 	     1361683
Del Rate:        	  4.0302% 	    36697 	  0.7126% 	      294577
Ins Rate:        	  3.2862% 	    29923 	  0.1928% 	       79694
N Rate:          	 10.1952% 	    92833 	  2.7977% 	     1156465

Total time:     	85.890 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:18:00	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG.bam -RGID 1 -RGLB 187_5_MT -RGPL illumina -RGPU combined_runs -RGSM 187_5_MT
**********


22:18:00.374 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:18:00 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG.bam RGID=1 RGLB=187_5_MT RGPL=illumina RGPU=combined_runs RGSM=187_5_MT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:18:00 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:18:00	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=187_5_MT SM=187_5_MT

INFO	2020-09-15 22:18:08	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|26079:5
INFO	2020-09-15 22:18:17	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    8s.  Last read position: lcl|45565:24
[Tue Sep 15 22:18:21 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.36 minutes.
Runtime.totalMemory()=2483552256
INFO	2020-09-15 22:18:24	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:18:25.032 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:18:25 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:18:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:18:25	MarkDuplicates	Start of doWork freeMemory: 2037938208; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:18:25	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:18:25	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:18:27	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1113:19255:12759 1:N:0:TGTACACC+CGACACTT. Cause: String 'TGTACACC+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:18:34	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|26079:5
INFO	2020-09-15 22:18:34	MarkDuplicates	Tracking 11 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-15 22:18:39	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:12s.  Time for last 1,000,000:    5s.  Last read position: lcl|45565:24
INFO	2020-09-15 22:18:39	MarkDuplicates	Tracking 285 as yet unmatched pairs. 4 records in RAM.
INFO	2020-09-15 22:18:39	MarkDuplicates	Read 2039262 records. 0 pairs never matched.
INFO	2020-09-15 22:18:42	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2667562080; totalMemory: 3664248832; maxMemory: 28631367680
INFO	2020-09-15 22:18:42	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:18:46	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:18:46	OpticalDuplicateFinder	Large duplicate set. size = 1168
INFO	2020-09-15 22:18:46	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:18:47	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:18:47	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:18:48	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3647816248; totalMemory: 10859053056; maxMemory: 28631367680
INFO	2020-09-15 22:18:48	MarkDuplicates	Marking 598198 records as duplicates.
INFO	2020-09-15 22:18:48	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:18:48	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:19:10	MarkDuplicates	Before output close freeMemory: 12897703880; totalMemory: 12999720960; maxMemory: 28631367680
INFO	2020-09-15 22:19:10	MarkDuplicates	After output close freeMemory: 12787603400; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 22:19:10 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.76 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 22:19:11	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG_DM.bam
**********


22:19:11.873 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:19:11 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:19:11 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:19:20	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/187_5_MT_sorted_RG_DM.bai
[Tue Sep 15 22:19:20 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226211m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177a_ID_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177a_ID_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177a_ID_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177a_ID_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.518 seconds.
Analyzed Index:   	2.985 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.552 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	943282	(79776202 bases)

Mapping:          	39.230 seconds.
Reads/sec:       	24045.13
kBases/sec:      	2033.57


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 20.5875% 	    97099 	 20.2824% 	    16180534
bad pairs:       	  0.0085% 	       40 	  0.0072% 	        5732
insert size avg: 	  470.56


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 53.8840% 	   254139 	 52.6799% 	    21006251
unambiguous:     	 37.0483% 	   174735 	 37.8236% 	    15082271
ambiguous:       	 16.8357% 	    79404 	 14.8563% 	     5923980
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.0488% 	    56827 	  9.1993% 	     3668238
semiperfect site:	 17.6810% 	    83391 	 14.9270% 	     5952202
rescued:         	  2.8348% 	    13370

Match Rate:      	      NA 	       NA 	 92.8556% 	    19638025
Error Rate:      	 54.9901% 	   185878 	  4.3650% 	      923159
Sub Rate:        	 53.9682% 	   182424 	  3.4643% 	      732659
Del Rate:        	  6.1579% 	    20815 	  0.6749% 	      142742
Ins Rate:        	  5.0796% 	    17170 	  0.2258% 	       47758
N Rate:          	 13.0823% 	    44221 	  2.7794% 	      587809


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.1185% 	   222230 	 46.4093% 	    18517743
unambiguous:     	 33.7615% 	   159233 	 34.5108% 	    13770116
ambiguous:       	 13.3570% 	    62997 	 11.8985% 	     4747627
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.1273% 	    43048 	  7.1118% 	     2837660
semiperfect site:	 14.1905% 	    66928 	 12.1413% 	     4844476
rescued:         	  3.4087% 	    16077

Match Rate:      	      NA 	       NA 	 92.1603% 	    17195417
Error Rate:      	 49.9750% 	   167815 	  4.7199% 	      880641
Sub Rate:        	 49.0092% 	   164572 	  3.7194% 	      693966
Del Rate:        	  5.9622% 	    20021 	  0.7526% 	      140427
Ins Rate:        	  4.9801% 	    16723 	  0.2479% 	       46248
N Rate:          	 13.0590% 	    43852 	  3.1199% 	      582112

Total time:     	43.697 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:20:10	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG.bam -RGID 1 -RGLB 177a_ID -RGPL illumina -RGPU combined_runs -RGSM 177a_ID
**********


22:20:10.678 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:20:10 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG.bam RGID=1 RGLB=177a_ID RGPL=illumina RGPU=combined_runs RGSM=177a_ID    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:20:10 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:20:10	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=177a_ID SM=177a_ID

[Tue Sep 15 22:20:20 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.17 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 22:20:22	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:20:22.618 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:20:22 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:20:22 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:20:22	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:20:22	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:20:22	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:20:24	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1109:8951:95663 1:N:0:GTATGCTG+CGACACTT. Cause: String 'GTATGCTG+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:20:28	MarkDuplicates	Read 758460 records. 0 pairs never matched.
INFO	2020-09-15 22:20:30	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1694364072; totalMemory: 2595749888; maxMemory: 28631367680
INFO	2020-09-15 22:20:30	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:20:34	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:20:34	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:20:34	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:20:35	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2564796832; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 22:20:35	MarkDuplicates	Marking 201770 records as duplicates.
INFO	2020-09-15 22:20:35	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:20:35	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:20:45	MarkDuplicates	Before output close freeMemory: 10769792832; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 22:20:45	MarkDuplicates	After output close freeMemory: 10769792832; totalMemory: 10828644352; maxMemory: 28631367680
[Tue Sep 15 22:20:45 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.39 minutes.
Runtime.totalMemory()=10828644352
INFO	2020-09-15 22:20:46	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG_DM.bam
**********


22:20:47.055 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:20:47 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:20:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:20:51	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177a_ID_sorted_RG_DM.bai
[Tue Sep 15 22:20:51 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.08 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226281m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177b_ID_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177b_ID_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177b_ID_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177b_ID_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.052 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.525 seconds.
Analyzed Index:   	2.964 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	1.244 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2185758	(178291292 bases)

Mapping:          	89.275 seconds.
Reads/sec:       	24483.42
kBases/sec:      	1997.10


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.5450% 	   279176 	 25.0995% 	    44750282
bad pairs:       	  0.0160% 	      175 	  0.0144% 	       25656
insert size avg: 	  377.96


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.3373% 	   615698 	 54.9150% 	    48955926
unambiguous:     	 35.7354% 	   390545 	 36.8817% 	    32879522
ambiguous:       	 20.6018% 	   225153 	 18.0333% 	    16076404
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.0754% 	   131969 	  8.9461% 	     7975325
semiperfect site:	 18.4223% 	   201333 	 15.4515% 	    13774776
rescued:         	  3.6361% 	    39738

Match Rate:      	      NA 	       NA 	 92.0092% 	    45426994
Error Rate:      	 58.0528% 	   457065 	  4.3663% 	     2155722
Sub Rate:        	 53.9171% 	   424504 	  3.1437% 	     1552093
Del Rate:        	  6.2285% 	    49039 	  0.8432% 	      416291
Ins Rate:        	 10.0374% 	    79027 	  0.3794% 	      187338
N Rate:          	 14.6910% 	   115666 	  3.6245% 	     1789501


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.2398% 	   538131 	 48.4690% 	    43206611
unambiguous:     	 32.3913% 	   353998 	 33.5629% 	    29918909
ambiguous:       	 16.8484% 	   184133 	 14.9061% 	    13287702
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.9683% 	    98013 	  6.7528% 	     6019600
semiperfect site:	 14.7774% 	   161499 	 12.5860% 	    11219543
rescued:         	  4.5279% 	    49484

Match Rate:      	      NA 	       NA 	 91.2826% 	    39836105
Error Rate:      	 53.0285% 	   413524 	  4.8320% 	     2108725
Sub Rate:        	 49.2094% 	   383742 	  3.4224% 	     1493548
Del Rate:        	  6.0995% 	    47565 	  0.9940% 	      433791
Ins Rate:        	  9.8526% 	    76832 	  0.4156% 	      181386
N Rate:          	 14.3993% 	   112288 	  3.8853% 	     1695572

Total time:     	94.429 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:22:39	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG.bam -RGID 1 -RGLB 177b_ID -RGPL illumina -RGPU combined_runs -RGSM 177b_ID
**********


22:22:39.650 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:22:39 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG.bam RGID=1 RGLB=177b_ID RGPL=illumina RGPU=combined_runs RGSM=177b_ID    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:22:39 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:22:39	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=177b_ID SM=177b_ID

INFO	2020-09-15 22:22:49	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|30314:121
INFO	2020-09-15 22:22:59	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 22:23:00 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.35 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 22:23:03	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:23:03.905 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:23:03 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:23:03 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:23:04	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:23:04	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:23:04	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:23:06	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1114:17147:5968 1:N:0:TGATGTCC+CGACACTT. Cause: String 'TGATGTCC+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:23:13	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|30314:121
INFO	2020-09-15 22:23:13	MarkDuplicates	Tracking 411 as yet unmatched pairs. 401 records in RAM.
INFO	2020-09-15 22:23:18	MarkDuplicates	Read 1748956 records. 0 pairs never matched.
INFO	2020-09-15 22:23:20	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2680564200; totalMemory: 3665821696; maxMemory: 28631367680
INFO	2020-09-15 22:23:20	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:23:24	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:23:25	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:23:25	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:23:26	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3643320608; totalMemory: 10854334464; maxMemory: 28631367680
INFO	2020-09-15 22:23:26	MarkDuplicates	Marking 521169 records as duplicates.
INFO	2020-09-15 22:23:26	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:23:27	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:23:48	MarkDuplicates	Before output close freeMemory: 12893908328; totalMemory: 12995526656; maxMemory: 28631367680
INFO	2020-09-15 22:23:48	MarkDuplicates	After output close freeMemory: 12788002152; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 22:23:48 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.75 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 22:23:49	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG_DM.bam
**********


22:23:49.799 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:23:49 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:23:49 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:23:56	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177b_ID_sorted_RG_DM.bai
[Tue Sep 15 22:23:56 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.12 minutes.
Runtime.totalMemory()=5745672192
java -ea -Xmx226248m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_4_ID_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_4_ID_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_4_ID_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_4_ID_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.051 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.586 seconds.
Analyzed Index:   	3.233 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	1.279 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3494518	(287512075 bases)

Mapping:          	124.885 seconds.
Reads/sec:       	27981.86
kBases/sec:      	2302.21


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.7360% 	   467148 	 26.3566% 	    75778366
bad pairs:       	  0.0114% 	      200 	  0.0100% 	       28796
insert size avg: 	  381.53


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.5874% 	   988729 	 55.3422% 	    79599246
unambiguous:     	 36.3924% 	   635869 	 37.5818% 	    54054254
ambiguous:       	 20.1951% 	   352860 	 17.7604% 	    25544992
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.8248% 	   241555 	 10.7290% 	    15431550
semiperfect site:	 20.4771% 	   357788 	 17.6161% 	    25337400
rescued:         	  3.4210% 	    59773

Match Rate:      	      NA 	       NA 	 92.7286% 	    74248371
Error Rate:      	 55.6722% 	   701857 	  3.7926% 	     3036756
Sub Rate:        	 51.8025% 	   653072 	  2.9016% 	     2323363
Del Rate:        	  5.3676% 	    67669 	  0.5887% 	      471377
Ins Rate:        	  8.4660% 	   106730 	  0.3023% 	      242016
N Rate:          	 14.2385% 	   179504 	  3.4788% 	     2785496


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.3549% 	   862358 	 48.7820% 	    70090473
unambiguous:     	 33.0244% 	   577022 	 34.2395% 	    49195760
ambiguous:       	 16.3305% 	   285336 	 14.5424% 	    20894713
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.4313% 	   182261 	  8.3080% 	    11936973
semiperfect site:	 16.5100% 	   288472 	 14.4530% 	    20766201
rescued:         	  4.2247% 	    73816

Match Rate:      	      NA 	       NA 	 92.0862% 	    64978913
Error Rate:      	 50.7889% 	   635216 	  4.1729% 	     2944513
Sub Rate:        	 47.2950% 	   591518 	  3.1708% 	     2237399
Del Rate:        	  5.2339% 	    65460 	  0.6698% 	      472646
Ins Rate:        	  8.1320% 	   101707 	  0.3323% 	      234468
N Rate:          	 13.9384% 	   174328 	  3.7409% 	     2639693

Total time:     	130.416 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:26:27	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG.bam -RGID 1 -RGLB 177_4_ID -RGPL illumina -RGPU combined_runs -RGSM 177_4_ID
**********


22:26:27.302 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:26:27 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG.bam RGID=1 RGLB=177_4_ID RGPL=illumina RGPU=combined_runs RGSM=177_4_ID    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:26:27 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:26:27	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=177_4_ID SM=177_4_ID

INFO	2020-09-15 22:26:37	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|18296:60
INFO	2020-09-15 22:26:46	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|39785:38
INFO	2020-09-15 22:26:56	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 22:26:59 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.54 minutes.
Runtime.totalMemory()=2449473536
INFO	2020-09-15 22:27:03	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:27:04.230 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:27:04 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:27:04 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:27:04	MarkDuplicates	Start of doWork freeMemory: 2037938080; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:27:04	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:27:04	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:27:06	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1113:25450:23335 1:N:0:GTCCTTCT+CGACACTT. Cause: String 'GTCCTTCT+CGACACTT' did not start with a parsable number.
INFO	2020-09-15 22:27:12	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|18296:60
INFO	2020-09-15 22:27:12	MarkDuplicates	Tracking 107 as yet unmatched pairs. 93 records in RAM.
INFO	2020-09-15 22:27:16	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|39785:38
INFO	2020-09-15 22:27:16	MarkDuplicates	Tracking 158 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 22:27:23	MarkDuplicates	Read 2767478 records. 0 pairs never matched.
INFO	2020-09-15 22:27:27	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4752295416; totalMemory: 5843714048; maxMemory: 28631367680
INFO	2020-09-15 22:27:27	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:27:30	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	Large duplicate set. size = 5111
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	Large duplicate set. size = 3089
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:27:31	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:27:31	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:27:32	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5765179736; totalMemory: 13018595328; maxMemory: 28631367680
INFO	2020-09-15 22:27:32	MarkDuplicates	Marking 907349 records as duplicates.
INFO	2020-09-15 22:27:32	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:27:32	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:28:07	MarkDuplicates	Before output close freeMemory: 12932866760; totalMemory: 13034848256; maxMemory: 28631367680
INFO	2020-09-15 22:28:07	MarkDuplicates	After output close freeMemory: 17103199808; totalMemory: 17288396800; maxMemory: 28631367680
[Tue Sep 15 22:28:07 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.06 minutes.
Runtime.totalMemory()=17288396800
INFO	2020-09-15 22:28:08	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG_DM.bam
**********


22:28:08.879 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:28:08 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:28:08 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:28:19	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_4_ID_sorted_RG_DM.bai
[Tue Sep 15 22:28:19 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226145m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_5_ID_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_5_ID_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_5_ID_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/177_5_ID_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.044 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.525 seconds.
Analyzed Index:   	2.911 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.541 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3920864	(319670702 bases)

Mapping:          	119.541 seconds.
Reads/sec:       	32799.36
kBases/sec:      	2674.15


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.1760% 	   493559 	 25.0126% 	    79957998
bad pairs:       	  0.0116% 	      228 	  0.0099% 	       31550
insert size avg: 	  355.42


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.0957% 	  1060510 	 53.0315% 	    84649943
unambiguous:     	 36.3004% 	   711645 	 37.1541% 	    59306171
ambiguous:       	 17.7953% 	   348865 	 15.8774% 	    25343772
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.4884% 	   264430 	 10.4037% 	    16606548
semiperfect site:	 19.5384% 	   383037 	 16.6918% 	    26643855
rescued:         	  2.9465% 	    57764

Match Rate:      	      NA 	       NA 	 93.1728% 	    79400097
Error Rate:      	 55.4364% 	   748580 	  4.0363% 	     3439645
Sub Rate:        	 54.1281% 	   730913 	  3.1422% 	     2677749
Del Rate:        	  5.6198% 	    75887 	  0.6667% 	      568143
Ins Rate:        	  5.2107% 	    70362 	  0.2274% 	      193753
N Rate:          	 12.3759% 	   167117 	  2.7909% 	     2378344


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.5036% 	   931276 	 47.0204% 	    75255589
unambiguous:     	 33.3949% 	   654685 	 34.2357% 	    54793828
ambiguous:       	 14.1087% 	   276591 	 12.7847% 	    20461761
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.2241% 	   200437 	  8.0998% 	    12963587
semiperfect site:	 15.8378% 	   310489 	 13.7853% 	    22063192
rescued:         	  3.7016% 	    72568

Match Rate:      	      NA 	       NA 	 92.5062% 	    70131583
Error Rate:      	 50.8348% 	   682973 	  4.3782% 	     3319215
Sub Rate:        	 49.6101% 	   666520 	  3.3936% 	     2572763
Del Rate:        	  5.5247% 	    74225 	  0.7350% 	      557225
Ins Rate:        	  5.1134% 	    68700 	  0.2496% 	      189227
N Rate:          	 12.4478% 	   167238 	  3.1156% 	     2362016

Total time:     	123.928 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:30:45	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG.bam -RGID 1 -RGLB 177_5_ID -RGPL illumina -RGPU combined_runs -RGSM 177_5_ID
**********


22:30:46.043 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:30:46 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG.bam RGID=1 RGLB=177_5_ID RGPL=illumina RGPU=combined_runs RGSM=177_5_ID    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:30:46 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:30:46	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=177_5_ID SM=177_5_ID

INFO	2020-09-15 22:30:55	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    8s.  Last read position: lcl|12065:74
INFO	2020-09-15 22:31:04	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|35401:42
INFO	2020-09-15 22:31:13	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    8s.  Last read position: */*
[Tue Sep 15 22:31:21 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.60 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 22:31:26	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:31:26.440 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:31:26 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:31:26 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:31:26	MarkDuplicates	Start of doWork freeMemory: 2037938080; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:31:26	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:31:26	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:31:28	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2307:5296:37140 1:N:0:ACGTTACC+GACTTGTG. Cause: String 'ACGTTACC+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:31:34	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|12065:74
INFO	2020-09-15 22:31:34	MarkDuplicates	Tracking 181 as yet unmatched pairs. 168 records in RAM.
INFO	2020-09-15 22:31:39	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|35401:42
INFO	2020-09-15 22:31:39	MarkDuplicates	Tracking 42 as yet unmatched pairs. 25 records in RAM.
INFO	2020-09-15 22:31:46	MarkDuplicates	Read 2995998 records. 0 pairs never matched.
INFO	2020-09-15 22:31:49	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4754771096; totalMemory: 5858918400; maxMemory: 28631367680
INFO	2020-09-15 22:31:49	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:31:53	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:31:53	OpticalDuplicateFinder	Large duplicate set. size = 1812
INFO	2020-09-15 22:31:53	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:31:53	OpticalDuplicateFinder	Large duplicate set. size = 1596
INFO	2020-09-15 22:31:53	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:31:53	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:31:54	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:31:55	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5793023104; totalMemory: 13047955456; maxMemory: 28631367680
INFO	2020-09-15 22:31:55	MarkDuplicates	Marking 886319 records as duplicates.
INFO	2020-09-15 22:31:55	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:31:55	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:32:33	MarkDuplicates	Before output close freeMemory: 17162156432; totalMemory: 17348689920; maxMemory: 28631367680
INFO	2020-09-15 22:32:33	MarkDuplicates	After output close freeMemory: 17015880080; totalMemory: 17202413568; maxMemory: 28631367680
[Tue Sep 15 22:32:33 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.11 minutes.
Runtime.totalMemory()=17202413568
INFO	2020-09-15 22:32:34	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG_DM.bam
**********


22:32:34.446 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:32:34 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:32:34 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:32:45	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/177_5_ID_sorted_RG_DM.bai
[Tue Sep 15 22:32:45 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226274m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219b_BC_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219b_BC_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219b_BC_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219b_BC_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.559 seconds.
Analyzed Index:   	2.975 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.543 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2647952	(219246209 bases)

Mapping:          	89.680 seconds.
Reads/sec:       	29526.71
kBases/sec:      	2444.76


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.2255% 	   281020 	 21.0468% 	    46144226
bad pairs:       	  0.0099% 	      131 	  0.0082% 	       17942
insert size avg: 	  418.34


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.1781% 	   690826 	 51.2079% 	    56073561
unambiguous:     	 34.4901% 	   456641 	 35.3379% 	    38695670
ambiguous:       	 17.6880% 	   234185 	 15.8700% 	    17377891
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.1547% 	   160925 	  9.2014% 	    10075750
semiperfect site:	 18.3666% 	   243170 	 15.5910% 	    17072419
rescued:         	  2.7878% 	    36910

Match Rate:      	      NA 	       NA 	 92.9157% 	    52511164
Error Rate:      	 54.7772% 	   496569 	  4.2021% 	     2374828
Sub Rate:        	 53.7557% 	   487309 	  3.1676% 	     1790180
Del Rate:        	  5.8541% 	    53069 	  0.7809% 	      441312
Ins Rate:        	  5.2005% 	    47144 	  0.2536% 	      143336
N Rate:          	 12.9873% 	   117733 	  2.8822% 	     1628881


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.4097% 	   601214 	 44.8043% 	    49170251
unambiguous:     	 31.3681% 	   415306 	 32.0973% 	    35224952
ambiguous:       	 14.0416% 	   185908 	 12.7071% 	    13945299
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.3430% 	   123699 	  7.2279% 	     7932235
semiperfect site:	 14.8886% 	   197122 	 12.7666% 	    14010582
rescued:         	  3.5242% 	    46660

Match Rate:      	      NA 	       NA 	 92.2938% 	    45782913
Error Rate:      	 49.5597% 	   445636 	  4.6010% 	     2282340
Sub Rate:        	 48.6085% 	   437083 	  3.4454% 	     1709089
Del Rate:        	  5.6076% 	    50423 	  0.8776% 	      435359
Ins Rate:        	  5.0706% 	    45594 	  0.2780% 	      137892
N Rate:          	 12.5937% 	   113241 	  3.1052% 	     1540357

Total time:     	94.184 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:34:35	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG.bam -RGID 1 -RGLB 219b_BC -RGPL illumina -RGPU combined_runs -RGSM 219b_BC
**********


22:34:35.656 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:34:35 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG.bam RGID=1 RGLB=219b_BC RGPL=illumina RGPU=combined_runs RGSM=219b_BC    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:34:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:34:35	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=219b_BC SM=219b_BC

INFO	2020-09-15 22:34:45	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|18995:112
INFO	2020-09-15 22:34:54	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|46746:819
[Tue Sep 15 22:35:00 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.42 minutes.
Runtime.totalMemory()=2483552256
INFO	2020-09-15 22:35:04	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:35:04.276 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:35:04 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:35:04 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:35:04	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:35:04	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:35:04	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:35:06	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1114:1869:10898 1:N:0:CTGTGTTG+GACTTGTG. Cause: String 'CTGTGTTG+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:35:14	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    7s.  Last read position: lcl|18995:112
INFO	2020-09-15 22:35:14	MarkDuplicates	Tracking 6 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 22:35:18	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|46746:819
INFO	2020-09-15 22:35:18	MarkDuplicates	Tracking 82 as yet unmatched pairs. 80 records in RAM.
INFO	2020-09-15 22:35:18	MarkDuplicates	Read 2021778 records. 0 pairs never matched.
INFO	2020-09-15 22:35:22	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2667058256; totalMemory: 3662675968; maxMemory: 28631367680
INFO	2020-09-15 22:35:22	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:35:26	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:35:27	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:35:27	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:35:28	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3645219368; totalMemory: 10856431616; maxMemory: 28631367680
INFO	2020-09-15 22:35:28	MarkDuplicates	Marking 573325 records as duplicates.
INFO	2020-09-15 22:35:28	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:35:28	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:35:54	MarkDuplicates	Before output close freeMemory: 12787075792; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-15 22:35:55	MarkDuplicates	After output close freeMemory: 12890884816; totalMemory: 12993429504; maxMemory: 28631367680
[Tue Sep 15 22:35:55 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.85 minutes.
Runtime.totalMemory()=12993429504
INFO	2020-09-15 22:35:56	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG_DM.bam
**********


22:35:56.285 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:35:56 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:35:56 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:36:04	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219b_BC_sorted_RG_DM.bai
[Tue Sep 15 22:36:04 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.13 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226368m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219c_BC_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219c_BC_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219c_BC_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/219c_BC_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.508 seconds.
Analyzed Index:   	3.457 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.532 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	6835308	(542138833 bases)

Mapping:          	160.553 seconds.
Reads/sec:       	42573.63
kBases/sec:      	3376.70


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.8620% 	   918051 	 26.9328% 	   146013096
bad pairs:       	  0.0079% 	      269 	  0.0071% 	       38472
insert size avg: 	  268.36


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 46.5797% 	  1591933 	 46.0229% 	   124404653
unambiguous:     	 32.3913% 	  1107021 	 33.1642% 	    89646107
ambiguous:       	 14.1884% 	   484912 	 12.8588% 	    34758546
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.4315% 	   356511 	  8.1537% 	    22040159
semiperfect site:	 15.4069% 	   526555 	 13.3278% 	    36026422
rescued:         	  3.1348% 	   107136

Match Rate:      	      NA 	       NA 	 93.0229% 	   116551082
Error Rate:      	 59.9506% 	  1163967 	  4.3854% 	     5494632
Sub Rate:        	 58.8113% 	  1141847 	  3.4275% 	     4294418
Del Rate:        	  6.1494% 	   119394 	  0.7090% 	      888287
Ins Rate:        	  5.4796% 	   106389 	  0.2490% 	      311927
N Rate:          	 12.9299% 	   251039 	  2.5917% 	     3247226


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 42.1505% 	  1440557 	 41.8047% 	   113637086
unambiguous:     	 30.4064% 	  1039186 	 31.0644% 	    84441804
ambiguous:       	 11.7441% 	   401371 	 10.7403% 	    29195282
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.2595% 	   282282 	  6.5522% 	    17810699
semiperfect site:	 12.9924% 	   444036 	 11.3508% 	    30854733
rescued:         	  3.8946% 	   133104

Match Rate:      	      NA 	       NA 	 92.4481% 	   105876710
Error Rate:      	 56.1072% 	  1085773 	  4.6800% 	     5359817
Sub Rate:        	 55.0081% 	  1064505 	  3.6330% 	     4160721
Del Rate:        	  6.0798% 	   117655 	  0.7758% 	      888484
Ins Rate:        	  5.4149% 	   104788 	  0.2712% 	      310612
N Rate:          	 13.1470% 	   254417 	  2.8719% 	     3289043

Total time:     	165.469 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:39:27	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG.bam -RGID 1 -RGLB 219c_BC -RGPL illumina -RGPU combined_runs -RGSM 219c_BC
**********


22:39:27.703 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:39:27 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG.bam RGID=1 RGLB=219c_BC RGPL=illumina RGPU=combined_runs RGSM=219c_BC    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:39:27 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:39:27	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=219c_BC SM=219c_BC

INFO	2020-09-15 22:39:37	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|12851:72
INFO	2020-09-15 22:39:46	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    8s.  Last read position: lcl|17469:229
INFO	2020-09-15 22:39:55	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|39267:191
INFO	2020-09-15 22:40:04	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|46381:42
INFO	2020-09-15 22:40:15	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:47s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 22:40:25	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 22:40:30 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.04 minutes.
Runtime.totalMemory()=3262644224
INFO	2020-09-15 22:40:37	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:40:37.616 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:40:37 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:40:37 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:40:37	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:40:37	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:40:37	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:40:40	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1213:15124:73296 1:N:0:TGAGGTGT+GACTTGTG. Cause: String 'TGAGGTGT+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:40:45	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|12851:72
INFO	2020-09-15 22:40:45	MarkDuplicates	Tracking 21 as yet unmatched pairs. 8 records in RAM.
INFO	2020-09-15 22:40:51	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|17469:229
INFO	2020-09-15 22:40:51	MarkDuplicates	Tracking 372 as yet unmatched pairs. 352 records in RAM.
INFO	2020-09-15 22:40:59	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    8s.  Last read position: lcl|39267:191
INFO	2020-09-15 22:40:59	MarkDuplicates	Tracking 190 as yet unmatched pairs. 91 records in RAM.
INFO	2020-09-15 22:41:04	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:    4s.  Last read position: lcl|46381:42
INFO	2020-09-15 22:41:04	MarkDuplicates	Tracking 460 as yet unmatched pairs. 400 records in RAM.
INFO	2020-09-15 22:41:05	MarkDuplicates	Read 4228340 records. 0 pairs never matched.
INFO	2020-09-15 22:41:09	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4657180456; totalMemory: 5866782720; maxMemory: 28631367680
INFO	2020-09-15 22:41:09	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:41:13	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:41:14	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:41:14	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:41:15	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5770542504; totalMemory: 13024886784; maxMemory: 28631367680
INFO	2020-09-15 22:41:15	MarkDuplicates	Marking 1149133 records as duplicates.
INFO	2020-09-15 22:41:15	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:41:16	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:42:20	MarkDuplicates	Before output close freeMemory: 15518368256; totalMemory: 15673589760; maxMemory: 28631367680
INFO	2020-09-15 22:42:20	MarkDuplicates	After output close freeMemory: 15316517376; totalMemory: 15471738880; maxMemory: 28631367680
[Tue Sep 15 22:42:20 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.72 minutes.
Runtime.totalMemory()=15471738880
INFO	2020-09-15 22:42:21	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG_DM.bam
**********


22:42:21.956 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:42:21 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:42:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:42:39	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/219c_BC_sorted_RG_DM.bai
[Tue Sep 15 22:42:39 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.29 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226236m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120a_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120a_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120a_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120a_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.046 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.510 seconds.
Analyzed Index:   	2.749 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.533 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	5140246	(428236267 bases)

Mapping:          	138.661 seconds.
Reads/sec:       	37070.65
kBases/sec:      	3088.37


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.4117% 	   653112 	 25.3833% 	   108700426
bad pairs:       	  0.0077% 	      197 	  0.0067% 	       28858
insert size avg: 	  279.59


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.1275% 	  1211235 	 46.3656% 	    98769741
unambiguous:     	 33.0444% 	   849283 	 33.7547% 	    71905656
ambiguous:       	 14.0831% 	   361952 	 12.6108% 	    26864085
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.6372% 	   247687 	  7.3537% 	    15665155
semiperfect site:	 14.3169% 	   367962 	 12.1494% 	    25881087
rescued:         	  2.9730% 	    76410

Match Rate:      	      NA 	       NA 	 92.5168% 	    92135056
Error Rate:      	 60.4613% 	   915376 	  4.7349% 	     4715394
Sub Rate:        	 59.2832% 	   897540 	  3.5348% 	     3520253
Del Rate:        	  6.9701% 	   105526 	  0.8210% 	      817637
Ins Rate:        	  6.6182% 	   100199 	  0.3791% 	      377504
N Rate:          	 12.8467% 	   194497 	  2.7483% 	     2736928


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 42.3967% 	  1089647 	 41.6681% 	    89674985
unambiguous:     	 30.9199% 	   794679 	 31.3678% 	    67507328
ambiguous:       	 11.4768% 	   294968 	 10.3004% 	    22167657
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.6111% 	   195615 	  5.9124% 	    12724282
semiperfect site:	 12.0025% 	   308478 	 10.2815% 	    22127030
rescued:         	  3.7397% 	    96116

Match Rate:      	      NA 	       NA 	 91.9495% 	    83194475
Error Rate:      	 56.1607% 	   845566 	  5.0452% 	     4564861
Sub Rate:        	 55.0255% 	   828475 	  3.7375% 	     3381655
Del Rate:        	  6.7953% 	   102312 	  0.8880% 	      803421
Ins Rate:        	  6.5722% 	    98952 	  0.4198% 	      379785
N Rate:          	 13.0002% 	   195733 	  3.0052% 	     2719070

Total time:     	142.869 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:45:32	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG.bam -RGID 1 -RGLB 120a_UT -RGPL illumina -RGPU combined_runs -RGSM 120a_UT
**********


22:45:33.002 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:45:33 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG.bam RGID=1 RGLB=120a_UT RGPL=illumina RGPU=combined_runs RGSM=120a_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:45:33 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:45:33	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=120a_UT SM=120a_UT

INFO	2020-09-15 22:45:42	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|8667:1
INFO	2020-09-15 22:45:52	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|28498:179
INFO	2020-09-15 22:46:01	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: lcl|44856:86
INFO	2020-09-15 22:46:12	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 22:46:20	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:46s.  Time for last 1,000,000:    7s.  Last read position: */*
[Tue Sep 15 22:46:21 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.80 minutes.
Runtime.totalMemory()=3426222080
INFO	2020-09-15 22:46:26	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:46:27.176 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:46:27 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:46:27 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:46:27	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:46:27	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:46:27	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:46:29	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1104:14014:85593 1:N:0:GATCCATG+GACTTGTG. Cause: String 'GATCCATG+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:46:34	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|8667:1
INFO	2020-09-15 22:46:34	MarkDuplicates	Tracking 28 as yet unmatched pairs. 12 records in RAM.
INFO	2020-09-15 22:46:40	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|28498:179
INFO	2020-09-15 22:46:40	MarkDuplicates	Tracking 268 as yet unmatched pairs. 252 records in RAM.
INFO	2020-09-15 22:46:48	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    7s.  Last read position: lcl|44856:86
INFO	2020-09-15 22:46:48	MarkDuplicates	Tracking 257 as yet unmatched pairs. 255 records in RAM.
INFO	2020-09-15 22:46:49	MarkDuplicates	Read 3295146 records. 0 pairs never matched.
INFO	2020-09-15 22:46:53	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4723984640; totalMemory: 5862064128; maxMemory: 28631367680
INFO	2020-09-15 22:46:53	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:46:57	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:46:58	OpticalDuplicateFinder	Large duplicate set. size = 2370
INFO	2020-09-15 22:46:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:46:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:46:58	OpticalDuplicateFinder	Large duplicate set. size = 2187
INFO	2020-09-15 22:46:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:46:58	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:46:58	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:46:58	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:47:00	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5803450928; totalMemory: 13058441216; maxMemory: 28631367680
INFO	2020-09-15 22:47:00	MarkDuplicates	Marking 990071 records as duplicates.
INFO	2020-09-15 22:47:00	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:47:00	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:47:50	MarkDuplicates	Before output close freeMemory: 17164410376; totalMemory: 17351835648; maxMemory: 28631367680
INFO	2020-09-15 22:47:50	MarkDuplicates	After output close freeMemory: 17003453960; totalMemory: 17190879232; maxMemory: 28631367680
[Tue Sep 15 22:47:50 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.39 minutes.
Runtime.totalMemory()=17190879232
INFO	2020-09-15 22:47:51	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG_DM.bam
**********


22:47:52.217 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:47:52 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:47:52 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:48:07	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120a_UT_sorted_RG_DM.bai
[Tue Sep 15 22:48:07 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.25 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226387m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120b_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120b_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120b_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120b_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.039 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.516 seconds.
Analyzed Index:   	3.203 seconds.
Started output stream:	0.030 seconds.
Cleared Memory:    	1.133 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3779760	(321916082 bases)

Mapping:          	135.843 seconds.
Reads/sec:       	27824.40
kBases/sec:      	2369.76


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 23.0521% 	   435657 	 23.0192% 	    74102392
bad pairs:       	  0.0113% 	      213 	  0.0096% 	       30948
insert size avg: 	  349.08


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.4254% 	  1028575 	 53.0977% 	    85386636
unambiguous:     	 37.5464% 	   709581 	 38.2233% 	    61467038
ambiguous:       	 16.8791% 	   318994 	 14.8744% 	    23919598
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.5996% 	   219218 	  8.7832% 	    14124229
semiperfect site:	 16.9678% 	   320671 	 14.2154% 	    22859826
rescued:         	  3.1707% 	    59923

Match Rate:      	      NA 	       NA 	 92.4723% 	    79571477
Error Rate:      	 57.9512% 	   767419 	  4.6241% 	     3979031
Sub Rate:        	 56.8631% 	   753010 	  3.5755% 	     3076640
Del Rate:        	  6.9306% 	    91778 	  0.7698% 	      662388
Ins Rate:        	  5.8868% 	    77956 	  0.2789% 	      240003
N Rate:          	 13.1943% 	   174726 	  2.9036% 	     2498516


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.1629% 	   891323 	 46.4286% 	    74799069
unambiguous:     	 34.5622% 	   653184 	 35.1703% 	    56661255
ambiguous:       	 12.6007% 	   238139 	 11.2583% 	    18137814
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.2953% 	   156771 	  6.4161% 	    10336635
semiperfect site:	 13.5713% 	   256482 	 11.5526% 	    18611872
rescued:         	  3.8725% 	    73186

Match Rate:      	      NA 	       NA 	 91.3004% 	    68920042
Error Rate:      	 52.1508% 	   684686 	  5.0772% 	     3832660
Sub Rate:        	 51.1459% 	   671492 	  3.8611% 	     2914649
Del Rate:        	  6.9037% 	    90638 	  0.9115% 	      688083
Ins Rate:        	  5.8205% 	    76417 	  0.3046% 	      229928
N Rate:          	 14.8929% 	   195528 	  3.6224% 	     2734450

Total time:     	141.101 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:50:50	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG.bam -RGID 1 -RGLB 120b_UT -RGPL illumina -RGPU combined_runs -RGSM 120b_UT
**********


22:50:50.619 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:50:50 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG.bam RGID=1 RGLB=120b_UT RGPL=illumina RGPU=combined_runs RGSM=120b_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:50:50 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:50:50	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=120b_UT SM=120b_UT

INFO	2020-09-15 22:51:00	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|415:3
INFO	2020-09-15 22:51:09	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|35921:14
INFO	2020-09-15 22:51:19	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 22:51:27 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.61 minutes.
Runtime.totalMemory()=3508011008
INFO	2020-09-15 22:51:31	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:51:32.026 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:51:32 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:51:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:51:32	MarkDuplicates	Start of doWork freeMemory: 2037938232; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:51:32	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:51:32	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:51:34	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2107:21560:19531 1:N:0:GCCTATCA+GACTTGTG. Cause: String 'GCCTATCA+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:51:41	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:07s.  Time for last 1,000,000:    6s.  Last read position: lcl|415:3
INFO	2020-09-15 22:51:41	MarkDuplicates	Tracking 19 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-15 22:51:46	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|35921:14
INFO	2020-09-15 22:51:46	MarkDuplicates	Tracking 16 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-15 22:51:51	MarkDuplicates	Read 2968056 records. 0 pairs never matched.
INFO	2020-09-15 22:51:54	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4738995952; totalMemory: 5832704000; maxMemory: 28631367680
INFO	2020-09-15 22:51:54	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:51:58	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:51:58	OpticalDuplicateFinder	Large duplicate set. size = 1987
INFO	2020-09-15 22:51:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:51:58	OpticalDuplicateFinder	Large duplicate set. size = 1301
INFO	2020-09-15 22:51:58	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:51:58	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:51:59	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:51:59	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5758723944; totalMemory: 13011779584; maxMemory: 28631367680
INFO	2020-09-15 22:51:59	MarkDuplicates	Marking 976756 records as duplicates.
INFO	2020-09-15 22:51:59	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:52:00	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:52:37	MarkDuplicates	Before output close freeMemory: 12930759376; totalMemory: 13032226816; maxMemory: 28631367680
INFO	2020-09-15 22:52:37	MarkDuplicates	After output close freeMemory: 17093624144; totalMemory: 17277911040; maxMemory: 28631367680
[Tue Sep 15 22:52:37 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.09 minutes.
Runtime.totalMemory()=17277911040
INFO	2020-09-15 22:52:38	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG_DM.bam
**********


22:52:38.665 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:52:38 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:52:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:52:49	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120b_UT_sorted_RG_DM.bai
[Tue Sep 15 22:52:49 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226401m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120c_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120c_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120c_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120c_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.056 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.520 seconds.
Analyzed Index:   	2.953 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.537 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2048188	(174693817 bases)

Mapping:          	80.410 seconds.
Reads/sec:       	25471.90
kBases/sec:      	2172.55


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 19.6805% 	   201547 	 19.3583% 	    33817700
bad pairs:       	  0.0100% 	      102 	  0.0079% 	       13764
insert size avg: 	  515.20


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.1712% 	   554764 	 52.7837% 	    46019058
unambiguous:     	 36.1899% 	   370619 	 36.9085% 	    32178420
ambiguous:       	 17.9813% 	   184145 	 15.8752% 	    13840638
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.8764% 	   131866 	  9.7719% 	     8519528
semiperfect site:	 19.3253% 	   197909 	 16.3745% 	    14276011
rescued:         	  2.6962% 	    27612

Match Rate:      	      NA 	       NA 	 93.1178% 	    43153839
Error Rate:      	 53.1603% 	   396458 	  4.0980% 	     1899130
Sub Rate:        	 52.1563% 	   388971 	  3.1596% 	     1464246
Del Rate:        	  5.7238% 	    42687 	  0.6996% 	      324210
Ins Rate:        	  4.9815% 	    37151 	  0.2388% 	      110674
N Rate:          	 12.5917% 	    93906 	  2.7842% 	     1290299


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 46.8618% 	   479909 	 45.9673% 	    40225814
unambiguous:     	 32.8129% 	   336035 	 33.4662% 	    29286145
ambiguous:       	 14.0489% 	   143874 	 12.5011% 	    10939669
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.8907% 	   101290 	  7.6909% 	     6730272
semiperfect site:	 15.5563% 	   159311 	 13.3207% 	    11656865
rescued:         	  3.2602% 	    33388

Match Rate:      	      NA 	       NA 	 92.4770% 	    37490296
Error Rate:      	 47.7803% 	   353372 	  4.4447% 	     1801887
Sub Rate:        	 46.8503% 	   346494 	  3.4089% 	     1381969
Del Rate:        	  5.5048% 	    40712 	  0.7753% 	      314304
Ins Rate:        	  4.8146% 	    35608 	  0.2605% 	      105614
N Rate:          	 12.2923% 	    90911 	  3.0783% 	     1247935

Total time:     	84.851 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:54:27	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG.bam -RGID 1 -RGLB 120c_UT -RGPL illumina -RGPU combined_runs -RGSM 120c_UT
**********


22:54:27.510 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:54:27 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG.bam RGID=1 RGLB=120c_UT RGPL=illumina RGPU=combined_runs RGSM=120c_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:54:27 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:54:27	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=120c_UT SM=120c_UT

INFO	2020-09-15 22:54:37	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|32037:42
INFO	2020-09-15 22:54:47	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 22:54:48 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.34 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 22:54:50	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:54:50.975 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:54:50 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:54:50 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:54:51	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:54:51	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:54:51	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:54:53	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2211:15828:7043 1:N:0:AACAACCG+GACTTGTG. Cause: String 'AACAACCG+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:54:59	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|32037:42
INFO	2020-09-15 22:54:59	MarkDuplicates	Tracking 98 as yet unmatched pairs. 93 records in RAM.
INFO	2020-09-15 22:55:04	MarkDuplicates	Read 1666048 records. 0 pairs never matched.
INFO	2020-09-15 22:55:06	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2689230720; totalMemory: 3660578816; maxMemory: 28631367680
INFO	2020-09-15 22:55:06	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:55:10	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:55:10	OpticalDuplicateFinder	Large duplicate set. size = 2451
INFO	2020-09-15 22:55:10	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:55:10	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:55:10	OpticalDuplicateFinder	Large duplicate set. size = 1963
INFO	2020-09-15 22:55:10	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 22:55:10	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:55:10	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:55:11	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3633103904; totalMemory: 10844372992; maxMemory: 28631367680
INFO	2020-09-15 22:55:11	MarkDuplicates	Marking 471942 records as duplicates.
INFO	2020-09-15 22:55:11	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:55:12	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:55:32	MarkDuplicates	Before output close freeMemory: 12884151280; totalMemory: 12986089472; maxMemory: 28631367680
INFO	2020-09-15 22:55:32	MarkDuplicates	After output close freeMemory: 12787682288; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 22:55:32 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.70 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 22:55:33	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG_DM.bam
**********


22:55:34.003 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:55:34 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:55:34 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:55:41	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120c_UT_sorted_RG_DM.bai
[Tue Sep 15 22:55:41 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.13 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226411m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120d_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120d_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120d_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120d_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.510 seconds.
Analyzed Index:   	2.910 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.539 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3133926	(259605896 bases)

Mapping:          	114.349 seconds.
Reads/sec:       	27406.56
kBases/sec:      	2270.29


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 24.7419% 	   387697 	 24.4326% 	    63428416
bad pairs:       	  0.0098% 	      154 	  0.0086% 	       22414
insert size avg: 	  444.41


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 58.1817% 	   911686 	 56.9689% 	    73862337
unambiguous:     	 37.8715% 	   593433 	 38.7913% 	    50294329
ambiguous:       	 20.3102% 	   318253 	 18.1777% 	    23568008
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.0216% 	   219714 	 10.4888% 	    13599096
semiperfect site:	 20.6989% 	   324344 	 17.4202% 	    22585882
rescued:         	  3.2273% 	    50571

Match Rate:      	      NA 	       NA 	 93.4415% 	    69504877
Error Rate:      	 55.2747% 	   654042 	  4.0613% 	     3020920
Sub Rate:        	 54.2547% 	   641972 	  3.1238% 	     2323574
Del Rate:        	  5.5668% 	    65870 	  0.7004% 	      520955
Ins Rate:        	  4.9164% 	    58174 	  0.2371% 	      176391
N Rate:          	 11.7541% 	   139081 	  2.4972% 	     1857495


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.5218% 	   775988 	 48.8920% 	    63536206
unambiguous:     	 33.9261% 	   531609 	 34.7656% 	    45178627
ambiguous:       	 15.5957% 	   244379 	 14.1264% 	    18357579
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.1383% 	   158864 	  7.7337% 	    10050087
semiperfect site:	 16.0387% 	   251320 	 13.6649% 	    17757893
rescued:         	  4.0039% 	    62739

Match Rate:      	      NA 	       NA 	 92.6922% 	    59376868
Error Rate:      	 49.5562% 	   580508 	  4.5013% 	     2883449
Sub Rate:        	 48.6141% 	   569472 	  3.4254% 	     2194263
Del Rate:        	  5.3838% 	    63067 	  0.8147% 	      521882
Ins Rate:        	  4.7188% 	    55277 	  0.2612% 	      167304
N Rate:          	 11.5793% 	   135641 	  2.8065% 	     1797771

Total time:     	118.720 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 22:57:58	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG.bam -RGID 1 -RGLB 120d_UT -RGPL illumina -RGPU combined_runs -RGSM 120d_UT
**********


22:57:58.913 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:57:58 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG.bam RGID=1 RGLB=120d_UT RGPL=illumina RGPU=combined_runs RGSM=120d_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:57:58 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:57:59	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=120d_UT SM=120d_UT

INFO	2020-09-15 22:58:08	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|22061:891
INFO	2020-09-15 22:58:18	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: lcl|28445:293
INFO	2020-09-15 22:58:28	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 22:58:29 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.51 minutes.
Runtime.totalMemory()=3508535296
INFO	2020-09-15 22:58:33	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


22:58:33.680 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:58:33 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:58:33 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:58:33	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 22:58:33	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 22:58:33	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 22:58:36	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1111:12365:79389 1:N:0:ACTCGTTG+GACTTGTG. Cause: String 'ACTCGTTG+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 22:58:41	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:04s.  Time for last 1,000,000:    4s.  Last read position: lcl|22061:891
INFO	2020-09-15 22:58:41	MarkDuplicates	Tracking 84 as yet unmatched pairs. 65 records in RAM.
INFO	2020-09-15 22:58:46	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|28445:293
INFO	2020-09-15 22:58:46	MarkDuplicates	Tracking 526 as yet unmatched pairs. 514 records in RAM.
INFO	2020-09-15 22:58:50	MarkDuplicates	Read 2599646 records. 0 pairs never matched.
INFO	2020-09-15 22:58:53	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4769261160; totalMemory: 5843189760; maxMemory: 28631367680
INFO	2020-09-15 22:58:53	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 22:58:57	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 22:58:57	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 22:58:57	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 22:58:58	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5759415184; totalMemory: 13012828160; maxMemory: 28631367680
INFO	2020-09-15 22:58:58	MarkDuplicates	Marking 716534 records as duplicates.
INFO	2020-09-15 22:58:58	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 22:58:58	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 22:59:30	MarkDuplicates	Before output close freeMemory: 12922128280; totalMemory: 13024362496; maxMemory: 28631367680
INFO	2020-09-15 22:59:30	MarkDuplicates	After output close freeMemory: 17104237616; totalMemory: 17289969664; maxMemory: 28631367680
[Tue Sep 15 22:59:30 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.94 minutes.
Runtime.totalMemory()=17289969664
INFO	2020-09-15 22:59:31	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG_DM.bam
**********


22:59:31.636 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 22:59:31 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 22:59:31 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 22:59:41	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120d_UT_sorted_RG_DM.bai
[Tue Sep 15 22:59:41 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.16 minutes.
Runtime.totalMemory()=5745672192
java -ea -Xmx226382m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120e_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120e_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120e_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/120e_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.047 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.524 seconds.
Analyzed Index:   	2.908 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	1.232 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2130254	(180462794 bases)

Mapping:          	81.723 seconds.
Reads/sec:       	26066.80
kBases/sec:      	2208.23


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 17.8775% 	   190418 	 17.7245% 	    31986206
bad pairs:       	  0.0104% 	      111 	  0.0088% 	       15844
insert size avg: 	  453.51


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 52.0490% 	   554388 	 50.6939% 	    45755188
unambiguous:     	 35.6308% 	   379513 	 36.2817% 	    32747049
ambiguous:       	 16.4182% 	   174875 	 14.4122% 	    13008139
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.3474% 	   120864 	  8.4734% 	     7647902
semiperfect site:	 16.5997% 	   176808 	 13.8361% 	    12488181
rescued:         	  2.5696% 	    27370

Match Rate:      	      NA 	       NA 	 92.7164% 	    42759000
Error Rate:      	 56.0284% 	   410332 	  4.5270% 	     2087788
Sub Rate:        	 54.8764% 	   401895 	  3.4558% 	     1593759
Del Rate:        	  6.7813% 	    49664 	  0.7869% 	      362888
Ins Rate:        	  5.8139% 	    42579 	  0.2844% 	      131141
N Rate:          	 12.5017% 	    91558 	  2.7566% 	     1271288


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.5243% 	   474240 	 43.8297% 	    39536542
unambiguous:     	 32.6157% 	   347399 	 33.1989% 	    29947038
ambiguous:       	 11.9085% 	   126841 	 10.6308% 	     9589504
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.8912% 	    84051 	  6.0461% 	     5453877
semiperfect site:	 12.9902% 	   138362 	 11.0481% 	     9965958
rescued:         	  3.0486% 	    32471

Match Rate:      	      NA 	       NA 	 91.5167% 	    36527145
Error Rate:      	 49.7960% 	   362643 	  5.0246% 	     2005469
Sub Rate:        	 48.7111% 	   354742 	  3.7664% 	     1503304
Del Rate:        	  6.7613% 	    49240 	  0.9434% 	      376536
Ins Rate:        	  5.7109% 	    41590 	  0.3148% 	      125629
N Rate:          	 14.0334% 	   102199 	  3.4587% 	     1380464

Total time:     	86.804 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:01:21	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG.bam -RGID 1 -RGLB 120e_UT -RGPL illumina -RGPU combined_runs -RGSM 120e_UT
**********


23:01:21.402 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:01:21 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG.bam RGID=1 RGLB=120e_UT RGPL=illumina RGPU=combined_runs RGSM=120e_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:01:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:01:21	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=120e_UT SM=120e_UT

INFO	2020-09-15 23:01:31	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|32947:83
INFO	2020-09-15 23:01:41	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 23:01:42 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.35 minutes.
Runtime.totalMemory()=3670540288
INFO	2020-09-15 23:01:45	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:01:45.637 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:01:45 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:01:45 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:01:45	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:01:45	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:01:45	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:01:48	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1106:9419:92935 1:N:0:CCTATGGT+GACTTGCG. Cause: String 'CCTATGGT+GACTTGCG' did not start with a parsable number.
INFO	2020-09-15 23:01:54	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|32947:83
INFO	2020-09-15 23:01:54	MarkDuplicates	Tracking 29 as yet unmatched pairs. 27 records in RAM.
INFO	2020-09-15 23:01:57	MarkDuplicates	Read 1676198 records. 0 pairs never matched.
INFO	2020-09-15 23:02:00	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2689431848; totalMemory: 3659005952; maxMemory: 28631367680
INFO	2020-09-15 23:02:00	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:02:04	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:02:04	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:02:04	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:02:05	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3631997888; totalMemory: 10842800128; maxMemory: 28631367680
INFO	2020-09-15 23:02:05	MarkDuplicates	Marking 514736 records as duplicates.
INFO	2020-09-15 23:02:05	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:02:05	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:02:26	MarkDuplicates	Before output close freeMemory: 12882091800; totalMemory: 12983468032; maxMemory: 28631367680
INFO	2020-09-15 23:02:26	MarkDuplicates	After output close freeMemory: 12788244248; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 23:02:26 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.69 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 23:02:28	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG_DM.bam
**********


23:02:28.399 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:02:28 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:02:28 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:02:35	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/120e_UT_sorted_RG_DM.bai
[Tue Sep 15 23:02:35 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.11 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226368m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135a_WY_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135a_WY_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135a_WY_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135a_WY_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.108 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.547 seconds.
Analyzed Index:   	2.965 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.554 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4472044	(359719862 bases)

Mapping:          	132.272 seconds.
Reads/sec:       	33809.46
kBases/sec:      	2719.55


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 27.5401% 	   615802 	 27.3989% 	    98559262
bad pairs:       	  0.0102% 	      228 	  0.0094% 	       33910
insert size avg: 	  335.45


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.3909% 	  1216192 	 53.4467% 	    95957361
unambiguous:     	 36.5225% 	   816651 	 37.4083% 	    67162255
ambiguous:       	 17.8684% 	   399541 	 16.0384% 	    28795106
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.8962% 	   288362 	  9.9673% 	    17895145
semiperfect site:	 18.6482% 	   416978 	 15.9662% 	    28665521
rescued:         	  3.3307% 	    74475

Match Rate:      	      NA 	       NA 	 93.0633% 	    89887457
Error Rate:      	 57.7141% 	   876941 	  4.2381% 	     4093433
Sub Rate:        	 56.3889% 	   856805 	  3.3622% 	     3247480
Del Rate:        	  5.5417% 	    84204 	  0.6523% 	      630065
Ins Rate:        	  5.1612% 	    78422 	  0.2235% 	      215888
N Rate:          	 12.2723% 	   186472 	  2.6986% 	     2606536


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.8530% 	  1070003 	 47.3496% 	    85315123
unambiguous:     	 33.6875% 	   753259 	 34.4796% 	    62125718
ambiguous:       	 14.1655% 	   316744 	 12.8700% 	    23189405
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.7975% 	   219074 	  7.7289% 	    13925964
semiperfect site:	 15.1463% 	   338674 	 13.1519% 	    23697287
rescued:         	  4.1806% 	    93480

Match Rate:      	      NA 	       NA 	 92.4038% 	    79408307
Error Rate:      	 52.9254% 	   799215 	  4.5837% 	     3939067
Sub Rate:        	 51.6992% 	   780698 	  3.6144% 	     3106048
Del Rate:        	  5.3936% 	    81447 	  0.7227% 	      621103
Ins Rate:        	  5.0607% 	    76420 	  0.2466% 	      211916
N Rate:          	 12.4055% 	   187333 	  3.0125% 	     2588852

Total time:     	136.810 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:05:16	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG.bam -RGID 1 -RGLB 135a_WY -RGPL illumina -RGPU combined_runs -RGSM 135a_WY
**********


23:05:17.007 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:05:17 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG.bam RGID=1 RGLB=135a_WY RGPL=illumina RGPU=combined_runs RGSM=135a_WY    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:05:17 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:05:17	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=135a_WY SM=135a_WY

INFO	2020-09-15 23:05:26	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|6701:1,013
INFO	2020-09-15 23:05:35	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|29565:5
INFO	2020-09-15 23:05:44	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|37786:6
INFO	2020-09-15 23:05:55	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:37s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 23:05:58 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.69 minutes.
Runtime.totalMemory()=2373976064
INFO	2020-09-15 23:06:03	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:06:03.685 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:06:03 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:06:03 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:06:03	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:06:03	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:06:03	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:06:05	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2307:14661:93023 1:N:0:TGTACACC+GACTTGTG. Cause: String 'TGTACACC+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 23:06:10	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:04s.  Time for last 1,000,000:    4s.  Last read position: lcl|6701:1,013
INFO	2020-09-15 23:06:10	MarkDuplicates	Tracking 20 as yet unmatched pairs. 8 records in RAM.
INFO	2020-09-15 23:06:15	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    5s.  Last read position: lcl|29565:5
INFO	2020-09-15 23:06:15	MarkDuplicates	Tracking 36 as yet unmatched pairs. 10 records in RAM.
INFO	2020-09-15 23:06:25	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: lcl|37786:6
INFO	2020-09-15 23:06:25	MarkDuplicates	Tracking 220 as yet unmatched pairs. 214 records in RAM.
INFO	2020-09-15 23:06:26	MarkDuplicates	Read 3340330 records. 0 pairs never matched.
INFO	2020-09-15 23:06:31	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4727468992; totalMemory: 5862064128; maxMemory: 28631367680
INFO	2020-09-15 23:06:31	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:06:35	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:06:35	OpticalDuplicateFinder	Large duplicate set. size = 1624
INFO	2020-09-15 23:06:35	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:06:35	OpticalDuplicateFinder	Large duplicate set. size = 1368
INFO	2020-09-15 23:06:35	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:06:35	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:06:36	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:06:37	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5806899952; totalMemory: 13062111232; maxMemory: 28631367680
INFO	2020-09-15 23:06:37	MarkDuplicates	Marking 920725 records as duplicates.
INFO	2020-09-15 23:06:37	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:06:37	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:07:20	MarkDuplicates	Before output close freeMemory: 17168112928; totalMemory: 17355505664; maxMemory: 28631367680
INFO	2020-09-15 23:07:20	MarkDuplicates	After output close freeMemory: 17005583648; totalMemory: 17192976384; maxMemory: 28631367680
[Tue Sep 15 23:07:20 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.28 minutes.
Runtime.totalMemory()=17192976384
INFO	2020-09-15 23:07:21	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG_DM.bam
**********


23:07:21.735 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:07:21 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:07:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:07:34	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135a_WY_sorted_RG_DM.bai
[Tue Sep 15 23:07:34 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.21 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226243m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135b_WY_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135b_WY_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135b_WY_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135b_WY_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.523 seconds.
Analyzed Index:   	3.319 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.556 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3992274	(329000051 bases)

Mapping:          	123.130 seconds.
Reads/sec:       	32423.37
kBases/sec:      	2671.98


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.3067% 	   425310 	 21.1658% 	    69635342
bad pairs:       	  0.0069% 	      137 	  0.0061% 	       20000
insert size avg: 	  433.27


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.6451% 	   990985 	 48.8945% 	    80316530
unambiguous:     	 32.4178% 	   647104 	 33.4206% 	    54898323
ambiguous:       	 17.2273% 	   343881 	 15.4739% 	    25418207
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.7294% 	   234135 	  8.8099% 	    14471536
semiperfect site:	 17.4207% 	   347741 	 14.7659% 	    24255245
rescued:         	  2.8171% 	    56233

Match Rate:      	      NA 	       NA 	 93.3857% 	    75480566
Error Rate:      	 55.3254% 	   715212 	  4.0630% 	     3284025
Sub Rate:        	 54.4111% 	   703393 	  3.2231% 	     2605162
Del Rate:        	  5.1493% 	    66567 	  0.6312% 	      510196
Ins Rate:        	  4.4699% 	    57784 	  0.2087% 	      168667
N Rate:          	 12.0771% 	   156125 	  2.5513% 	     2062135


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 42.6232% 	   850817 	 42.3724% 	    69802183
unambiguous:     	 29.3207% 	   585281 	 30.2426% 	    49820091
ambiguous:       	 13.3025% 	   265536 	 12.1298% 	    19982092
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.6589% 	   172843 	  6.6729% 	    10992522
semiperfect site:	 13.7550% 	   274568 	 11.8463% 	    19515041
rescued:         	  3.4276% 	    68419

Match Rate:      	      NA 	       NA 	 92.6868% 	    65163687
Error Rate:      	 49.6076% 	   636549 	  4.4273% 	     3112639
Sub Rate:        	 48.7386% 	   625398 	  3.4791% 	     2445975
Del Rate:        	  4.9438% 	    63437 	  0.7156% 	      503101
Ins Rate:        	  4.3049% 	    55239 	  0.2326% 	      163563
N Rate:          	 12.0496% 	   154616 	  2.8859% 	     2028958

Total time:     	127.979 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:10:05	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG.bam -RGID 1 -RGLB 135b_WY -RGPL illumina -RGPU combined_runs -RGSM 135b_WY
**********


23:10:05.605 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:10:05 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG.bam RGID=1 RGLB=135b_WY RGPL=illumina RGPU=combined_runs RGSM=135b_WY    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:10:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:10:05	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=135b_WY SM=135b_WY

INFO	2020-09-15 23:10:15	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|588:63
INFO	2020-09-15 23:10:24	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|34404:8
INFO	2020-09-15 23:10:34	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:10:42 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.62 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 23:10:47	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:10:47.523 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:10:47 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:10:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:10:47	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:10:47	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:10:47	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:10:49	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2203:3176:77619 1:N:0:GTATGCTG+GACTTGTG. Cause: String 'GTATGCTG+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 23:10:55	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|588:63
INFO	2020-09-15 23:10:55	MarkDuplicates	Tracking 57 as yet unmatched pairs. 46 records in RAM.
INFO	2020-09-15 23:11:00	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|34404:8
INFO	2020-09-15 23:11:00	MarkDuplicates	Tracking 66 as yet unmatched pairs. 47 records in RAM.
INFO	2020-09-15 23:11:05	MarkDuplicates	Read 2832710 records. 0 pairs never matched.
INFO	2020-09-15 23:11:08	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4750944696; totalMemory: 5838995456; maxMemory: 28631367680
INFO	2020-09-15 23:11:08	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:11:12	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:11:12	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:11:13	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:11:14	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5760699160; totalMemory: 13014401024; maxMemory: 28631367680
INFO	2020-09-15 23:11:14	MarkDuplicates	Marking 823257 records as duplicates.
INFO	2020-09-15 23:11:14	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:11:14	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:11:54	MarkDuplicates	Before output close freeMemory: 12929095024; totalMemory: 13031178240; maxMemory: 28631367680
INFO	2020-09-15 23:11:54	MarkDuplicates	After output close freeMemory: 17098521632; totalMemory: 17283678208; maxMemory: 28631367680
[Tue Sep 15 23:11:54 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.11 minutes.
Runtime.totalMemory()=17283678208
INFO	2020-09-15 23:11:55	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG_DM.bam
**********


23:11:55.610 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:11:55 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:11:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:12:07	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135b_WY_sorted_RG_DM.bai
[Tue Sep 15 23:12:07 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.20 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226259m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135c_WY_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135c_WY_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135c_WY_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135c_WY_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.557 seconds.
Analyzed Index:   	3.012 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.552 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	9141712	(727642010 bases)

Mapping:          	243.170 seconds.
Reads/sec:       	37593.85
kBases/sec:      	2992.31


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 27.2729% 	  1246607 	 27.1944% 	   197877780
bad pairs:       	  0.0091% 	      414 	  0.0082% 	       59366
insert size avg: 	  322.95


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.6355% 	  2314476 	 49.7783% 	   180605382
unambiguous:     	 33.6780% 	  1539372 	 34.4053% 	   124829183
ambiguous:       	 16.9575% 	   775104 	 15.3730% 	    55776199
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.2097% 	   558087 	  9.4491% 	    34283143
semiperfect site:	 18.0588% 	   825440 	 15.5520% 	    56425808
rescued:         	  3.3707% 	   154069

Match Rate:      	      NA 	       NA 	 93.3429% 	   169739510
Error Rate:      	 57.5808% 	  1654601 	  4.1904% 	     7619952
Sub Rate:        	 56.5708% 	  1625577 	  3.2815% 	     5967333
Del Rate:        	  5.5928% 	   160712 	  0.6817% 	     1239693
Ins Rate:        	  4.9163% 	   141271 	  0.2271% 	      412926
N Rate:          	 12.4791% 	   358591 	  2.4667% 	     4485613


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.9141% 	  2052957 	 44.4026% 	   161990567
unambiguous:     	 31.2660% 	  1429123 	 31.9016% 	   116384147
ambiguous:       	 13.6481% 	   623834 	 12.5010% 	    45606420
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.4955% 	   434026 	  7.4890% 	    27321462
semiperfect site:	 14.9988% 	   685575 	 13.0718% 	    47688800
rescued:         	  4.1805% 	   191083

Match Rate:      	      NA 	       NA 	 92.6763% 	   151295665
Error Rate:      	 52.9300% 	  1514214 	  4.5230% 	     7383816
Sub Rate:        	 51.9653% 	  1486618 	  3.4992% 	     5712496
Del Rate:        	  5.5240% 	   158030 	  0.7725% 	     1261192
Ins Rate:        	  4.8256% 	   138051 	  0.2512% 	      410128
N Rate:          	 12.7292% 	   364154 	  2.8008% 	     4572278

Total time:     	247.695 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:17:04	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG.bam -RGID 1 -RGLB 135c_WY -RGPL illumina -RGPU combined_runs -RGSM 135c_WY
**********


23:17:05.177 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:17:05 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG.bam RGID=1 RGLB=135c_WY RGPL=illumina RGPU=combined_runs RGSM=135c_WY    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:17:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:17:05	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=135c_WY SM=135c_WY

INFO	2020-09-15 23:17:14	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|5621:194
INFO	2020-09-15 23:17:23	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|8550:17
INFO	2020-09-15 23:17:32	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    9s.  Last read position: lcl|26249:702
INFO	2020-09-15 23:17:41	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:35s.  Time for last 1,000,000:    9s.  Last read position: lcl|35266:409
INFO	2020-09-15 23:17:50	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:44s.  Time for last 1,000,000:    9s.  Last read position: lcl|16465:480
INFO	2020-09-15 23:17:59	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:53s.  Time for last 1,000,000:    8s.  Last read position: lcl|41860:164
INFO	2020-09-15 23:18:10	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:04s.  Time for last 1,000,000:   11s.  Last read position: */*
INFO	2020-09-15 23:18:20	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:14s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-15 23:18:26	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:20s.  Time for last 1,000,000:    5s.  Last read position: */*
[Tue Sep 15 23:18:27 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.37 minutes.
Runtime.totalMemory()=3192389632
INFO	2020-09-15 23:18:36	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:18:37.025 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:18:37 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:18:37 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:18:37	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:18:37	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:18:37	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:18:39	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2215:17112:27931 1:N:0:TGATGTCC+GACTTGTG. Cause: String 'TGATGTCC+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 23:18:46	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|5621:194
INFO	2020-09-15 23:18:46	MarkDuplicates	Tracking 508 as yet unmatched pairs. 479 records in RAM.
INFO	2020-09-15 23:18:51	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:12s.  Time for last 1,000,000:    5s.  Last read position: lcl|8550:17
INFO	2020-09-15 23:18:51	MarkDuplicates	Tracking 45 as yet unmatched pairs. 6 records in RAM.
INFO	2020-09-15 23:18:58	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    6s.  Last read position: lcl|26249:702
INFO	2020-09-15 23:18:58	MarkDuplicates	Tracking 436 as yet unmatched pairs. 399 records in RAM.
INFO	2020-09-15 23:19:02	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    3s.  Last read position: lcl|35266:409
INFO	2020-09-15 23:19:02	MarkDuplicates	Tracking 399 as yet unmatched pairs. 356 records in RAM.
INFO	2020-09-15 23:19:09	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:    7s.  Last read position: lcl|16465:480
INFO	2020-09-15 23:19:09	MarkDuplicates	Tracking 343 as yet unmatched pairs. 322 records in RAM.
INFO	2020-09-15 23:19:13	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:33s.  Time for last 1,000,000:    3s.  Last read position: lcl|41860:164
INFO	2020-09-15 23:19:13	MarkDuplicates	Tracking 202 as yet unmatched pairs. 169 records in RAM.
INFO	2020-09-15 23:19:16	MarkDuplicates	Read 6240824 records. 0 pairs never matched.
INFO	2020-09-15 23:19:22	MarkDuplicates	After buildSortedReadEndLists freeMemory: 7003142304; totalMemory: 8384413696; maxMemory: 28631367680
INFO	2020-09-15 23:19:22	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:19:26	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	Large duplicate set. size = 6739
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         5,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         6,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	Large duplicate set. size = 4848
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:27	OpticalDuplicateFinder	compared         4,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:19:28	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:19:28	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:19:29	MarkDuplicates	After generateDuplicateIndexes freeMemory: 8236319016; totalMemory: 15542517760; maxMemory: 28631367680
INFO	2020-09-15 23:19:29	MarkDuplicates	Marking 1981788 records as duplicates.
INFO	2020-09-15 23:19:29	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:19:29	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:20:54	MarkDuplicates	Before output close freeMemory: 16958631160; totalMemory: 17141071872; maxMemory: 28631367680
INFO	2020-09-15 23:20:54	MarkDuplicates	After output close freeMemory: 18849833040; totalMemory: 19070451712; maxMemory: 28631367680
[Tue Sep 15 23:20:54 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.30 minutes.
Runtime.totalMemory()=19070451712
INFO	2020-09-15 23:20:56	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG_DM.bam
**********


23:20:56.584 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:20:56 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:20:56 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:21:19	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135c_WY_sorted_RG_DM.bai
[Tue Sep 15 23:21:19 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.39 minutes.
Runtime.totalMemory()=5540675584
java -ea -Xmx226202m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135d_WY_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135d_WY_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135d_WY_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135d_WY_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.038 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.505 seconds.
Analyzed Index:   	2.859 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.576 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3643760	(303852962 bases)

Mapping:          	116.353 seconds.
Reads/sec:       	31316.54
kBases/sec:      	2611.48


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 28.1716% 	   513252 	 27.8671% 	    84675006
bad pairs:       	  0.0110% 	      201 	  0.0097% 	       29534
insert size avg: 	  370.58


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.3451% 	  1008321 	 53.9364% 	    81471875
unambiguous:     	 36.1446% 	   658512 	 36.7240% 	    55472251
ambiguous:       	 19.2004% 	   349809 	 17.2124% 	    25999624
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.4369% 	   244804 	 10.0606% 	    15196756
semiperfect site:	 20.5643% 	   374657 	 17.4007% 	    26284003
rescued:         	  3.6222% 	    65992

Match Rate:      	      NA 	       NA 	 93.2478% 	    76453684
Error Rate:      	 56.4942% 	   715672 	  3.9726% 	     3257160
Sub Rate:        	 55.4874% 	   702918 	  3.1086% 	     2548752
Del Rate:        	  5.3198% 	    67392 	  0.6317% 	      517903
Ins Rate:        	  4.8276% 	    61157 	  0.2324% 	      190505
N Rate:          	 13.0551% 	   165383 	  2.7795% 	     2278934


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.5216% 	   884005 	 47.2712% 	    72230926
unambiguous:     	 33.2149% 	   605135 	 33.4877% 	    51169639
ambiguous:       	 15.3067% 	   278870 	 13.7835% 	    21061287
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.2627% 	   186974 	  7.7836% 	    11893355
semiperfect site:	 16.7884% 	   305864 	 14.2839% 	    21825939
rescued:         	  4.4491% 	    81057

Match Rate:      	      NA 	       NA 	 92.6113% 	    67373019
Error Rate:      	 51.5933% 	   649510 	  4.3109% 	     3136103
Sub Rate:        	 50.6174% 	   637224 	  3.3424% 	     2431560
Del Rate:        	  5.1917% 	    65358 	  0.7110% 	      517208
Ins Rate:        	  4.6984% 	    59148 	  0.2575% 	      187335
N Rate:          	 13.0469% 	   164248 	  3.0778% 	     2239012

Total time:     	120.692 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:23:42	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG.bam -RGID 1 -RGLB 135d_WY -RGPL illumina -RGPU combined_runs -RGSM 135d_WY
**********


23:23:42.946 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:23:42 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG.bam RGID=1 RGLB=135d_WY RGPL=illumina RGPU=combined_runs RGSM=135d_WY    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:23:42 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:23:43	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=135d_WY SM=135d_WY

INFO	2020-09-15 23:23:52	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|8086:128
INFO	2020-09-15 23:24:02	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|39064:1
INFO	2020-09-15 23:24:12	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 23:24:17 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.58 minutes.
Runtime.totalMemory()=3508011008
INFO	2020-09-15 23:24:22	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:24:22.369 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:24:22 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:24:22 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:24:22	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:24:22	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:24:22	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:24:24	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1110:6191:22221 1:N:0:GTCCTTCT+GACTTGTG. Cause: String 'GTCCTTCT+GACTTGTG' did not start with a parsable number.
INFO	2020-09-15 23:24:33	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|8086:128
INFO	2020-09-15 23:24:33	MarkDuplicates	Tracking 16 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-15 23:24:39	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:14s.  Time for last 1,000,000:    6s.  Last read position: lcl|39064:1
INFO	2020-09-15 23:24:39	MarkDuplicates	Tracking 58 as yet unmatched pairs. 19 records in RAM.
INFO	2020-09-15 23:24:45	MarkDuplicates	Read 2757746 records. 0 pairs never matched.
INFO	2020-09-15 23:24:49	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4745674312; totalMemory: 5843714048; maxMemory: 28631367680
INFO	2020-09-15 23:24:49	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:24:53	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	Large duplicate set. size = 3134
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	compared         3,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	Large duplicate set. size = 2366
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:24:54	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:24:54	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:24:54	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:24:55	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5766939256; totalMemory: 13020692480; maxMemory: 28631367680
INFO	2020-09-15 23:24:55	MarkDuplicates	Marking 753825 records as duplicates.
INFO	2020-09-15 23:24:55	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:24:55	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:25:33	MarkDuplicates	Before output close freeMemory: 12936805648; totalMemory: 13039566848; maxMemory: 28631367680
INFO	2020-09-15 23:25:33	MarkDuplicates	After output close freeMemory: 17102079768; totalMemory: 17288396800; maxMemory: 28631367680
[Tue Sep 15 23:25:33 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.18 minutes.
Runtime.totalMemory()=17288396800
INFO	2020-09-15 23:25:34	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG_DM.bam
**********


23:25:34.737 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:25:34 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:25:34 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:25:45	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135d_WY_sorted_RG_DM.bai
[Tue Sep 15 23:25:45 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.18 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226266m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135e_WY_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135e_WY_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135e_WY_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/135e_WY_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.051 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.527 seconds.
Analyzed Index:   	2.641 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.558 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	170616	(18470465 bases)

Mapping:          	14.784 seconds.
Reads/sec:       	11540.85
kBases/sec:      	1249.38


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.6051% 	    19284 	 17.1591% 	     3169374
bad pairs:       	  0.0117% 	       10 	  0.0105% 	        1940
insert size avg: 	  342.64


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 42.9385% 	    36630 	 34.3442% 	     2986649
unambiguous:     	 28.4182% 	    24243 	 23.7598% 	     2066210
ambiguous:       	 14.5203% 	    12387 	 10.5843% 	      920439
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.1598% 	     7814 	  5.5400% 	      481775
semiperfect site:	 13.8791% 	    11840 	  9.4057% 	      817940
rescued:         	  3.4545% 	     2947

Match Rate:      	      NA 	       NA 	 91.8894% 	     2770420
Error Rate:      	 60.3215% 	    27322 	  4.9756% 	      150013
Sub Rate:        	 58.4912% 	    26493 	  3.6994% 	      111534
Del Rate:        	  6.8618% 	     3108 	  0.9387% 	       28301
Ins Rate:        	  7.6633% 	     3471 	  0.3376% 	       10178
N Rate:          	 14.3419% 	     6496 	  3.1349% 	       94517


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 37.9343% 	    32361 	 26.9537% 	     2634513
unambiguous:     	 26.4817% 	    22591 	 19.5275% 	     1908667
ambiguous:       	 11.4526% 	     9770 	  7.4261% 	      725846
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.0075% 	     5978 	  3.8591% 	      377193
semiperfect site:	 11.4550% 	     9772 	  7.0416% 	      688267
rescued:         	  4.2540% 	     3629

Match Rate:      	      NA 	       NA 	 91.4048% 	     2433675
Error Rate:      	 55.6428% 	    24864 	  5.2276% 	      139186
Sub Rate:        	 54.0562% 	    24155 	  3.8127% 	      101513
Del Rate:        	  6.6465% 	     2970 	  1.0520% 	       28011
Ins Rate:        	  7.3336% 	     3277 	  0.3629% 	        9662
N Rate:          	 13.8480% 	     6188 	  3.3676% 	       89663

Total time:     	18.934 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:26:07	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG.bam -RGID 1 -RGLB 135e_WY -RGPL illumina -RGPU combined_runs -RGSM 135e_WY
**********


23:26:07.460 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:26:07 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG.bam RGID=1 RGLB=135e_WY RGPL=illumina RGPU=combined_runs RGSM=135e_WY    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:26:07 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:26:07	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=135e_WY SM=135e_WY

[Tue Sep 15 23:26:10 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.05 minutes.
Runtime.totalMemory()=2058354688
INFO	2020-09-15 23:26:11	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:26:11.504 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:26:11 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:26:11 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:26:11	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:26:11	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:26:11	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:26:13	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:2216:6440:12820 1:N:0:ACGTTACC+GTGAGACT. Cause: String 'ACGTTACC+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:26:15	MarkDuplicates	Read 99394 records. 0 pairs never matched.
INFO	2020-09-15 23:26:16	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1202904832; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:26:16	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:26:20	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:26:20	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:26:20	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:26:21	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2566453992; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 23:26:21	MarkDuplicates	Marking 9299 records as duplicates.
INFO	2020-09-15 23:26:21	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:26:21	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:26:24	MarkDuplicates	Before output close freeMemory: 9717681696; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 23:26:24	MarkDuplicates	After output close freeMemory: 9717757792; totalMemory: 9753853952; maxMemory: 28631367680
[Tue Sep 15 23:26:24 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.22 minutes.
Runtime.totalMemory()=9753853952
INFO	2020-09-15 23:26:25	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG_DM.bam
**********


23:26:25.398 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:26:25 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:26:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:26:29	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/135e_WY_sorted_RG_DM.bai
[Tue Sep 15 23:26:29 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.06 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226364m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshA_Man_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshA_Man_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshA_Man_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshA_Man_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.592 seconds.
Analyzed Index:   	2.954 seconds.
Started output stream:	0.024 seconds.
Cleared Memory:    	0.962 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3559570	(300124234 bases)

Mapping:          	121.793 seconds.
Reads/sec:       	29226.38
kBases/sec:      	2464.21


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.5066% 	   400569 	 22.5178% 	    67581350
bad pairs:       	  0.0130% 	      232 	  0.0120% 	       35968
insert size avg: 	  343.61


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.4912% 	   916433 	 50.4844% 	    75639692
unambiguous:     	 36.2949% 	   645971 	 36.9834% 	    55411358
ambiguous:       	 15.1963% 	   270462 	 13.5011% 	    20228334
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.8066% 	   192335 	  8.2828% 	    12409895
semiperfect site:	 15.7358% 	   280064 	 13.2615% 	    19869378
rescued:         	  3.0307% 	    53940

Match Rate:      	      NA 	       NA 	 92.3540% 	    70429392
Error Rate:      	 58.4848% 	   686151 	  4.7157% 	     3596193
Sub Rate:        	 57.4448% 	   673949 	  3.6471% 	     2781261
Del Rate:        	  6.9167% 	    81148 	  0.8137% 	      620558
Ins Rate:        	  5.6997% 	    66869 	  0.2549% 	      194374
N Rate:          	 13.3534% 	   156664 	  2.9303% 	     2234665


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.9831% 	   800603 	 44.2679% 	    66533060
unambiguous:     	 33.1232% 	   589521 	 33.6443% 	    50566186
ambiguous:       	 11.8600% 	   211082 	 10.6236% 	    15966874
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.0192% 	   142725 	  6.2440% 	     9384528
semiperfect site:	 12.6229% 	   224661 	 10.7366% 	    16136786
rescued:         	  3.6848% 	    65581

Match Rate:      	      NA 	       NA 	 91.5740% 	    61480194
Error Rate:      	 53.3687% 	   618424 	  5.0976% 	     3422397
Sub Rate:        	 52.3854% 	   607030 	  3.9229% 	     2633700
Del Rate:        	  6.6445% 	    76995 	  0.8998% 	      604103
Ins Rate:        	  5.5276% 	    64052 	  0.2750% 	      184594
N Rate:          	 13.8052% 	   159971 	  3.3284% 	     2234572

Total time:     	126.723 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:28:56	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG.bam -RGID 1 -RGLB HeshA_Man -RGPL illumina -RGPU combined_runs -RGSM HeshA_Man
**********


23:28:56.907 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:28:56 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG.bam RGID=1 RGLB=HeshA_Man RGPL=illumina RGPU=combined_runs RGSM=HeshA_Man    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:28:56 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:28:57	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=HeshA_Man SM=HeshA_Man

INFO	2020-09-15 23:29:06	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|22079:50
INFO	2020-09-15 23:29:16	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: lcl|7094:62
INFO	2020-09-15 23:29:26	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:   10s.  Last read position: */*
[Tue Sep 15 23:29:31 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.57 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-15 23:29:35	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:29:35.636 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:29:35 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:29:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:29:35	MarkDuplicates	Start of doWork freeMemory: 2037938056; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:29:35	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:29:35	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:29:37	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2211:2632:57213 1:N:0:CTGTGTTG+GTGAGACT. Cause: String 'CTGTGTTG+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:29:44	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|22079:50
INFO	2020-09-15 23:29:44	MarkDuplicates	Tracking 28 as yet unmatched pairs. 19 records in RAM.
INFO	2020-09-15 23:29:48	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|7094:62
INFO	2020-09-15 23:29:48	MarkDuplicates	Tracking 37 as yet unmatched pairs. 31 records in RAM.
INFO	2020-09-15 23:29:54	MarkDuplicates	Read 2632470 records. 0 pairs never matched.
INFO	2020-09-15 23:29:57	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4765290624; totalMemory: 5841616896; maxMemory: 28631367680
INFO	2020-09-15 23:29:57	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:30:01	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:30:01	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:30:02	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:30:03	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5760009752; totalMemory: 13012828160; maxMemory: 28631367680
INFO	2020-09-15 23:30:03	MarkDuplicates	Marking 810858 records as duplicates.
INFO	2020-09-15 23:30:03	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:30:03	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:30:39	MarkDuplicates	Before output close freeMemory: 12923848440; totalMemory: 13025411072; maxMemory: 28631367680
INFO	2020-09-15 23:30:39	MarkDuplicates	After output close freeMemory: 17103495112; totalMemory: 17288396800; maxMemory: 28631367680
[Tue Sep 15 23:30:39 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.06 minutes.
Runtime.totalMemory()=17288396800
INFO	2020-09-15 23:30:40	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG_DM.bam
**********


23:30:40.643 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:30:40 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:30:40 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:30:52	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshA_Man_sorted_RG_DM.bai
[Tue Sep 15 23:30:52 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226270m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshB_Man_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshB_Man_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshB_Man_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/HeshB_Man_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.543 seconds.
Analyzed Index:   	2.889 seconds.
Started output stream:	0.029 seconds.
Cleared Memory:    	1.179 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3229452	(264466284 bases)

Mapping:          	94.228 seconds.
Reads/sec:       	34272.74
kBases/sec:      	2806.66


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 20.4815% 	   330720 	 20.3619% 	    53850252
bad pairs:       	  0.0076% 	      123 	  0.0069% 	       18122
insert size avg: 	  425.45


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 46.1444% 	   745105 	 45.3980% 	    59943862
unambiguous:     	 30.5296% 	   492970 	 31.3897% 	    41447197
ambiguous:       	 15.6147% 	   252135 	 14.0083% 	    18496665
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 11.2236% 	   181231 	  8.5107% 	    11237559
semiperfect site:	 16.4227% 	   265182 	 13.9469% 	    18415631
rescued:         	  2.6734% 	    43168

Match Rate:      	      NA 	       NA 	 93.4616% 	    56386747
Error Rate:      	 55.4450% 	   533393 	  4.0867% 	     2465573
Sub Rate:        	 54.5942% 	   525208 	  3.2354% 	     1951934
Del Rate:        	  5.2775% 	    50771 	  0.6424% 	      387580
Ins Rate:        	  4.3442% 	    41792 	  0.2089% 	      126059
N Rate:          	 11.6524% 	   112099 	  2.4517% 	     1479122


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 39.7511% 	   641872 	 39.4674% 	    52264865
unambiguous:     	 27.7268% 	   447712 	 28.5296% 	    37780429
ambiguous:       	 12.0243% 	   194160 	 10.9378% 	    14484436
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.3312% 	   134526 	  6.4752% 	     8574770
semiperfect site:	 12.9455% 	   209034 	 11.1605% 	    14779301
rescued:         	  3.2416% 	    52343

Match Rate:      	      NA 	       NA 	 92.7461% 	    48834960
Error Rate:      	 50.0048% 	   477699 	  4.4814% 	     2359633
Sub Rate:        	 49.1855% 	   469872 	  3.5053% 	     1845718
Del Rate:        	  5.1407% 	    49109 	  0.7399% 	      389614
Ins Rate:        	  4.2509% 	    40609 	  0.2361% 	      124301
N Rate:          	 11.5728% 	   110556 	  2.7726% 	     1459886

Total time:     	99.257 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:32:50	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG.bam -RGID 1 -RGLB HeshB_Man -RGPL illumina -RGPU combined_runs -RGSM HeshB_Man
**********


23:32:50.444 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:32:50 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG.bam RGID=1 RGLB=HeshB_Man RGPL=illumina RGPU=combined_runs RGSM=HeshB_Man    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:32:50 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:32:50	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=HeshB_Man SM=HeshB_Man

INFO	2020-09-15 23:33:00	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|23709:383
INFO	2020-09-15 23:33:09	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: lcl|46137:134
INFO	2020-09-15 23:33:19	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:33:21 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.51 minutes.
Runtime.totalMemory()=2448949248
INFO	2020-09-15 23:33:25	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:33:25.327 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:33:25 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:33:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:33:25	MarkDuplicates	Start of doWork freeMemory: 2037938056; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:33:25	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:33:25	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:33:28	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1213:1076:33373 1:N:0:TGAGGTGT+GTGAGACT. Cause: String 'TGAGGTGT+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:33:33	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|23709:383
INFO	2020-09-15 23:33:33	MarkDuplicates	Tracking 1408 as yet unmatched pairs. 1392 records in RAM.
INFO	2020-09-15 23:33:38	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|46137:134
INFO	2020-09-15 23:33:38	MarkDuplicates	Tracking 18 as yet unmatched pairs. 16 records in RAM.
INFO	2020-09-15 23:33:40	MarkDuplicates	Read 2112268 records. 0 pairs never matched.
INFO	2020-09-15 23:33:43	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4807289968; totalMemory: 5856296960; maxMemory: 28631367680
INFO	2020-09-15 23:33:43	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:33:47	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:33:47	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:33:47	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:33:48	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5760581096; totalMemory: 13014925312; maxMemory: 28631367680
INFO	2020-09-15 23:33:48	MarkDuplicates	Marking 550210 records as duplicates.
INFO	2020-09-15 23:33:48	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:33:48	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:34:20	MarkDuplicates	Before output close freeMemory: 12913001432; totalMemory: 13015449600; maxMemory: 28631367680
INFO	2020-09-15 23:34:20	MarkDuplicates	After output close freeMemory: 17117334528; totalMemory: 17304125440; maxMemory: 28631367680
[Tue Sep 15 23:34:20 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.92 minutes.
Runtime.totalMemory()=17304125440
INFO	2020-09-15 23:34:21	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG_DM.bam
**********


23:34:21.967 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:34:21 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:34:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:34:31	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/HeshB_Man_sorted_RG_DM.bai
[Tue Sep 15 23:34:31 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.16 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226117m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114a_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114a_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114a_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114a_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.045 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.521 seconds.
Analyzed Index:   	2.799 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.790 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2695454	(222692135 bases)

Mapping:          	89.191 seconds.
Reads/sec:       	30221.16
kBases/sec:      	2496.80


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.9897% 	   350270 	 25.8352% 	    57532938
bad pairs:       	  0.0053% 	       71 	  0.0049% 	       11004
insert size avg: 	  384.47


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 57.1225% 	   769855 	 56.1573% 	    62450749
unambiguous:     	 37.9694% 	   511724 	 38.9871% 	    43356314
ambiguous:       	 19.1531% 	   258131 	 17.1702% 	    19094435
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.4249% 	   180931 	 10.0743% 	    11203341
semiperfect site:	 20.1202% 	   271166 	 17.0411% 	    18950922
rescued:         	  3.3278% 	    44849

Match Rate:      	      NA 	       NA 	 93.4552% 	    58689436
Error Rate:      	 56.2593% 	   556276 	  3.9742% 	     2495760
Sub Rate:        	 55.5201% 	   548967 	  3.2409% 	     2035249
Del Rate:        	  4.7916% 	    47378 	  0.5554% 	      348785
Ins Rate:        	  3.8741% 	    38306 	  0.1779% 	      111726
N Rate:          	 12.1477% 	   120113 	  2.5706% 	     1614338


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.2735% 	   664072 	 48.8987% 	    54514841
unambiguous:     	 34.5032% 	   465009 	 35.4734% 	    39547679
ambiguous:       	 14.7703% 	   199063 	 13.4252% 	    14967162
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.0002% 	   134776 	  7.6989% 	     8583101
semiperfect site:	 15.9461% 	   214910 	 13.6999% 	    15273345
rescued:         	  4.0594% 	    54709

Match Rate:      	      NA 	       NA 	 92.7722% 	    50881300
Error Rate:      	 50.5963% 	   497115 	  4.3152% 	     2366670
Sub Rate:        	 49.8959% 	   490233 	  3.5077% 	     1923835
Del Rate:        	  4.6483% 	    45670 	  0.6027% 	      330569
Ins Rate:        	  3.8542% 	    37868 	  0.2047% 	      112266
N Rate:          	 12.2148% 	   120012 	  2.9126% 	     1597440

Total time:     	93.721 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:36:21	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG.bam -RGID 1 -RGLB 114a_UT -RGPL illumina -RGPU combined_runs -RGSM 114a_UT
**********


23:36:21.492 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:36:21 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG.bam RGID=1 RGLB=114a_UT RGPL=illumina RGPU=combined_runs RGSM=114a_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:36:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:36:21	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=114a_UT SM=114a_UT

INFO	2020-09-15 23:36:31	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|15539:136
INFO	2020-09-15 23:36:40	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|39919:205
[Tue Sep 15 23:36:47 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.43 minutes.
Runtime.totalMemory()=3670540288
INFO	2020-09-15 23:36:50	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:36:51.069 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:36:51 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:36:51 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:36:51	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:36:51	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:36:51	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:36:53	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1105:7790:80427 1:N:0:GATCCATG+GTGAGACT. Cause: String 'GATCCATG+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:36:59	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|15539:136
INFO	2020-09-15 23:36:59	MarkDuplicates	Tracking 18 as yet unmatched pairs. 12 records in RAM.
INFO	2020-09-15 23:37:04	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|39919:205
INFO	2020-09-15 23:37:04	MarkDuplicates	Tracking 81 as yet unmatched pairs. 26 records in RAM.
INFO	2020-09-15 23:37:06	MarkDuplicates	Read 2167172 records. 0 pairs never matched.
INFO	2020-09-15 23:37:09	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4800999056; totalMemory: 5854724096; maxMemory: 28631367680
INFO	2020-09-15 23:37:09	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:37:13	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:37:13	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:37:13	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:37:15	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5760658688; totalMemory: 13014925312; maxMemory: 28631367680
INFO	2020-09-15 23:37:15	MarkDuplicates	Marking 561750 records as duplicates.
INFO	2020-09-15 23:37:15	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:37:15	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:37:42	MarkDuplicates	Before output close freeMemory: 12914528544; totalMemory: 13017022464; maxMemory: 28631367680
INFO	2020-09-15 23:37:42	MarkDuplicates	After output close freeMemory: 17115824200; totalMemory: 17302552576; maxMemory: 28631367680
[Tue Sep 15 23:37:42 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.86 minutes.
Runtime.totalMemory()=17302552576
INFO	2020-09-15 23:37:43	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG_DM.bam
**********


23:37:44.010 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:37:44 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:37:44 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:37:52	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114a_UT_sorted_RG_DM.bai
[Tue Sep 15 23:37:52 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226260m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114b_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114b_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114b_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114b_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.569 seconds.
Analyzed Index:   	2.841 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.317 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2028476	(167115711 bases)

Mapping:          	74.007 seconds.
Reads/sec:       	27409.29
kBases/sec:      	2258.11


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.2743% 	   266484 	 26.0637% 	    43556558
bad pairs:       	  0.0119% 	      121 	  0.0111% 	       18484
insert size avg: 	  450.79


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 59.7732% 	   606243 	 58.6548% 	    48944668
unambiguous:     	 38.2257% 	   387700 	 39.3389% 	    32826467
ambiguous:       	 21.5475% 	   218543 	 19.3159% 	    16118201
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.8059% 	   150167 	 10.9439% 	     9132202
semiperfect site:	 22.1872% 	   225031 	 18.6944% 	    15599623
rescued:         	  3.3348% 	    33823

Match Rate:      	      NA 	       NA 	 93.4338% 	    45992153
Error Rate:      	 55.1622% 	   430079 	  3.9054% 	     1922392
Sub Rate:        	 54.3617% 	   423838 	  3.1613% 	     1556147
Del Rate:        	  4.8953% 	    38167 	  0.5681% 	      279665
Ins Rate:        	  4.0443% 	    31532 	  0.1759% 	       86580
N Rate:          	 12.1744% 	    94919 	  2.6609% 	     1309788


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.8290% 	   515527 	 50.4042% 	    42173404
unambiguous:     	 34.4556% 	   349462 	 35.5218% 	    29721245
ambiguous:       	 16.3734% 	   166065 	 14.8824% 	    12452159
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.7618% 	   109150 	  8.1646% 	     6831323
semiperfect site:	 17.1648% 	   174092 	 14.6985% 	    12298337
rescued:         	  4.0885% 	    41467

Match Rate:      	      NA 	       NA 	 92.6574% 	    39338735
Error Rate:      	 49.2641% 	   381423 	  4.3285% 	     1837726
Sub Rate:        	 48.5308% 	   375745 	  3.4662% 	     1471600
Del Rate:        	  4.7742% 	    36964 	  0.6659% 	      282715
Ins Rate:        	  3.9453% 	    30546 	  0.1965% 	       83411
N Rate:          	 12.0809% 	    93535 	  3.0141% 	     1279658

Total time:     	79.140 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:39:24	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG.bam -RGID 1 -RGLB 114b_UT -RGPL illumina -RGPU combined_runs -RGSM 114b_UT
**********


23:39:24.347 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:39:24 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG.bam RGID=1 RGLB=114b_UT RGPL=illumina RGPU=combined_runs RGSM=114b_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:39:24 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:39:24	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=114b_UT SM=114b_UT

INFO	2020-09-15 23:39:34	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|30839:137
INFO	2020-09-15 23:39:44	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:39:44 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.33 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 23:39:46	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:39:47.097 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:39:47 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:39:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:39:47	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:39:47	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:39:47	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:39:49	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1207:9496:98322 1:N:0:GCCTATCA+GTGAGACT. Cause: String 'GCCTATCA+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:39:54	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|30839:137
INFO	2020-09-15 23:39:54	MarkDuplicates	Tracking 12 as yet unmatched pairs. 2 records in RAM.
INFO	2020-09-15 23:39:57	MarkDuplicates	Read 1710330 records. 0 pairs never matched.
INFO	2020-09-15 23:39:59	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2682151576; totalMemory: 3664248832; maxMemory: 28631367680
INFO	2020-09-15 23:39:59	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:40:03	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:40:03	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:40:04	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:40:05	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3641737424; totalMemory: 10852761600; maxMemory: 28631367680
INFO	2020-09-15 23:40:05	MarkDuplicates	Marking 426844 records as duplicates.
INFO	2020-09-15 23:40:05	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:40:05	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:40:25	MarkDuplicates	Before output close freeMemory: 12891168448; totalMemory: 12992905216; maxMemory: 28631367680
INFO	2020-09-15 23:40:25	MarkDuplicates	After output close freeMemory: 12787883712; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 23:40:25 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.64 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 23:40:26	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG_DM.bam
**********


23:40:26.612 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:40:26 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:40:26 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:40:34	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114b_UT_sorted_RG_DM.bai
[Tue Sep 15 23:40:34 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.12 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226338m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114c_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114c_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114c_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114c_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.537 seconds.
Analyzed Index:   	2.975 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.694 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2114372	(175524024 bases)

Mapping:          	66.420 seconds.
Reads/sec:       	31833.27
kBases/sec:      	2642.63


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 21.3026% 	   225208 	 21.1856% 	    37185744
bad pairs:       	  0.0052% 	       55 	  0.0050% 	        8758
insert size avg: 	  399.20


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.6853% 	   535838 	 49.8348% 	    43690667
unambiguous:     	 34.1885% 	   361436 	 35.1176% 	    30787952
ambiguous:       	 16.4968% 	   174402 	 14.7172% 	    12902715
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.0285% 	   127164 	  9.0438% 	     7928783
semiperfect site:	 18.0228% 	   190534 	 15.3070% 	    13419813
rescued:         	  2.6798% 	    28330

Match Rate:      	      NA 	       NA 	 93.2562% 	    40985141
Error Rate:      	 55.6769% 	   384653 	  4.0040% 	     1759722
Sub Rate:        	 54.8533% 	   378963 	  3.2116% 	     1411480
Del Rate:        	  5.1535% 	    35604 	  0.5877% 	      258285
Ins Rate:        	  4.3169% 	    29824 	  0.2047% 	       89957
N Rate:          	 12.4156% 	    85775 	  2.7397% 	     1204089


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 43.5640% 	   460553 	 43.2345% 	    37982763
unambiguous:     	 31.0514% 	   328271 	 31.9098% 	    28033717
ambiguous:       	 12.5127% 	   132282 	 11.3247% 	     9949046
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.8781% 	    93858 	  6.8334% 	     6003341
semiperfect site:	 14.1850% 	   149962 	 12.2356% 	    10749385
rescued:         	  3.3084% 	    34976

Match Rate:      	      NA 	       NA 	 92.5230% 	    35370336
Error Rate:      	 50.0293% 	   343146 	  4.3698% 	     1670533
Sub Rate:        	 49.2245% 	   337626 	  3.4891% 	     1333841
Del Rate:        	  5.0098% 	    34362 	  0.6433% 	      245940
Ins Rate:        	  4.2715% 	    29298 	  0.2374% 	       90752
N Rate:          	 12.4915% 	    85678 	  3.1072% 	     1187834

Total time:     	71.033 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:41:57	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG.bam -RGID 1 -RGLB 114c_UT -RGPL illumina -RGPU combined_runs -RGSM 114c_UT
**********


23:41:58.172 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:41:58 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG.bam RGID=1 RGLB=114c_UT RGPL=illumina RGPU=combined_runs RGSM=114c_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:41:58 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:41:58	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=114c_UT SM=114c_UT

INFO	2020-09-15 23:42:08	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|35283:39
INFO	2020-09-15 23:42:17	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:42:18 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.34 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 23:42:21	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:42:21.649 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:42:21 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:42:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:42:21	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:42:21	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:42:21	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:42:24	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2213:8826:60001 1:N:0:AACAACCG+GTGAGACT. Cause: String 'AACAACCG+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:42:30	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|35283:39
INFO	2020-09-15 23:42:30	MarkDuplicates	Tracking 40 as yet unmatched pairs. 32 records in RAM.
INFO	2020-09-15 23:42:32	MarkDuplicates	Read 1542256 records. 0 pairs never matched.
INFO	2020-09-15 23:42:35	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2692941768; totalMemory: 3663200256; maxMemory: 28631367680
INFO	2020-09-15 23:42:35	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:42:38	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:42:39	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:42:39	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:42:40	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3634648912; totalMemory: 10845945856; maxMemory: 28631367680
INFO	2020-09-15 23:42:40	MarkDuplicates	Marking 389127 records as duplicates.
INFO	2020-09-15 23:42:40	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:42:40	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:43:01	MarkDuplicates	Before output close freeMemory: 12885842832; totalMemory: 12987662336; maxMemory: 28631367680
INFO	2020-09-15 23:43:01	MarkDuplicates	After output close freeMemory: 12787800976; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 23:43:01 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.66 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 23:43:02	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG_DM.bam
**********


23:43:02.413 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:43:02 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:43:02 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:43:09	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114c_UT_sorted_RG_DM.bai
[Tue Sep 15 23:43:09 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.12 minutes.
Runtime.totalMemory()=5745672192
java -ea -Xmx226368m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114d_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114d_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114d_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/114d_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.499 seconds.
Analyzed Index:   	2.877 seconds.
Started output stream:	0.024 seconds.
Cleared Memory:    	0.783 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2620876	(211205699 bases)

Mapping:          	79.076 seconds.
Reads/sec:       	33143.96
kBases/sec:      	2670.94


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 30.8260% 	   403955 	 30.8047% 	    65061366
bad pairs:       	  0.0092% 	      120 	  0.0085% 	       17978
insert size avg: 	  313.48


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.9236% 	   745949 	 56.1214% 	    59101866
unambiguous:     	 38.4225% 	   503503 	 39.3512% 	    41441020
ambiguous:       	 18.5011% 	   242446 	 16.7702% 	    17660846
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.3488% 	   174928 	 10.1912% 	    10732382
semiperfect site:	 20.0969% 	   263358 	 17.3150% 	    18234540
rescued:         	  3.7490% 	    49128

Match Rate:      	      NA 	       NA 	 93.5282% 	    55570793
Error Rate:      	 58.4459% 	   539765 	  4.0350% 	     2397444
Sub Rate:        	 57.6079% 	   532026 	  3.3028% 	     1962376
Del Rate:        	  5.0864% 	    46974 	  0.5289% 	      314229
Ins Rate:        	  4.1376% 	    38212 	  0.2034% 	      120839
N Rate:          	 12.1829% 	   112513 	  2.4368% 	     1447858


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.1532% 	   657227 	 49.6370% 	    52563130
unambiguous:     	 35.4886% 	   465056 	 36.2268% 	    38362343
ambiguous:       	 14.6646% 	   192171 	 13.4103% 	    14200787
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.1837% 	   133451 	  7.9044% 	     8370333
semiperfect site:	 16.3720% 	   214545 	 14.2473% 	    15087159
rescued:         	  4.6613% 	    61084

Match Rate:      	      NA 	       NA 	 92.8722% 	    49101349
Error Rate:      	 53.5975% 	   492635 	  4.3746% 	     2312827
Sub Rate:        	 52.7822% 	   485141 	  3.5617% 	     1883077
Del Rate:        	  4.9660% 	    45644 	  0.5801% 	      306701
Ins Rate:        	  4.1176% 	    37846 	  0.2327% 	      123049
N Rate:          	 12.4247% 	   114200 	  2.7533% 	     1455655

Total time:     	83.649 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:44:48	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG.bam -RGID 1 -RGLB 114d_UT -RGPL illumina -RGPU combined_runs -RGSM 114d_UT
**********


23:44:48.520 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:44:48 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG.bam RGID=1 RGLB=114d_UT RGPL=illumina RGPU=combined_runs RGSM=114d_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:44:48 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:44:48	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=114d_UT SM=114d_UT

INFO	2020-09-15 23:44:58	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|17023:117
INFO	2020-09-15 23:45:07	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:45:13 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.41 minutes.
Runtime.totalMemory()=2368733184
INFO	2020-09-15 23:45:16	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:45:16.881 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:45:16 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:45:16 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:45:16	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:45:16	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:45:16	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:45:19	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1108:22214:4450 1:N:0:ACTCGTTG+GTGAGACT. Cause: String 'ACTCGTTG+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:45:25	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|17023:117
INFO	2020-09-15 23:45:25	MarkDuplicates	Tracking 6 as yet unmatched pairs. 1 records in RAM.
INFO	2020-09-15 23:45:30	MarkDuplicates	Read 1998202 records. 0 pairs never matched.
INFO	2020-09-15 23:45:33	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2656241952; totalMemory: 3668967424; maxMemory: 28631367680
INFO	2020-09-15 23:45:33	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:45:36	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:45:37	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:45:37	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:45:38	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3659126376; totalMemory: 10870587392; maxMemory: 28631367680
INFO	2020-09-15 23:45:38	MarkDuplicates	Marking 464895 records as duplicates.
INFO	2020-09-15 23:45:38	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:45:38	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:46:04	MarkDuplicates	Before output close freeMemory: 12786638616; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-15 23:46:04	MarkDuplicates	After output close freeMemory: 12901457688; totalMemory: 13004439552; maxMemory: 28631367680
[Tue Sep 15 23:46:04 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.79 minutes.
Runtime.totalMemory()=13004439552
INFO	2020-09-15 23:46:05	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG_DM.bam
**********


23:46:05.262 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:46:05 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:46:05 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:46:13	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/114d_UT_sorted_RG_DM.bai
[Tue Sep 15 23:46:13 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.14 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226339m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116a_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116a_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116a_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116a_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.497 seconds.
Analyzed Index:   	2.801 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.876 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	911962	(77430608 bases)

Mapping:          	37.969 seconds.
Reads/sec:       	24018.69
kBases/sec:      	2039.32


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 28.4128% 	   129557 	 27.6187% 	    21385366
bad pairs:       	  0.0088% 	       40 	  0.0081% 	        6272
insert size avg: 	  391.62


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 57.8270% 	   263680 	 55.6324% 	    21334418
unambiguous:     	 37.8430% 	   172557 	 38.0846% 	    14605048
ambiguous:       	 19.9839% 	    91123 	 17.5477% 	     6729370
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.4545% 	    61350 	  9.6839% 	     3713651
semiperfect site:	 20.2991% 	    92560 	 16.6649% 	     6390814
rescued:         	  3.7894% 	    17279

Match Rate:      	      NA 	       NA 	 93.4220% 	    20027842
Error Rate:      	 57.2234% 	   191561 	  3.9987% 	      857247
Sub Rate:        	 56.4837% 	   189085 	  3.3421% 	      716470
Del Rate:        	  4.9370% 	    16527 	  0.4833% 	      103614
Ins Rate:        	  3.9207% 	    13125 	  0.1734% 	       37163
N Rate:          	 12.0436% 	    40317 	  2.5793% 	      552943


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 49.6933% 	   226592 	 47.4763% 	    18554548
unambiguous:     	 34.3089% 	   156442 	 34.0354% 	    13301629
ambiguous:       	 15.3844% 	    70150 	 13.4409% 	     5252919
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.7811% 	    44600 	  7.0782% 	     2766290
semiperfect site:	 15.9950% 	    72934 	 13.1481% 	     5138485
rescued:         	  4.6544% 	    21223

Match Rate:      	      NA 	       NA 	 92.6734% 	    17290893
Error Rate:      	 51.5690% 	   171221 	  4.3885% 	      818805
Sub Rate:        	 50.8594% 	   168865 	  3.6271% 	      676741
Del Rate:        	  4.8382% 	    16064 	  0.5538% 	      103334
Ins Rate:        	  3.8241% 	    12697 	  0.2076% 	       38730
N Rate:          	 12.1214% 	    40246 	  2.9381% 	      548184

Total time:     	42.559 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:47:02	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG.bam -RGID 1 -RGLB 116a_UT -RGPL illumina -RGPU combined_runs -RGSM 116a_UT
**********


23:47:02.744 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:47:02 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG.bam RGID=1 RGLB=116a_UT RGPL=illumina RGPU=combined_runs RGSM=116a_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:47:02 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:47:02	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=116a_UT SM=116a_UT

[Tue Sep 15 23:47:12 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.16 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 23:47:14	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:47:14.545 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:47:14 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:47:14 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:47:14	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:47:14	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:47:14	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:47:16	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1107:21185:78181 1:N:0:CCTATGGT+GTGAGACT. Cause: String 'CCTATGGT+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:47:20	MarkDuplicates	Read 721350 records. 0 pairs never matched.
INFO	2020-09-15 23:47:22	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1690376056; totalMemory: 2595749888; maxMemory: 28631367680
INFO	2020-09-15 23:47:22	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:47:25	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:47:26	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:47:26	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:47:26	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2564229336; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-15 23:47:26	MarkDuplicates	Marking 130212 records as duplicates.
INFO	2020-09-15 23:47:26	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:47:27	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:47:36	MarkDuplicates	Before output close freeMemory: 10769289888; totalMemory: 10828644352; maxMemory: 28631367680
INFO	2020-09-15 23:47:37	MarkDuplicates	After output close freeMemory: 10769289888; totalMemory: 10828644352; maxMemory: 28631367680
[Tue Sep 15 23:47:37 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.38 minutes.
Runtime.totalMemory()=10828644352
INFO	2020-09-15 23:47:37	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG_DM.bam
**********


23:47:38.095 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:47:38 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:47:38 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:47:42	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116a_UT_sorted_RG_DM.bai
[Tue Sep 15 23:47:42 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.08 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226301m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116b_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116b_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116b_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116b_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.512 seconds.
Analyzed Index:   	2.693 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	1.197 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2055328	(172050793 bases)

Mapping:          	72.298 seconds.
Reads/sec:       	28428.48
kBases/sec:      	2379.74


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 18.5065% 	   190185 	 18.4791% 	    31793490
bad pairs:       	  0.0111% 	      114 	  0.0106% 	       18314
insert size avg: 	  467.69


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.6336% 	   530620 	 50.6585% 	    43567488
unambiguous:     	 35.3249% 	   363021 	 36.2078% 	    31139515
ambiguous:       	 16.3087% 	   167599 	 14.4507% 	    12427973
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.0255% 	   123582 	  9.2524% 	     7957306
semiperfect site:	 17.4881% 	   179719 	 14.8810% 	    12797968
rescued:         	  2.5598% 	    26306

Match Rate:      	      NA 	       NA 	 93.0249% 	    40773447
Error Rate:      	 54.8571% 	   384954 	  4.1415% 	     1815266
Sub Rate:        	 53.7439% 	   377142 	  3.3210% 	     1455612
Del Rate:        	  5.4842% 	    38485 	  0.6004% 	      263176
Ins Rate:        	  5.0485% 	    35427 	  0.2201% 	       96478
N Rate:          	 12.3852% 	    86912 	  2.8335% 	     1241951


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.3621% 	   455893 	 43.9265% 	    37798130
unambiguous:     	 31.6773% 	   325536 	 32.4728% 	    27942316
ambiguous:       	 12.6848% 	   130357 	 11.4538% 	     9855814
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.9745% 	    92228 	  7.0496% 	     6066064
semiperfect site:	 13.8430% 	   142260 	 11.9281% 	    10263986
rescued:         	  3.0811% 	    31663

Match Rate:      	      NA 	       NA 	 92.2620% 	    35105749
Error Rate:      	 49.1737% 	   341676 	  4.5211% 	     1720272
Sub Rate:        	 48.1796% 	   334769 	  3.6070% 	     1372448
Del Rate:        	  5.2309% 	    36346 	  0.6621% 	      251917
Ins Rate:        	  4.9173% 	    34167 	  0.2521% 	       95907
N Rate:          	 12.4460% 	    86479 	  3.2169% 	     1224026

Total time:     	77.104 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:49:12	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG.bam -RGID 1 -RGLB 116b_UT -RGPL illumina -RGPU combined_runs -RGSM 116b_UT
**********


23:49:12.417 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:49:12 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG.bam RGID=1 RGLB=116b_UT RGPL=illumina RGPU=combined_runs RGSM=116b_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:49:12 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:49:12	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=116b_UT SM=116b_UT

INFO	2020-09-15 23:49:22	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|33626:84
INFO	2020-09-15 23:49:31	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:49:31 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.33 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-15 23:49:34	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:49:34.922 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:49:34 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:49:34 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:49:35	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:49:35	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:49:35	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:49:37	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1105:17116:19180 1:N:0:TGTACACC+GTGAGACT. Cause: String 'TGTACACC+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:49:43	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|33626:84
INFO	2020-09-15 23:49:43	MarkDuplicates	Tracking 97 as yet unmatched pairs. 94 records in RAM.
INFO	2020-09-15 23:49:46	MarkDuplicates	Read 1592428 records. 0 pairs never matched.
INFO	2020-09-15 23:49:48	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2693466320; totalMemory: 3660054528; maxMemory: 28631367680
INFO	2020-09-15 23:49:48	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:49:52	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:49:52	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:49:52	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:49:53	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3630917976; totalMemory: 10841751552; maxMemory: 28631367680
INFO	2020-09-15 23:49:53	MarkDuplicates	Marking 465558 records as duplicates.
INFO	2020-09-15 23:49:53	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:49:53	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:50:14	MarkDuplicates	Before output close freeMemory: 12882274784; totalMemory: 12983468032; maxMemory: 28631367680
INFO	2020-09-15 23:50:14	MarkDuplicates	After output close freeMemory: 12788427232; totalMemory: 12889620480; maxMemory: 28631367680
[Tue Sep 15 23:50:14 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.66 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-15 23:50:15	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG_DM.bam
**********


23:50:15.550 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:50:15 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:50:15 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:50:23	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116b_UT_sorted_RG_DM.bai
[Tue Sep 15 23:50:23 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.13 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226473m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116c_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116c_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116c_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116c_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.047 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.523 seconds.
Analyzed Index:   	2.663 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.541 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	7364236	(611819447 bases)

Mapping:          	231.808 seconds.
Reads/sec:       	31768.64
kBases/sec:      	2639.33


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 24.4392% 	   899879 	 24.5159% 	   149993270
bad pairs:       	  0.0083% 	      305 	  0.0078% 	       47492
insert size avg: 	  382.13


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 56.3771% 	  2075870 	 55.4707% 	   169674667
unambiguous:     	 39.3411% 	  1448585 	 40.1837% 	   122914561
ambiguous:       	 17.0360% 	   627285 	 15.2870% 	    46760106
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.9756% 	   477777 	 10.1282% 	    30980248
semiperfect site:	 18.8186% 	   692922 	 16.2616% 	    49741249
rescued:         	  3.4506% 	   127056

Match Rate:      	      NA 	       NA 	 93.1282% 	   159122062
Error Rate:      	 56.3592% 	  1510119 	  4.4735% 	     7643537
Sub Rate:        	 55.4739% 	  1486396 	  3.5497% 	     6065195
Del Rate:        	  5.9368% 	   159073 	  0.6958% 	     1188855
Ins Rate:        	  4.8891% 	   131002 	  0.2280% 	      389487
N Rate:          	 12.0669% 	   323328 	  2.3984% 	     4097923


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.8440% 	  1798493 	 48.6107% 	   148718445
unambiguous:     	 35.8354% 	  1319502 	 36.7428% 	   112410198
ambiguous:       	 13.0086% 	   478991 	 11.8679% 	    36308247
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.5422% 	   351356 	  7.6819% 	    23501916
semiperfect site:	 14.8512% 	   546838 	 13.1056% 	    40095000
rescued:         	  4.1169% 	   151589

Match Rate:      	      NA 	       NA 	 92.2967% 	   138326623
Error Rate:      	 50.9926% 	  1356355 	  4.8602% 	     7284026
Sub Rate:        	 50.1491% 	  1333919 	  3.8257% 	     5733593
Del Rate:        	  5.8223% 	   154867 	  0.7695% 	     1153310
Ins Rate:        	  4.7975% 	   127608 	  0.2650% 	      397123
N Rate:          	 12.6961% 	   337703 	  2.8432% 	     4261106

Total time:     	235.951 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-15 23:55:01	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG.bam -RGID 1 -RGLB 116c_UT -RGPL illumina -RGPU combined_runs -RGSM 116c_UT
**********


23:55:01.544 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:55:01 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG.bam RGID=1 RGLB=116c_UT RGPL=illumina RGPU=combined_runs RGSM=116c_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:55:01 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:55:01	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=116c_UT SM=116c_UT

INFO	2020-09-15 23:55:10	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|11745:9
INFO	2020-09-15 23:55:19	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|12082:37
INFO	2020-09-15 23:55:28	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    9s.  Last read position: lcl|14549:72
INFO	2020-09-15 23:55:37	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:35s.  Time for last 1,000,000:    8s.  Last read position: lcl|35434:12
INFO	2020-09-15 23:55:45	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:    8s.  Last read position: lcl|27071:10
INFO	2020-09-15 23:55:54	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:52s.  Time for last 1,000,000:    9s.  Last read position: */*
INFO	2020-09-15 23:56:04	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:02s.  Time for last 1,000,000:    9s.  Last read position: */*
[Tue Sep 15 23:56:06 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.08 minutes.
Runtime.totalMemory()=3192389632
INFO	2020-09-15 23:56:14	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


23:56:14.620 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:56:14 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:56:14 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:56:14	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-15 23:56:14	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-15 23:56:14	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-15 23:56:17	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1111:6750:58161 1:N:0:GTATGCTG+GTGAGACT. Cause: String 'GTATGCTG+GTGAGACT' did not start with a parsable number.
INFO	2020-09-15 23:56:21	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:04s.  Time for last 1,000,000:    4s.  Last read position: lcl|11745:9
INFO	2020-09-15 23:56:21	MarkDuplicates	Tracking 160 as yet unmatched pairs. 48 records in RAM.
INFO	2020-09-15 23:56:27	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|12082:37
INFO	2020-09-15 23:56:27	MarkDuplicates	Tracking 165 as yet unmatched pairs. 88 records in RAM.
INFO	2020-09-15 23:56:33	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    6s.  Last read position: lcl|14549:72
INFO	2020-09-15 23:56:33	MarkDuplicates	Tracking 42 as yet unmatched pairs. 5 records in RAM.
INFO	2020-09-15 23:56:39	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    5s.  Last read position: lcl|35434:12
INFO	2020-09-15 23:56:39	MarkDuplicates	Tracking 39 as yet unmatched pairs. 4 records in RAM.
INFO	2020-09-15 23:56:46	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:    6s.  Last read position: lcl|27071:10
INFO	2020-09-15 23:56:46	MarkDuplicates	Tracking 36 as yet unmatched pairs. 27 records in RAM.
INFO	2020-09-15 23:56:50	MarkDuplicates	Read 5948358 records. 0 pairs never matched.
INFO	2020-09-15 23:56:56	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8801189512; totalMemory: 10153361408; maxMemory: 28631367680
INFO	2020-09-15 23:56:56	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-15 23:56:59	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-15 23:57:20	OpticalDuplicateFinder	Large duplicate set. size = 2314
INFO	2020-09-15 23:57:20	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:57:20	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:57:20	OpticalDuplicateFinder	Large duplicate set. size = 2194
INFO	2020-09-15 23:57:20	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:57:20	OpticalDuplicateFinder	compared         2,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-15 23:57:21	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-15 23:57:21	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-15 23:57:22	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15926764328; totalMemory: 23220715520; maxMemory: 28631367680
INFO	2020-09-15 23:57:22	MarkDuplicates	Marking 2145958 records as duplicates.
INFO	2020-09-15 23:57:22	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-15 23:57:22	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-15 23:58:31	MarkDuplicates	Before output close freeMemory: 23044892832; totalMemory: 23213899776; maxMemory: 28631367680
INFO	2020-09-15 23:58:31	MarkDuplicates	After output close freeMemory: 22836226208; totalMemory: 23005233152; maxMemory: 28631367680
[Tue Sep 15 23:58:31 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.28 minutes.
Runtime.totalMemory()=23005233152
INFO	2020-09-15 23:58:32	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG_DM.bam
**********


23:58:32.562 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Tue Sep 15 23:58:32 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Tue Sep 15 23:58:32 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-15 23:58:52	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116c_UT_sorted_RG_DM.bai
[Tue Sep 15 23:58:52 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.33 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226313m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116d_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116d_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116d_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116d_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.550 seconds.
Analyzed Index:   	3.084 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.219 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	5915974	(496889173 bases)

Mapping:          	172.903 seconds.
Reads/sec:       	34215.60
kBases/sec:      	2873.81


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 25.1261% 	   743227 	 25.2064% 	   125247720
bad pairs:       	  0.0083% 	      246 	  0.0075% 	       37446
insert size avg: 	  367.16


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 55.6974% 	  1647523 	 54.5468% 	   135288997
unambiguous:     	 38.8499% 	  1149176 	 39.6379% 	    98311450
ambiguous:       	 16.8475% 	   498347 	 14.9089% 	    36977547
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.3740% 	   395602 	 10.2517% 	    25426564
semiperfect site:	 19.4835% 	   576318 	 16.5762% 	    41112885
rescued:         	  3.2195% 	    95232

Match Rate:      	      NA 	       NA 	 92.9576% 	   126556104
Error Rate:      	 56.0268% 	  1176924 	  4.2084% 	     5729524
Sub Rate:        	 55.1531% 	  1158569 	  3.3791% 	     4600502
Del Rate:        	  5.6368% 	   118408 	  0.6280% 	      854922
Ins Rate:        	  4.5356% 	    95276 	  0.2013% 	      274100
N Rate:          	 12.6882% 	   266534 	  2.8340% 	     3858291


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 48.2655% 	  1427686 	 47.6934% 	   118692223
unambiguous:     	 35.4312% 	  1048050 	 36.1540% 	    89974754
ambiguous:       	 12.8343% 	   379636 	 11.5394% 	    28717469
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.8431% 	   291157 	  7.7442% 	    19272639
semiperfect site:	 15.5267% 	   459277 	 13.4383% 	    33443318
rescued:         	  3.8670% 	   114384

Match Rate:      	      NA 	       NA 	 92.0956% 	   110089403
Error Rate:      	 50.7635% 	  1057552 	  4.5849% 	     5480690
Sub Rate:        	 49.9202% 	  1039984 	  3.6451% 	     4357307
Del Rate:        	  5.5642% 	   115919 	  0.7077% 	      846000
Ins Rate:        	  4.4777% 	    93284 	  0.2320% 	      277383
N Rate:          	 13.4296% 	   279777 	  3.3195% 	     3968130

Total time:     	178.172 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:02:23	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG.bam -RGID 1 -RGLB 116d_UT -RGPL illumina -RGPU combined_runs -RGSM 116d_UT
**********


00:02:24.094 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:02:24 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG.bam RGID=1 RGLB=116d_UT RGPL=illumina RGPU=combined_runs RGSM=116d_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:02:24 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:02:24	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=116d_UT SM=116d_UT

INFO	2020-09-16 00:02:33	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|12172:87
INFO	2020-09-16 00:02:42	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    8s.  Last read position: lcl|19571:47
INFO	2020-09-16 00:02:52	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|31720:87
INFO	2020-09-16 00:03:01	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    9s.  Last read position: lcl|43440:57
INFO	2020-09-16 00:03:11	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:47s.  Time for last 1,000,000:   10s.  Last read position: */*
[Wed Sep 16 00:03:19 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.92 minutes.
Runtime.totalMemory()=2311061504
INFO	2020-09-16 00:03:26	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:03:26.325 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:03:26 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:03:26 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:03:26	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:03:26	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:03:26	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:03:28	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:1107:8509:6639 1:N:0:TGATGTCC+GTGAGACT. Cause: String 'TGATGTCC+GTGAGACT' did not start with a parsable number.
INFO	2020-09-16 00:03:35	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|12172:87
INFO	2020-09-16 00:03:35	MarkDuplicates	Tracking 29 as yet unmatched pairs. 14 records in RAM.
INFO	2020-09-16 00:03:41	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:12s.  Time for last 1,000,000:    5s.  Last read position: lcl|19571:47
INFO	2020-09-16 00:03:41	MarkDuplicates	Tracking 380 as yet unmatched pairs. 355 records in RAM.
INFO	2020-09-16 00:03:47	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    6s.  Last read position: lcl|31720:87
INFO	2020-09-16 00:03:47	MarkDuplicates	Tracking 29 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-16 00:03:53	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:    5s.  Last read position: lcl|43440:57
INFO	2020-09-16 00:03:53	MarkDuplicates	Tracking 277 as yet unmatched pairs. 268 records in RAM.
INFO	2020-09-16 00:03:57	MarkDuplicates	Read 4663472 records. 0 pairs never matched.
INFO	2020-09-16 00:04:02	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8895624088; totalMemory: 10180624384; maxMemory: 28631367680
INFO	2020-09-16 00:04:02	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:04:06	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:04:22	OpticalDuplicateFinder	Large duplicate set. size = 1369
INFO	2020-09-16 00:04:22	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-16 00:04:22	OpticalDuplicateFinder	Large duplicate set. size = 1133
INFO	2020-09-16 00:04:22	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-16 00:04:22	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:04:23	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:04:24	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15175633880; totalMemory: 22538616832; maxMemory: 28631367680
INFO	2020-09-16 00:04:24	MarkDuplicates	Marking 1575224 records as duplicates.
INFO	2020-09-16 00:04:24	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:04:24	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:05:22	MarkDuplicates	Before output close freeMemory: 22134567352; totalMemory: 22346727424; maxMemory: 28631367680
INFO	2020-09-16 00:05:22	MarkDuplicates	After output close freeMemory: 22318668536; totalMemory: 22530752512; maxMemory: 28631367680
[Wed Sep 16 00:05:22 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.94 minutes.
Runtime.totalMemory()=22530752512
INFO	2020-09-16 00:05:23	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG_DM.bam
**********


00:05:24.121 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:05:24 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:05:24 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:05:39	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116d_UT_sorted_RG_DM.bai
[Wed Sep 16 00:05:39 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.25 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226413m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116e_UT_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116e_UT_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116e_UT_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/116e_UT_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.048 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.531 seconds.
Analyzed Index:   	2.967 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.559 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3768142	(306700660 bases)

Mapping:          	122.878 seconds.
Reads/sec:       	30665.64
kBases/sec:      	2495.97


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 28.4606% 	   536218 	 28.2539% 	    86654944
bad pairs:       	  0.0111% 	      209 	  0.0102% 	       31400
insert size avg: 	  410.49


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 60.3371% 	  1136793 	 59.3110% 	    90811547
unambiguous:     	 38.4613% 	   724639 	 39.5475% 	    60551418
ambiguous:       	 21.8757% 	   412154 	 19.7636% 	    30260129
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.8389% 	   279576 	 11.0828% 	    16969017
semiperfect site:	 22.5062% 	   424033 	 19.1733% 	    29356374
rescued:         	  3.4850% 	    65660

Match Rate:      	      NA 	       NA 	 93.5574% 	    85362483
Error Rate:      	 55.6100% 	   807268 	  3.7286% 	     3401969
Sub Rate:        	 54.6126% 	   792789 	  3.0731% 	     2803915
Del Rate:        	  4.7058% 	    68312 	  0.4704% 	      429185
Ins Rate:        	  4.2395% 	    61543 	  0.1851% 	      168869
N Rate:          	 12.4867% 	   181264 	  2.7140% 	     2476280


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.7171% 	   974387 	 51.3181% 	    78819341
unambiguous:     	 34.7934% 	   655533 	 35.8191% 	    55014580
ambiguous:       	 16.9237% 	   318854 	 15.4989% 	    23804761
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.8181% 	   203820 	  8.2497% 	    12670683
semiperfect site:	 17.6210% 	   331993 	 15.2434% 	    23412379
rescued:         	  4.3631% 	    82204

Match Rate:      	      NA 	       NA 	 92.8428% 	    73573267
Error Rate:      	 50.0331% 	   722409 	  4.1077% 	     3255132
Sub Rate:        	 49.1233% 	   709272 	  3.3593% 	     2662079
Del Rate:        	  4.5617% 	    65864 	  0.5371% 	      425611
Ins Rate:        	  4.1375% 	    59740 	  0.2113% 	      167442
N Rate:          	 12.3344% 	   178091 	  3.0495% 	     2416553

Total time:     	127.362 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:08:07	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG.bam -RGID 1 -RGLB 116e_UT -RGPL illumina -RGPU combined_runs -RGSM 116e_UT
**********


00:08:08.222 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:08:08 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG.bam RGID=1 RGLB=116e_UT RGPL=illumina RGPU=combined_runs RGSM=116e_UT    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:08:08 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:08:08	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=116e_UT SM=116e_UT

INFO	2020-09-16 00:08:17	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|11034:87
INFO	2020-09-16 00:08:26	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|32105:32
INFO	2020-09-16 00:08:35	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|45744:1
[Wed Sep 16 00:08:42 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.58 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-16 00:08:47	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:08:47.557 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:08:47 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:08:47 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:08:47	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:08:47	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:08:47	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:08:50	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2109:22443:24212 1:N:0:GTCCTTCT+GTGAGACT. Cause: String 'GTCCTTCT+GTGAGACT' did not start with a parsable number.
INFO	2020-09-16 00:08:54	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:04s.  Time for last 1,000,000:    4s.  Last read position: lcl|11034:87
INFO	2020-09-16 00:08:54	MarkDuplicates	Tracking 4874 as yet unmatched pairs. 4865 records in RAM.
INFO	2020-09-16 00:09:00	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|32105:32
INFO	2020-09-16 00:09:00	MarkDuplicates	Tracking 42 as yet unmatched pairs. 11 records in RAM.
INFO	2020-09-16 00:09:07	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    6s.  Last read position: lcl|45744:1
INFO	2020-09-16 00:09:07	MarkDuplicates	Tracking 20 as yet unmatched pairs. 17 records in RAM.
INFO	2020-09-16 00:09:07	MarkDuplicates	Read 3149506 records. 0 pairs never matched.
INFO	2020-09-16 00:09:11	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4743515424; totalMemory: 5859442688; maxMemory: 28631367680
INFO	2020-09-16 00:09:11	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:09:15	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:09:15	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:09:16	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:09:17	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5800295072; totalMemory: 13055295488; maxMemory: 28631367680
INFO	2020-09-16 00:09:17	MarkDuplicates	Marking 929538 records as duplicates.
INFO	2020-09-16 00:09:17	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:09:17	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:09:53	MarkDuplicates	Before output close freeMemory: 17167357800; totalMemory: 17353932800; maxMemory: 28631367680
INFO	2020-09-16 00:09:53	MarkDuplicates	After output close freeMemory: 17013741416; totalMemory: 17200316416; maxMemory: 28631367680
[Wed Sep 16 00:09:53 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.10 minutes.
Runtime.totalMemory()=17200316416
INFO	2020-09-16 00:09:54	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG_DM.bam
**********


00:09:54.804 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:09:54 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:09:54 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:10:06	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/116e_UT_sorted_RG_DM.bai
[Wed Sep 16 00:10:06 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226468m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29a_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29a_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29a_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29a_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.533 seconds.
Analyzed Index:   	2.979 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.705 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4548114	(370676382 bases)

Mapping:          	95.492 seconds.
Reads/sec:       	47628.17
kBases/sec:      	3881.75


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 12.3891% 	   281736 	 12.4245% 	    46054760
bad pairs:       	  0.0059% 	      135 	  0.0057% 	       21202
insert size avg: 	  412.77


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 30.7384% 	   699008 	 30.6064% 	    56631979
unambiguous:     	 20.7107% 	   470973 	 21.5573% 	    39888178
ambiguous:       	 10.0277% 	   228035 	  9.0491% 	    16743801
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.9069% 	   179807 	  6.1149% 	    11314503
semiperfect site:	 11.5821% 	   263384 	 10.0529% 	    18601147
rescued:         	  1.6162% 	    36754

Match Rate:      	      NA 	       NA 	 93.0863% 	    53164461
Error Rate:      	 53.9351% 	   485936 	  4.1342% 	     2361188
Sub Rate:        	 52.7430% 	   475195 	  3.0277% 	     1729195
Del Rate:        	  6.5815% 	    59297 	  0.8424% 	      481122
Ins Rate:        	  5.2387% 	    47199 	  0.2642% 	      150871
N Rate:          	 12.6165% 	   113670 	  2.7795% 	     1587452


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 25.9952% 	   591145 	 26.1368% 	    48521265
unambiguous:     	 18.4944% 	   420573 	 19.2715% 	    35776305
ambiguous:       	  7.5008% 	   170572 	  6.8653% 	    12744960
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  5.6903% 	   129400 	  4.5208% 	     8392635
semiperfect site:	  9.0079% 	   204845 	  7.9844% 	    14822460
rescued:         	  2.0160% 	    45845

Match Rate:      	      NA 	       NA 	 92.1854% 	    45166372
Error Rate:      	 47.8029% 	   427001 	  4.5755% 	     2241766
Sub Rate:        	 46.6588% 	   416781 	  3.2996% 	     1616655
Del Rate:        	  6.3961% 	    57133 	  0.9672% 	      473898
Ins Rate:        	  5.1765% 	    46239 	  0.3086% 	      151213
N Rate:          	 12.9829% 	   115970 	  3.2391% 	     1587025

Total time:     	100.122 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:12:11	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG.bam -RGID 1 -RGLB 29a_OR -RGPL illumina -RGPU combined_runs -RGSM 29a_OR
**********


00:12:11.879 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:12:11 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG.bam RGID=1 RGLB=29a_OR RGPL=illumina RGPU=combined_runs RGSM=29a_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:12:11 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:12:12	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=29a_OR SM=29a_OR

INFO	2020-09-16 00:12:21	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|17516:11
INFO	2020-09-16 00:12:30	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|46718:79
INFO	2020-09-16 00:12:42	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:30s.  Time for last 1,000,000:   11s.  Last read position: */*
INFO	2020-09-16 00:12:50	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:38s.  Time for last 1,000,000:    8s.  Last read position: */*
[Wed Sep 16 00:12:54 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.71 minutes.
Runtime.totalMemory()=2404909056
INFO	2020-09-16 00:12:59	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:12:59.471 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:12:59 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:12:59 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:12:59	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:12:59	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:12:59	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:13:01	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1107:16906:59222 1:N:0:ACGTTACC+GTTCCATG. Cause: String 'ACGTTACC+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:13:08	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|17516:11
INFO	2020-09-16 00:13:08	MarkDuplicates	Tracking 117 as yet unmatched pairs. 111 records in RAM.
INFO	2020-09-16 00:13:12	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|46718:79
INFO	2020-09-16 00:13:12	MarkDuplicates	Tracking 130 as yet unmatched pairs. 99 records in RAM.
INFO	2020-09-16 00:13:12	MarkDuplicates	Read 2016564 records. 0 pairs never matched.
INFO	2020-09-16 00:13:16	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2667938424; totalMemory: 3663200256; maxMemory: 28631367680
INFO	2020-09-16 00:13:16	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:13:19	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:13:20	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:13:20	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:13:21	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3646500632; totalMemory: 10857480192; maxMemory: 28631367680
INFO	2020-09-16 00:13:21	MarkDuplicates	Marking 592200 records as duplicates.
INFO	2020-09-16 00:13:21	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:13:21	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:14:04	MarkDuplicates	Before output close freeMemory: 12787884968; totalMemory: 12889620480; maxMemory: 28631367680
INFO	2020-09-16 00:14:04	MarkDuplicates	After output close freeMemory: 12891169704; totalMemory: 12992905216; maxMemory: 28631367680
[Wed Sep 16 00:14:04 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.09 minutes.
Runtime.totalMemory()=12992905216
INFO	2020-09-16 00:14:05	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG_DM.bam
**********


00:14:06.021 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:14:06 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:14:06 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:14:17	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29a_OR_sorted_RG_DM.bai
[Wed Sep 16 00:14:17 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226572m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29b_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29b_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29b_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/29b_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.049 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.518 seconds.
Analyzed Index:   	3.338 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	1.196 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	4776304	(393917488 bases)

Mapping:          	143.645 seconds.
Reads/sec:       	33250.68
kBases/sec:      	2742.29


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.9145% 	   547234 	 22.6496% 	    89220604
bad pairs:       	  0.0083% 	      199 	  0.0074% 	       29210
insert size avg: 	  440.06


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.4944% 	  1301408 	 53.5581% 	   105316027
unambiguous:     	 35.8323% 	   855729 	 37.0024% 	    72761087
ambiguous:       	 18.6621% 	   445679 	 16.5557% 	    32554940
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 14.8394% 	   354387 	 11.2147% 	    22052514
semiperfect site:	 21.6248% 	   516434 	 18.4502% 	    36280139
rescued:         	  2.7935% 	    66712

Match Rate:      	      NA 	       NA 	 93.8100% 	    99449384
Error Rate:      	 53.1259% 	   887472 	  3.7904% 	     4018250
Sub Rate:        	 52.3590% 	   874661 	  2.9456% 	     3122719
Del Rate:        	  5.4037% 	    90270 	  0.6560% 	      695453
Ins Rate:        	  3.8609% 	    64496 	  0.1887% 	      200078
N Rate:          	 11.4399% 	   191104 	  2.3996% 	     2543846


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 44.6660% 	  1066693 	 44.4196% 	    87630442
unambiguous:     	 31.3201% 	   747972 	 32.3969% 	    63912173
ambiguous:       	 13.3459% 	   318721 	 12.0227% 	    23718269
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.1434% 	   242240 	  7.9181% 	    15620676
semiperfect site:	 16.0317% 	   382862 	 13.9814% 	    27582305
rescued:         	  3.4399% 	    82151

Match Rate:      	      NA 	       NA 	 92.8042% 	    81946632
Error Rate:      	 46.2998% 	   764102 	  4.2824% 	     3781341
Sub Rate:        	 45.6176% 	   752843 	  3.2994% 	     2913407
Del Rate:        	  5.1839% 	    85552 	  0.7589% 	      670075
Ins Rate:        	  3.7515% 	    61913 	  0.2241% 	      197859
N Rate:          	 11.8674% 	   195852 	  2.9134% 	     2572544

Total time:     	149.140 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:17:14	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG.bam -RGID 1 -RGLB 29b_OR -RGPL illumina -RGPU combined_runs -RGSM 29b_OR
**********


00:17:14.319 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:17:14 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG.bam RGID=1 RGLB=29b_OR RGPL=illumina RGPU=combined_runs RGSM=29b_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:17:14 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:17:14	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=29b_OR SM=29b_OR

INFO	2020-09-16 00:17:23	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|3170:89
INFO	2020-09-16 00:17:32	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    9s.  Last read position: lcl|863:73
INFO	2020-09-16 00:17:41	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:27s.  Time for last 1,000,000:    9s.  Last read position: lcl|40859:32
INFO	2020-09-16 00:17:52	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:37s.  Time for last 1,000,000:   10s.  Last read position: */*
[Wed Sep 16 00:17:58 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.73 minutes.
Runtime.totalMemory()=2344091648
INFO	2020-09-16 00:18:03	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:18:03.988 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:18:04 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:18:04 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:18:04	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:18:04	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:18:04	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:18:06	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2110:13152:84020 1:N:0:CTGTGTTG+GTTCCATG. Cause: String 'CTGTGTTG+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:18:11	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|3170:89
INFO	2020-09-16 00:18:11	MarkDuplicates	Tracking 57 as yet unmatched pairs. 29 records in RAM.
INFO	2020-09-16 00:18:17	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    5s.  Last read position: lcl|863:73
INFO	2020-09-16 00:18:17	MarkDuplicates	Tracking 92 as yet unmatched pairs. 76 records in RAM.
INFO	2020-09-16 00:18:23	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    6s.  Last read position: lcl|40859:32
INFO	2020-09-16 00:18:23	MarkDuplicates	Tracking 272 as yet unmatched pairs. 199 records in RAM.
INFO	2020-09-16 00:18:27	MarkDuplicates	Read 3641336 records. 0 pairs never matched.
INFO	2020-09-16 00:18:30	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4721507792; totalMemory: 5856821248; maxMemory: 28631367680
INFO	2020-09-16 00:18:30	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:18:34	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:18:35	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:18:35	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:18:36	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5803940408; totalMemory: 13058965504; maxMemory: 28631367680
INFO	2020-09-16 00:18:36	MarkDuplicates	Marking 1101432 records as duplicates.
INFO	2020-09-16 00:18:36	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:18:36	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:19:22	MarkDuplicates	Before output close freeMemory: 17169821400; totalMemory: 17357602816; maxMemory: 28631367680
INFO	2020-09-16 00:19:22	MarkDuplicates	After output close freeMemory: 17014632152; totalMemory: 17202413568; maxMemory: 28631367680
[Wed Sep 16 00:19:22 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.31 minutes.
Runtime.totalMemory()=17202413568
INFO	2020-09-16 00:19:23	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG_DM.bam
**********


00:19:23.937 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:19:23 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:19:23 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:19:36	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/29b_OR_sorted_RG_DM.bai
[Wed Sep 16 00:19:36 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.22 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226360m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350a_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350a_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350a_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350a_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.043 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.503 seconds.
Analyzed Index:   	2.954 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.703 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	12468898	(1021588630 bases)

Mapping:          	341.882 seconds.
Reads/sec:       	36471.34
kBases/sec:      	2988.13


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 28.1918% 	  1757606 	 28.3811% 	   289938086
bad pairs:       	  0.0116% 	      722 	  0.0103% 	      104844
insert size avg: 	  335.43


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 54.5602% 	  3401528 	 53.9306% 	   275085153
unambiguous:     	 37.4279% 	  2333423 	 38.4756% 	   196253499
ambiguous:       	 17.1323% 	  1068105 	 15.4550% 	    78831654
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 13.5218% 	   843012 	 10.3956% 	    53025153
semiperfect site:	 20.2331% 	  1261423 	 17.5384% 	    89458469
rescued:         	  3.5395% 	   220669

Match Rate:      	      NA 	       NA 	 93.5103% 	   259121579
Error Rate:      	 56.7632% 	  2408989 	  4.1816% 	    11587276
Sub Rate:        	 55.9329% 	  2373751 	  3.2287% 	     8946801
Del Rate:        	  6.1575% 	   261319 	  0.7288% 	     2019633
Ins Rate:        	  4.5750% 	   194158 	  0.2240% 	      620842
N Rate:          	 11.8616% 	   503399 	  2.3081% 	     6395931


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 47.3751% 	  2953579 	 47.4124% 	   242522169
unambiguous:     	 34.1318% 	  2127931 	 35.2315% 	   180214922
ambiguous:       	 13.2433% 	   825648 	 12.1809% 	    62307247
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  9.8756% 	   615691 	  7.8444% 	    40125252
semiperfect site:	 16.0460% 	  1000381 	 14.2562% 	    72922511
rescued:         	  4.3856% 	   273416

Match Rate:      	      NA 	       NA 	 92.7116% 	   226713729
Error Rate:      	 51.7218% 	  2183946 	  4.5793% 	    11198143
Sub Rate:        	 50.9340% 	  2150680 	  3.5046% 	     8570013
Del Rate:        	  6.0590% 	   255841 	  0.8238% 	     2014435
Ins Rate:        	  4.4783% 	   189097 	  0.2510% 	      613695
N Rate:          	 12.3088% 	   519739 	  2.7091% 	     6624732

Total time:     	346.455 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:26:33	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG.bam -RGID 1 -RGLB 350a_OR -RGPL illumina -RGPU combined_runs -RGSM 350a_OR
**********


00:26:33.301 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:26:33 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG.bam RGID=1 RGLB=350a_OR RGPL=illumina RGPU=combined_runs RGSM=350a_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:26:33 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:26:33	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=350a_OR SM=350a_OR

INFO	2020-09-16 00:26:42	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|2762:47
INFO	2020-09-16 00:26:51	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|12352:34
INFO	2020-09-16 00:26:59	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:25s.  Time for last 1,000,000:    8s.  Last read position: lcl|8728:902
INFO	2020-09-16 00:27:08	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:34s.  Time for last 1,000,000:    8s.  Last read position: lcl|16713:23
INFO	2020-09-16 00:27:16	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:42s.  Time for last 1,000,000:    8s.  Last read position: lcl|10230:61
INFO	2020-09-16 00:27:25	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:51s.  Time for last 1,000,000:    8s.  Last read position: lcl|35081:2
INFO	2020-09-16 00:27:34	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:00s.  Time for last 1,000,000:    8s.  Last read position: lcl|36281:83
INFO	2020-09-16 00:27:42	AddOrReplaceReadGroups	Processed     8,000,000 records.  Elapsed time: 00:01:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|25110:430
INFO	2020-09-16 00:27:51	AddOrReplaceReadGroups	Processed     9,000,000 records.  Elapsed time: 00:01:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|45178:80
INFO	2020-09-16 00:28:02	AddOrReplaceReadGroups	Processed    10,000,000 records.  Elapsed time: 00:01:28s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-16 00:28:12	AddOrReplaceReadGroups	Processed    11,000,000 records.  Elapsed time: 00:01:38s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-16 00:28:19	AddOrReplaceReadGroups	Processed    12,000,000 records.  Elapsed time: 00:01:45s.  Time for last 1,000,000:    6s.  Last read position: */*
[Wed Sep 16 00:28:22 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.81 minutes.
Runtime.totalMemory()=1989672960
INFO	2020-09-16 00:28:34	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:28:35.014 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:28:35 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:28:35 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:28:35	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:28:35	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:28:35	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:28:37	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1115:7534:100725 1:N:0:TCTGAGAG+CATTCGTC. Cause: String 'TCTGAGAG+CATTCGTC' did not start with a parsable number.
INFO	2020-09-16 00:28:43	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|2762:47
INFO	2020-09-16 00:28:43	MarkDuplicates	Tracking 118 as yet unmatched pairs. 82 records in RAM.
INFO	2020-09-16 00:28:48	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|12352:34
INFO	2020-09-16 00:28:48	MarkDuplicates	Tracking 72 as yet unmatched pairs. 25 records in RAM.
INFO	2020-09-16 00:28:53	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|8728:902
INFO	2020-09-16 00:28:53	MarkDuplicates	Tracking 1046 as yet unmatched pairs. 994 records in RAM.
INFO	2020-09-16 00:28:57	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:20s.  Time for last 1,000,000:    4s.  Last read position: lcl|16713:23
INFO	2020-09-16 00:28:57	MarkDuplicates	Tracking 151 as yet unmatched pairs. 95 records in RAM.
INFO	2020-09-16 00:29:05	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    7s.  Last read position: lcl|10230:61
INFO	2020-09-16 00:29:05	MarkDuplicates	Tracking 184 as yet unmatched pairs. 121 records in RAM.
INFO	2020-09-16 00:29:09	MarkDuplicates	Read     6,000,000 records.  Elapsed time: 00:00:31s.  Time for last 1,000,000:    3s.  Last read position: lcl|35081:2
INFO	2020-09-16 00:29:09	MarkDuplicates	Tracking 110 as yet unmatched pairs. 49 records in RAM.
INFO	2020-09-16 00:29:14	MarkDuplicates	Read     7,000,000 records.  Elapsed time: 00:00:36s.  Time for last 1,000,000:    5s.  Last read position: lcl|36281:83
INFO	2020-09-16 00:29:14	MarkDuplicates	Tracking 924 as yet unmatched pairs. 861 records in RAM.
INFO	2020-09-16 00:29:17	MarkDuplicates	Read     8,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:    3s.  Last read position: lcl|25110:430
INFO	2020-09-16 00:29:17	MarkDuplicates	Tracking 444 as yet unmatched pairs. 392 records in RAM.
INFO	2020-09-16 00:29:33	MarkDuplicates	Read     9,000,000 records.  Elapsed time: 00:00:56s.  Time for last 1,000,000:   16s.  Last read position: lcl|45178:80
INFO	2020-09-16 00:29:33	MarkDuplicates	Tracking 213 as yet unmatched pairs. 205 records in RAM.
INFO	2020-09-16 00:29:34	MarkDuplicates	Read 9193558 records. 0 pairs never matched.
INFO	2020-09-16 00:29:41	MarkDuplicates	After buildSortedReadEndLists freeMemory: 11152829472; totalMemory: 12777422848; maxMemory: 28631367680
INFO	2020-09-16 00:29:41	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:29:45	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:30:03	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:30:04	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:30:04	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15521394984; totalMemory: 22871015424; maxMemory: 28631367680
INFO	2020-09-16 00:30:04	MarkDuplicates	Marking 2984056 records as duplicates.
INFO	2020-09-16 00:30:04	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:30:05	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:31:39	MarkDuplicates	Written    10,000,000 records.  Elapsed time: 00:01:34s.  Time for last 10,000,000:   94s.  Last read position: */*
INFO	2020-09-16 00:32:00	MarkDuplicates	Before output close freeMemory: 22373071224; totalMemory: 22582132736; maxMemory: 28631367680
INFO	2020-09-16 00:32:00	MarkDuplicates	After output close freeMemory: 22656127128; totalMemory: 22865248256; maxMemory: 28631367680
[Wed Sep 16 00:32:00 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 3.42 minutes.
Runtime.totalMemory()=22865248256
INFO	2020-09-16 00:32:01	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG_DM.bam
**********


00:32:01.845 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:32:01 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:32:01 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:32:30	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350a_OR_sorted_RG_DM.bai
[Wed Sep 16 00:32:30 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.47 minutes.
Runtime.totalMemory()=5186781184
java -ea -Xmx226267m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350b_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350b_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350b_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350b_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.054 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.537 seconds.
Analyzed Index:   	2.798 seconds.
Started output stream:	0.024 seconds.
Cleared Memory:    	0.542 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	3733212	(305764628 bases)

Mapping:          	130.143 seconds.
Reads/sec:       	28685.39
kBases/sec:      	2349.45


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 26.5835% 	   496209 	 26.3649% 	    80614480
bad pairs:       	  0.0076% 	      141 	  0.0067% 	       20390
insert size avg: 	  510.57


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 61.9973% 	  1157245 	 60.7727% 	    92793126
unambiguous:     	 39.9780% 	   746231 	 41.2888% 	    63043466
ambiguous:       	 22.0193% 	   411014 	 19.4838% 	    29749660
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 17.9860% 	   335727 	 13.6252% 	    20804142
semiperfect site:	 25.7573% 	   480788 	 21.9577% 	    33526909
rescued:         	  3.4223% 	    63881

Match Rate:      	      NA 	       NA 	 94.3482% 	    87906292
Error Rate:      	 51.6126% 	   770669 	  3.4083% 	     3175575
Sub Rate:        	 50.9549% 	   760848 	  2.8644% 	     2668837
Del Rate:        	  4.2782% 	    63881 	  0.4069% 	      379106
Ins Rate:        	  3.0611% 	    45708 	  0.1370% 	      127632
N Rate:          	 10.5810% 	   157994 	  2.2435% 	     2090365


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 50.7407% 	   947129 	 50.5943% 	    77447642
unambiguous:     	 35.2578% 	   658125 	 36.5956% 	    56019013
ambiguous:       	 15.4829% 	   289004 	 13.9987% 	    21428629
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 12.2557% 	   228765 	  9.6305% 	    14741912
semiperfect site:	 19.0857% 	   356255 	 16.7076% 	    25575336
rescued:         	  4.0848% 	    76247

Match Rate:      	      NA 	       NA 	 93.3386% 	    72652878
Error Rate:      	 44.8297% 	   666085 	  3.8661% 	     3009325
Sub Rate:        	 44.2476% 	   657435 	  3.2056% 	     2495179
Del Rate:        	  4.1398% 	    61509 	  0.5014% 	      390298
Ins Rate:        	  2.9673% 	    44088 	  0.1591% 	      123848
N Rate:          	 11.0928% 	   164818 	  2.7952% 	     2175737

Total time:     	134.445 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:35:06	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG.bam -RGID 1 -RGLB 350b_OR -RGPL illumina -RGPU combined_runs -RGSM 350b_OR
**********


00:35:06.898 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:35:06 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG.bam RGID=1 RGLB=350b_OR RGPL=illumina RGPU=combined_runs RGSM=350b_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:35:06 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:35:07	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=350b_OR SM=350b_OR

INFO	2020-09-16 00:35:16	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|3546:109
INFO	2020-09-16 00:35:25	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|29558:67
INFO	2020-09-16 00:35:35	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    9s.  Last read position: lcl|39922:1
[Wed Sep 16 00:35:42 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.59 minutes.
Runtime.totalMemory()=3508011008
INFO	2020-09-16 00:35:46	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:35:46.875 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:35:46 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:35:46 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:35:46	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:35:46	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:35:46	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:35:49	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1215:2937:54814 1:N:0:TGAGGTGT+GTTCCATG. Cause: String 'TGAGGTGT+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:35:54	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:05s.  Time for last 1,000,000:    5s.  Last read position: lcl|3546:109
INFO	2020-09-16 00:35:54	MarkDuplicates	Tracking 54 as yet unmatched pairs. 7 records in RAM.
INFO	2020-09-16 00:35:59	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:    4s.  Last read position: lcl|29558:67
INFO	2020-09-16 00:35:59	MarkDuplicates	Tracking 55 as yet unmatched pairs. 23 records in RAM.
INFO	2020-09-16 00:36:05	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    6s.  Last read position: lcl|39922:1
INFO	2020-09-16 00:36:05	MarkDuplicates	Tracking 18 as yet unmatched pairs. 3 records in RAM.
INFO	2020-09-16 00:36:08	MarkDuplicates	Read 3216048 records. 0 pairs never matched.
INFO	2020-09-16 00:36:11	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4743595760; totalMemory: 5856296960; maxMemory: 28631367680
INFO	2020-09-16 00:36:11	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:36:15	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:36:15	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:36:16	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:36:17	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5796956768; totalMemory: 13052149760; maxMemory: 28631367680
INFO	2020-09-16 00:36:17	MarkDuplicates	Marking 875450 records as duplicates.
INFO	2020-09-16 00:36:17	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:36:17	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:36:54	MarkDuplicates	Before output close freeMemory: 17166517152; totalMemory: 17354981376; maxMemory: 28631367680
INFO	2020-09-16 00:36:54	MarkDuplicates	After output close freeMemory: 17018143648; totalMemory: 17206607872; maxMemory: 28631367680
[Wed Sep 16 00:36:54 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.12 minutes.
Runtime.totalMemory()=17206607872
INFO	2020-09-16 00:36:55	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG_DM.bam
**********


00:36:55.579 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:36:55 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:36:55 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:37:07	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350b_OR_sorted_RG_DM.bai
[Wed Sep 16 00:37:07 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.19 minutes.
Runtime.totalMemory()=5746196480
java -ea -Xmx226344m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350c_OR_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350c_OR_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350c_OR_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/350c_OR_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.567 seconds.
Analyzed Index:   	2.934 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	0.543 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	404	(38912 bases)

Mapping:          	1.326 seconds.
Reads/sec:       	304.76
kBases/sec:      	29.35


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 17.8218% 	       36 	 15.9796% 	        6218
bad pairs:       	  0.0000% 	        0 	  0.0000% 	           0
insert size avg: 	  247.11


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 53.4653% 	      108 	 50.6739% 	        9776
unambiguous:     	 32.1782% 	       65 	 32.3295% 	        6237
ambiguous:       	 21.2871% 	       43 	 18.3444% 	        3539
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.3960% 	       21 	  7.5627% 	        1459
semiperfect site:	 15.3465% 	       31 	 12.5389% 	        2419
rescued:         	  4.9505% 	       10

Match Rate:      	      NA 	       NA 	 90.9652% 	        8991
Error Rate:      	 64.3411% 	       83 	  5.6354% 	         557
Sub Rate:        	 62.0155% 	       80 	  4.2695% 	         422
Del Rate:        	  8.5271% 	       11 	  1.0927% 	         108
Ins Rate:        	  3.8760% 	        5 	  0.2732% 	          27
N Rate:          	 16.2791% 	       21 	  3.3994% 	         336


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 34.1584% 	       69 	 31.8502% 	        6249
unambiguous:     	 25.2475% 	       51 	 24.8981% 	        4885
ambiguous:       	  8.9109% 	       18 	  6.9521% 	        1364
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.9307% 	       14 	  5.0968% 	        1000
semiperfect site:	  9.9010% 	       20 	  7.6707% 	        1505
rescued:         	  3.9604% 	        8

Match Rate:      	      NA 	       NA 	 91.5399% 	        5778
Error Rate:      	 49.0909% 	       54 	  6.0044% 	         379
Sub Rate:        	 48.1818% 	       53 	  4.7212% 	         298
Del Rate:        	  9.0909% 	       10 	  0.9981% 	          63
Ins Rate:        	  3.6364% 	        4 	  0.2852% 	          18
N Rate:          	  8.1818% 	        9 	  2.4556% 	         155

Total time:     	5.775 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:37:14	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG.bam -RGID 1 -RGLB 350c_OR -RGPL illumina -RGPU combined_runs -RGSM 350c_OR
**********


00:37:14.386 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:37:14 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG.bam RGID=1 RGLB=350c_OR RGPL=illumina RGPU=combined_runs RGSM=350c_OR    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:37:14 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:37:14	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=350c_OR SM=350c_OR

[Wed Sep 16 00:37:14 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=2058354688
INFO	2020-09-16 00:37:15	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:37:15.690 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:37:15 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:37:15 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:37:15	MarkDuplicates	Start of doWork freeMemory: 2037938104; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:37:15	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:37:15	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:37:18	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:314:CDYVVACXX:7:1201:6638:79632 1:N:0:GAATTACC+CATTCGTC. Cause: String 'GAATTACC+CATTCGTC' did not start with a parsable number.
INFO	2020-09-16 00:37:18	MarkDuplicates	Read 282 records. 0 pairs never matched.
INFO	2020-09-16 00:37:19	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1209583856; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:37:19	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:37:22	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:37:22	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:37:22	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:37:23	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2566703752; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-16 00:37:23	MarkDuplicates	Marking 0 records as duplicates.
INFO	2020-09-16 00:37:23	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:37:24	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:37:24	MarkDuplicates	Before output close freeMemory: 9717389928; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-16 00:37:24	MarkDuplicates	After output close freeMemory: 9717465944; totalMemory: 9753853952; maxMemory: 28631367680
[Wed Sep 16 00:37:24 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.15 minutes.
Runtime.totalMemory()=9753853952
INFO	2020-09-16 00:37:25	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG_DM.bam
**********


00:37:25.443 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:37:25 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:37:25 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:37:27	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/350c_OR_sorted_RG_DM.bai
[Wed Sep 16 00:37:27 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.04 minutes.
Runtime.totalMemory()=3670540288
java -ea -Xmx226414m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39a_WA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39a_WA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39a_WA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39a_WA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.521 seconds.
Analyzed Index:   	3.014 seconds.
Started output stream:	0.027 seconds.
Cleared Memory:    	0.877 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	2077610	(171119003 bases)

Mapping:          	68.623 seconds.
Reads/sec:       	30275.65
kBases/sec:      	2493.60


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 18.6750% 	   193997 	 18.5737% 	    31783146
bad pairs:       	  0.0062% 	       64 	  0.0054% 	        9164
insert size avg: 	  362.17


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 41.9879% 	   436172 	 41.4024% 	    35363175
unambiguous:     	 27.7471% 	   288238 	 28.7004% 	    24514010
ambiguous:       	 14.2408% 	   147934 	 12.7019% 	    10849165
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  8.7642% 	    91043 	  6.5280% 	     5575801
semiperfect site:	 13.3101% 	   138266 	 11.2477% 	     9607014
rescued:         	  2.5763% 	    26763

Match Rate:      	      NA 	       NA 	 92.4625% 	    32963015
Error Rate:      	 58.4130% 	   328194 	  4.5105% 	     1607986
Sub Rate:        	 55.9930% 	   314597 	  3.3637% 	     1199169
Del Rate:        	  6.2826% 	    35299 	  0.8049% 	      286955
Ins Rate:        	  7.5618% 	    42486 	  0.3418% 	      121862
N Rate:          	 13.1610% 	    73945 	  3.0270% 	     1079129


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 36.5335% 	   379512 	 36.2850% 	    31098229
unambiguous:     	 25.3510% 	   263347 	 26.2221% 	    22473822
ambiguous:       	 11.1826% 	   116165 	 10.0628% 	     8624407
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.4300% 	    66795 	  4.8941% 	     4194493
semiperfect site:	 10.6430% 	   110560 	  9.1384% 	     7832125
rescued:         	  3.1426% 	    32645

Match Rate:      	      NA 	       NA 	 91.6821% 	    28767536
Error Rate:      	 52.9705% 	   295053 	  4.9103% 	     1540724
Sub Rate:        	 50.7513% 	   282692 	  3.6415% 	     1142602
Del Rate:        	  6.1551% 	    34285 	  0.8900% 	      279252
Ins Rate:        	  7.3188% 	    40767 	  0.3788% 	      118870
N Rate:          	 13.3435% 	    74325 	  3.4076% 	     1069221

Total time:     	73.447 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:38:53	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG.bam -RGID 1 -RGLB 39a_WA -RGPL illumina -RGPU combined_runs -RGSM 39a_WA
**********


00:38:54.087 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:38:54 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG.bam RGID=1 RGLB=39a_WA RGPL=illumina RGPU=combined_runs RGSM=39a_WA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:38:54 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:38:54	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=39a_WA SM=39a_WA

INFO	2020-09-16 00:39:04	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|27654:193
INFO	2020-09-16 00:39:14	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:    9s.  Last read position: */*
[Wed Sep 16 00:39:14 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.34 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-16 00:39:17	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:39:17.610 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:39:17 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:39:17 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:39:17	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:39:17	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:39:17	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:39:20	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1103:13391:67680 1:N:0:GATCCATG+GTTCCATG. Cause: String 'GATCCATG+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:39:26	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|27654:193
INFO	2020-09-16 00:39:26	MarkDuplicates	Tracking 66 as yet unmatched pairs. 64 records in RAM.
INFO	2020-09-16 00:39:28	MarkDuplicates	Read 1243246 records. 0 pairs never matched.
INFO	2020-09-16 00:39:30	MarkDuplicates	After buildSortedReadEndLists freeMemory: 2708735120; totalMemory: 3663724544; maxMemory: 28631367680
INFO	2020-09-16 00:39:30	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:39:34	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:39:34	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:39:34	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:39:35	MarkDuplicates	After generateDuplicateIndexes freeMemory: 3627814048; totalMemory: 10839130112; maxMemory: 28631367680
INFO	2020-09-16 00:39:35	MarkDuplicates	Marking 320266 records as duplicates.
INFO	2020-09-16 00:39:35	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:39:35	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:39:56	MarkDuplicates	Before output close freeMemory: 12880287680; totalMemory: 12981895168; maxMemory: 28631367680
INFO	2020-09-16 00:39:56	MarkDuplicates	After output close freeMemory: 12788012992; totalMemory: 12889620480; maxMemory: 28631367680
[Wed Sep 16 00:39:56 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.65 minutes.
Runtime.totalMemory()=12889620480
INFO	2020-09-16 00:39:57	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG_DM.bam
**********


00:39:57.719 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:39:57 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:39:57 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:40:04	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39a_WA_sorted_RG_DM.bai
[Wed Sep 16 00:40:04 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.12 minutes.
Runtime.totalMemory()=3597139968
java -ea -Xmx226285m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39b_WA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39b_WA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39b_WA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/39b_WA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.040 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.541 seconds.
Analyzed Index:   	2.877 seconds.
Started output stream:	0.026 seconds.
Cleared Memory:    	1.050 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	5194054	(442064848 bases)

Mapping:          	142.298 seconds.
Reads/sec:       	36501.36
kBases/sec:      	3106.62


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 16.1152% 	   418515 	 16.1433% 	    71363850
bad pairs:       	  0.0081% 	      211 	  0.0070% 	       31140
insert size avg: 	  348.12


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 36.9906% 	   960657 	 36.2376% 	    79841458
unambiguous:     	 25.8688% 	   671820 	 26.4279% 	    58228021
ambiguous:       	 11.1218% 	   288837 	  9.8097% 	    21613437
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.1354% 	   185309 	  5.3358% 	    11756296
semiperfect site:	 10.7266% 	   278572 	  8.9672% 	    19757304
rescued:         	  2.3919% 	    62117

Match Rate:      	      NA 	       NA 	 91.9773% 	    74150868
Error Rate:      	 59.5774% 	   739195 	  5.0428% 	     4065438
Sub Rate:        	 58.3026% 	   723378 	  3.7331% 	     3009573
Del Rate:        	  7.4130% 	    91976 	  0.9641% 	      777242
Ins Rate:        	  6.7318% 	    83523 	  0.3456% 	      278623
N Rate:          	 13.7607% 	   170733 	  2.9799% 	     2402394


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 32.8872% 	   854090 	 32.2944% 	    71608680
unambiguous:     	 24.0049% 	   623414 	 24.4066% 	    54118398
ambiguous:       	  8.8823% 	   230676 	  7.8879% 	    17490282
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  5.3899% 	   139977 	  4.0997% 	     9090599
semiperfect site:	  8.7862% 	   228180 	  7.4327% 	    16481072
rescued:         	  2.8939% 	    75155

Match Rate:      	      NA 	       NA 	 91.1913% 	    65997193
Error Rate:      	 54.8743% 	   675646 	  5.4194% 	     3922115
Sub Rate:        	 53.6687% 	   660802 	  3.9859% 	     2884677
Del Rate:        	  7.2923% 	    89787 	  1.0550% 	      763529
Ins Rate:        	  6.6118% 	    81408 	  0.3785% 	      273909
N Rate:          	 14.4458% 	   177866 	  3.3893% 	     2452901

Total time:     	147.177 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:43:01	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG.bam -RGID 1 -RGLB 39b_WA -RGPL illumina -RGPU combined_runs -RGSM 39b_WA
**********


00:43:02.076 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:43:02 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG.bam RGID=1 RGLB=39b_WA RGPL=illumina RGPU=combined_runs RGSM=39b_WA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:43:02 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:43:02	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=39b_WA SM=39b_WA

INFO	2020-09-16 00:43:11	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: lcl|24213:18
INFO	2020-09-16 00:43:21	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    9s.  Last read position: lcl|38130:78
INFO	2020-09-16 00:43:32	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:29s.  Time for last 1,000,000:   11s.  Last read position: */*
INFO	2020-09-16 00:43:42	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:40s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-16 00:43:49	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:46s.  Time for last 1,000,000:    6s.  Last read position: */*
[Wed Sep 16 00:43:50 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.81 minutes.
Runtime.totalMemory()=2344091648
INFO	2020-09-16 00:43:56	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:43:56.769 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:43:56 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:43:56 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:43:56	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:43:56	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:43:56	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:43:59	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: M00780:261:J2RLW:1:2114:2945:17473 1:N:0:GCCTATCA+GTTCCATG. Cause: String 'GCCTATCA+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:44:06	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|24213:18
INFO	2020-09-16 00:44:06	MarkDuplicates	Tracking 9 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-16 00:44:10	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    4s.  Last read position: lcl|38130:78
INFO	2020-09-16 00:44:10	MarkDuplicates	Tracking 175 as yet unmatched pairs. 163 records in RAM.
INFO	2020-09-16 00:44:14	MarkDuplicates	Read 2792042 records. 0 pairs never matched.
INFO	2020-09-16 00:44:19	MarkDuplicates	After buildSortedReadEndLists freeMemory: 4752109280; totalMemory: 5836898304; maxMemory: 28631367680
INFO	2020-09-16 00:44:19	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:44:22	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:44:23	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:44:23	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:44:24	MarkDuplicates	After generateDuplicateIndexes freeMemory: 5759356904; totalMemory: 13012303872; maxMemory: 28631367680
INFO	2020-09-16 00:44:24	MarkDuplicates	Marking 928979 records as duplicates.
INFO	2020-09-16 00:44:24	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:44:24	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:45:15	MarkDuplicates	Before output close freeMemory: 12927273216; totalMemory: 13029081088; maxMemory: 28631367680
INFO	2020-09-16 00:45:15	MarkDuplicates	After output close freeMemory: 17096372000; totalMemory: 17281581056; maxMemory: 28631367680
[Wed Sep 16 00:45:15 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 1.31 minutes.
Runtime.totalMemory()=17281581056
INFO	2020-09-16 00:45:16	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG_DM.bam
**********


00:45:16.283 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:45:16 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:45:16 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:45:30	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/39b_WA_sorted_RG_DM.bai
[Wed Sep 16 00:45:30 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.23 minutes.
Runtime.totalMemory()=5747245056
java -ea -Xmx226355m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48a_WA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48a_WA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48a_WA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48a_WA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.041 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.552 seconds.
Analyzed Index:   	2.951 seconds.
Started output stream:	0.028 seconds.
Cleared Memory:    	0.534 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	7396894	(633371393 bases)

Mapping:          	256.237 seconds.
Reads/sec:       	28867.42
kBases/sec:      	2471.82


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 22.1765% 	   820187 	 22.1872% 	   140527262
bad pairs:       	  0.0087% 	      323 	  0.0076% 	       47850
insert size avg: 	  352.38


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 51.8495% 	  1917628 	 50.5736% 	   160047192
unambiguous:     	 35.6955% 	  1320180 	 36.3815% 	   115134352
ambiguous:       	 16.1540% 	   597448 	 14.1921% 	    44912840
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	 10.7613% 	   398000 	  8.0359% 	    25430851
semiperfect site:	 15.8959% 	   587902 	 13.2853% 	    42043102
rescued:         	  2.9562% 	   109335

Match Rate:      	      NA 	       NA 	 92.3051% 	   149096901
Error Rate:      	 58.7123% 	  1446705 	  4.8339% 	     7808080
Sub Rate:        	 57.4705% 	  1416107 	  3.5857% 	     5791912
Del Rate:        	  7.2099% 	   177656 	  0.9156% 	     1478913
Ins Rate:        	  6.7257% 	   165726 	  0.3326% 	      537255
N Rate:          	 12.8883% 	   317575 	  2.8609% 	     4621124


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 45.2634% 	  1674042 	 44.5074% 	   141047110
unambiguous:     	 33.1886% 	  1227464 	 33.7361% 	   106912007
ambiguous:       	 12.0747% 	   446578 	 10.7713% 	    34135103
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  7.7173% 	   285419 	  5.9061% 	    18716993
semiperfect site:	 12.9116% 	   477530 	 10.9928% 	    34836879
rescued:         	  3.7070% 	   137102

Match Rate:      	      NA 	       NA 	 91.1275% 	   129953050
Error Rate:      	 53.2124% 	  1296419 	  5.3158% 	     7580660
Sub Rate:        	 52.0520% 	  1268149 	  3.8405% 	     5476748
Del Rate:        	  7.3074% 	   178032 	  1.0930% 	     1558656
Ins Rate:        	  6.6929% 	   163060 	  0.3824% 	      545256
N Rate:          	 15.2609% 	   371804 	  3.5567% 	     5072056

Total time:     	260.692 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:50:33	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG.bam -RGID 1 -RGLB 48a_WA -RGPL illumina -RGPU combined_runs -RGSM 48a_WA
**********


00:50:33.617 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:50:33 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG.bam RGID=1 RGLB=48a_WA RGPL=illumina RGPU=combined_runs RGSM=48a_WA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:50:33 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:50:33	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=48a_WA SM=48a_WA

INFO	2020-09-16 00:50:42	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:08s.  Time for last 1,000,000:    8s.  Last read position: lcl|7288:119
INFO	2020-09-16 00:50:51	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:17s.  Time for last 1,000,000:    8s.  Last read position: lcl|16063:1
INFO	2020-09-16 00:51:00	AddOrReplaceReadGroups	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: lcl|30167:1
INFO	2020-09-16 00:51:09	AddOrReplaceReadGroups	Processed     4,000,000 records.  Elapsed time: 00:00:35s.  Time for last 1,000,000:    8s.  Last read position: lcl|41270:1
INFO	2020-09-16 00:51:17	AddOrReplaceReadGroups	Processed     5,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:    8s.  Last read position: lcl|37174:180
INFO	2020-09-16 00:51:28	AddOrReplaceReadGroups	Processed     6,000,000 records.  Elapsed time: 00:00:54s.  Time for last 1,000,000:   10s.  Last read position: */*
INFO	2020-09-16 00:51:37	AddOrReplaceReadGroups	Processed     7,000,000 records.  Elapsed time: 00:01:03s.  Time for last 1,000,000:    9s.  Last read position: */*
[Wed Sep 16 00:51:39 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 1.10 minutes.
Runtime.totalMemory()=2213019648
INFO	2020-09-16 00:51:47	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:51:48.071 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:51:48 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:51:48 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:51:48	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:51:48	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:51:48	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:51:50	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:2216:16179:98961 1:N:0:AACAACCG+GTTCCATG. Cause: String 'AACAACCG+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:51:56	MarkDuplicates	Read     1,000,000 records.  Elapsed time: 00:00:06s.  Time for last 1,000,000:    6s.  Last read position: lcl|7288:119
INFO	2020-09-16 00:51:56	MarkDuplicates	Tracking 862 as yet unmatched pairs. 820 records in RAM.
INFO	2020-09-16 00:52:01	MarkDuplicates	Read     2,000,000 records.  Elapsed time: 00:00:11s.  Time for last 1,000,000:    5s.  Last read position: lcl|16063:1
INFO	2020-09-16 00:52:01	MarkDuplicates	Tracking 19 as yet unmatched pairs. 1 records in RAM.
INFO	2020-09-16 00:52:06	MarkDuplicates	Read     3,000,000 records.  Elapsed time: 00:00:16s.  Time for last 1,000,000:    5s.  Last read position: lcl|30167:1
INFO	2020-09-16 00:52:06	MarkDuplicates	Tracking 36 as yet unmatched pairs. 19 records in RAM.
INFO	2020-09-16 00:52:13	MarkDuplicates	Read     4,000,000 records.  Elapsed time: 00:00:22s.  Time for last 1,000,000:    6s.  Last read position: lcl|41270:1
INFO	2020-09-16 00:52:13	MarkDuplicates	Tracking 17 as yet unmatched pairs. 0 records in RAM.
INFO	2020-09-16 00:52:19	MarkDuplicates	Read     5,000,000 records.  Elapsed time: 00:00:28s.  Time for last 1,000,000:    5s.  Last read position: lcl|37174:180
INFO	2020-09-16 00:52:19	MarkDuplicates	Tracking 95 as yet unmatched pairs. 87 records in RAM.
INFO	2020-09-16 00:52:21	MarkDuplicates	Read 5542320 records. 0 pairs never matched.
INFO	2020-09-16 00:52:26	MarkDuplicates	After buildSortedReadEndLists freeMemory: 8843075680; totalMemory: 10170138624; maxMemory: 28631367680
INFO	2020-09-16 00:52:26	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:52:28	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:52:46	OpticalDuplicateFinder	Large duplicate set. size = 1290
INFO	2020-09-16 00:52:46	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-16 00:52:46	OpticalDuplicateFinder	Large duplicate set. size = 1110
INFO	2020-09-16 00:52:46	OpticalDuplicateFinder	compared         1,000 ReadEnds to others.  Elapsed time: 00:00:00s.  Time for last 1,000:    0s.  Last read position: -1:-1
INFO	2020-09-16 00:52:47	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:52:47	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:52:48	MarkDuplicates	After generateDuplicateIndexes freeMemory: 15845445768; totalMemory: 23207084032; maxMemory: 28631367680
INFO	2020-09-16 00:52:48	MarkDuplicates	Marking 2142227 records as duplicates.
INFO	2020-09-16 00:52:48	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:52:48	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:53:58	MarkDuplicates	Before output close freeMemory: 23008505656; totalMemory: 23220715520; maxMemory: 28631367680
INFO	2020-09-16 00:53:58	MarkDuplicates	After output close freeMemory: 22811897656; totalMemory: 23024107520; maxMemory: 28631367680
[Wed Sep 16 00:53:58 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 2.18 minutes.
Runtime.totalMemory()=23024107520
INFO	2020-09-16 00:54:00	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG_DM.bam
**********


00:54:00.547 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:54:00 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:54:00 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:54:19	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48a_WA_sorted_RG_DM.bai
[Wed Sep 16 00:54:19 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.31 minutes.
Runtime.totalMemory()=5746720768
java -ea -Xmx226278m -cp /usr/local/src/bbmap/current/ align2.BBMap build=1 overwrite=true fastareadlen=500 threads=28 nodisk=t killbadpairs=t ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48b_WA_trimmed_R1.fastq in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48b_WA_trimmed_R2.fastq out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA.bam bamscript=sort.sh
Executing align2.BBMap [build=1, overwrite=true, fastareadlen=500, threads=28, nodisk=t, killbadpairs=t, ref=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, in=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48b_WA_trimmed_R1.fastq, in2=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/trimmed_reads/48b_WA_trimmed_R2.fastq, out=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA.bam, bamscript=sort.sh]
Version 38.51

Set threads to 28
Retaining first best site only for ambiguous mappings.
Found samtools 1.7-13-g8dee2a2
Executing dna.FastaToChromArrays2 [striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/reference/final_reference_assembly.fa, 1, writeinthread=false, genscaffoldinfo=true, retain, waitforwriting=false, gz=true, maxlen=536670912, writechroms=false, minscaf=1, midpad=300, startpad=8000, stoppad=8000, nodisk=true]

Set genScaffoldInfo=true
Set genome to 1

Loaded Reference:	0.042 seconds.
Loading index for chunk 1-1, build 1
Indexing threads started for block 0-1
Indexing threads finished for block 0-1
Generated Index:	0.507 seconds.
Analyzed Index:   	2.913 seconds.
Started output stream:	0.025 seconds.
Cleared Memory:    	1.314 seconds.
Processing reads in paired-ended mode.
Started read stream.
Started 28 mapping threads.
Detecting finished threads: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27

   ------------------   Results   ------------------   

Genome:                	1
Key Length:            	13
Max Indel:             	16000
Minimum Score Ratio:  	0.56
Mapping Mode:         	normal
Reads Used:           	1582998	(131611447 bases)

Mapping:          	46.669 seconds.
Reads/sec:       	33919.75
kBases/sec:      	2820.11


Pairing data:   	pct pairs	num pairs 	pct bases	   num bases

mated pairs:     	 18.1524% 	   143676 	 18.0667% 	    23777782
bad pairs:       	  0.0086% 	       68 	  0.0072% 	        9530
insert size avg: 	  282.86


Read 1 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 35.4729% 	   280768 	 34.9267% 	    22872034
unambiguous:     	 23.8010% 	   188385 	 24.4711% 	    16025053
ambiguous:       	 11.6719% 	    92383 	 10.4557% 	     6846981
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  6.3375% 	    50161 	  4.6668% 	     3056062
semiperfect site:	  9.9080% 	    78422 	  8.3297% 	     5454759
rescued:         	  2.6456% 	    20940

Match Rate:      	      NA 	       NA 	 91.8137% 	    21202612
Error Rate:      	 62.5954% 	   220205 	  5.0610% 	     1168730
Sub Rate:        	 59.9728% 	   210979 	  3.7133% 	      857517
Del Rate:        	  7.4175% 	    26094 	  0.9572% 	      221051
Ins Rate:        	  8.7134% 	    30653 	  0.3904% 	       90162
N Rate:          	 14.3020% 	    50313 	  3.1254% 	      721743


Read 2 data:      	pct reads	num reads 	pct bases	   num bases

mapped:          	 31.5505% 	   249722 	 30.9300% 	    20452706
unambiguous:     	 21.9806% 	   173976 	 22.3946% 	    14808579
ambiguous:       	  9.5699% 	    75746 	  8.5355% 	     5644127
low-Q discards:  	  0.0000% 	        0 	  0.0000% 	           0

perfect best site:	  4.8404% 	    38312 	  3.5872% 	     2372031
semiperfect site:	  8.1210% 	    64278 	  6.8388% 	     4522201
rescued:         	  3.2795% 	    25957

Match Rate:      	      NA 	       NA 	 91.2334% 	    18850474
Error Rate:      	 57.8413% 	   201261 	  5.4283% 	     1121579
Sub Rate:        	 55.5013% 	   193119 	  3.9977% 	      826005
Del Rate:        	  7.1929% 	    25028 	  1.0120% 	      209105
Ins Rate:        	  8.4353% 	    29351 	  0.4185% 	       86469
N Rate:          	 14.1524% 	    49244 	  3.3383% 	      689758

Total time:     	51.815 seconds.
Note: This script is designed to run with the amount of memory detected by BBMap.
      If Samtools crashes, please ensure you are running on the same platform as BBMap,
      or reduce Samtools' memory setting (the -m flag).
[bam_sort_core] merging from 0 files and 3 in-memory blocks...
INFO	2020-09-16 00:55:21	AddOrReplaceReadGroups	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    AddOrReplaceReadGroups -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG.bam -RGID 1 -RGLB 48b_WA -RGPL illumina -RGPU combined_runs -RGSM 48b_WA
**********


00:55:21.494 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:55:21 EDT 2020] AddOrReplaceReadGroups INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted.bam OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG.bam RGID=1 RGLB=48b_WA RGPL=illumina RGPU=combined_runs RGSM=48b_WA    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:55:21 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:55:21	AddOrReplaceReadGroups	Created read-group ID=1 PL=illumina LB=48b_WA SM=48b_WA

INFO	2020-09-16 00:55:32	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:10s.  Time for last 1,000,000:   10s.  Last read position: */*
[Wed Sep 16 00:55:37 EDT 2020] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.27 minutes.
Runtime.totalMemory()=2595749888
INFO	2020-09-16 00:55:39	MarkDuplicates	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    MarkDuplicates -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG.bam -O striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG_DM.bam -M striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_dups_metrics.txt -ASSUME_SORT_ORDER coordinate
**********


00:55:40.105 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:55:40 EDT 2020] MarkDuplicates INPUT=[striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG.bam] OUTPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG_DM.bam METRICS_FILE=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_dups_metrics.txt ASSUME_SORT_ORDER=coordinate    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 TAG_DUPLICATE_SET_MEMBERS=false REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag CLEAR_DT=true DUPLEX_UMI=false ADD_PG_TAG_TO_READS=true REMOVE_DUPLICATES=false ASSUME_SORTED=false DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 MAX_OPTICAL_DUPLICATE_SET_SIZE=300000 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:55:40 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:55:40	MarkDuplicates	Start of doWork freeMemory: 2037938136; totalMemory: 2058354688; maxMemory: 28631367680
INFO	2020-09-16 00:55:40	MarkDuplicates	Reading input file and constructing read end information.
INFO	2020-09-16 00:55:40	MarkDuplicates	Will retain up to 103736839 data points before spilling to disk.
WARNING	2020-09-16 00:55:42	AbstractOpticalDuplicateFinderCommandLineProgram	A field field parsed out of a read name was expected to contain an integer and did not. Read name: SNT103:315:HGN37BCX3:1:1115:5790:64229 1:N:0:ACTCGTTG+GTTCCATG. Cause: String 'ACTCGTTG+GTTCCATG' did not start with a parsable number.
INFO	2020-09-16 00:55:47	MarkDuplicates	Read 773492 records. 0 pairs never matched.
INFO	2020-09-16 00:55:49	MarkDuplicates	After buildSortedReadEndLists freeMemory: 1686699696; totalMemory: 2595749888; maxMemory: 28631367680
INFO	2020-09-16 00:55:49	MarkDuplicates	Will retain up to 894730240 duplicate indices before spilling to disk.
INFO	2020-09-16 00:55:52	MarkDuplicates	Traversing read pair information and detecting duplicates.
INFO	2020-09-16 00:55:52	MarkDuplicates	Traversing fragment information and detecting duplicates.
INFO	2020-09-16 00:55:53	MarkDuplicates	Sorting list of duplicate records.
INFO	2020-09-16 00:55:54	MarkDuplicates	After generateDuplicateIndexes freeMemory: 2564411264; totalMemory: 9753853952; maxMemory: 28631367680
INFO	2020-09-16 00:55:54	MarkDuplicates	Marking 177379 records as duplicates.
INFO	2020-09-16 00:55:54	MarkDuplicates	Found 0 optical duplicate clusters.
INFO	2020-09-16 00:55:55	MarkDuplicates	Reads are assumed to be ordered by: coordinate
INFO	2020-09-16 00:56:10	MarkDuplicates	Before output close freeMemory: 11344092080; totalMemory: 11403788288; maxMemory: 28631367680
INFO	2020-09-16 00:56:11	MarkDuplicates	After output close freeMemory: 13360000608; totalMemory: 13460045824; maxMemory: 28631367680
[Wed Sep 16 00:56:11 EDT 2020] picard.sam.markduplicates.MarkDuplicates done. Elapsed time: 0.52 minutes.
Runtime.totalMemory()=13460045824
INFO	2020-09-16 00:56:11	BuildBamIndex	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    BuildBamIndex -I striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG_DM.bam
**********


00:56:12.070 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/usr/local/src/picard/build/libs/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed Sep 16 00:56:12 EDT 2020] BuildBamIndex INPUT=striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG_DM.bam    VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed Sep 16 00:56:12 EDT 2020] Executing as bsinn@myco on Linux 4.4.0-187-generic amd64; OpenJDK 64-Bit Server VM 1.8.0_265-8u265-b01-0ubuntu2~16.04-b01; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.20.1-SNAPSHOT
INFO	2020-09-16 00:56:18	BuildBamIndex	Successfully wrote bam index file /data/mathilda/C_striata_ISSRseq_reads/striata_combined_RefBased_output/striata_combined_NoHardTrim_RefBased_2020_09_15_15_53/bams/48b_WA_sorted_RG_DM.bai
[Wed Sep 16 00:56:18 EDT 2020] picard.sam.BuildBamIndex done. Elapsed time: 0.10 minutes.
Runtime.totalMemory()=3670540288
